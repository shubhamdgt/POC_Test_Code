var app=angular.module("myeNovationModule").controller("suggestionsCtrl",["$scope","$rootScope","appService","$timeout","$interval","$location","snackbar","sharedService","CONST_RESOURCES","CONST_HELP","FILTER_RESOURCES","$filter","$compile","$sce","$http","Auth","$q","$translate","$translatePartialLoader","Lightbox","$window","SuggMasterData","ExcelExportService",function($scope,E,b,$timeout,e,t,s,C,a,n,l,$filter,$compile,o,$http,r,$q,g,u,d,c,p,m){console.log("Suggestion Controller Loaded"),p.setEmpBrowniePoints(),p.getMandetoryField(),$scope.exportAllKaizen=function(e,t,s){e=document.getElementById(e);s="landscape"==s?{margin:10,filename:t+".pdf",image:{type:"jpeg",quality:1},html2canvas:{allowTaint:!0,useCORS:!0,dpi:300,letterRendering:!0,logging:!1,scale:4},jsPDF:{unit:"mm",format:"a3",orientation:"landscape",precision:"12"}}:{margin:10,filename:t+".pdf",image:{type:"jpeg",quality:1},html2canvas:{allowTaint:!0,useCORS:!0,dpi:300,letterRendering:!0,logging:!1,scale:4},jsPDF:{unit:"mm",format:[320,320],orientation:"portrait",precision:"12"}},$scope.isDownloading=!0,html2pdf().set(s).from(e).save().then(function(){$scope.$apply(function(){$scope.isDownloading=!1})}).catch(function(e){$scope.$apply(function(){$scope.isDownloading=!1}),C.create($filter("translate")("Error downloading PDF:",e),5e3,"error")})},$scope.openLightboxModal=function(e){var t=e.split(".").pop().toLowerCase();"jpeg"===t||"png"===t||"gif"===t||"jpg"===t?d.openModal([{url:e}],0):window.open(e,"_blank")},$scope.orgAlies=E.empDetails.organization.alies,$scope.loggedInUserBranchId=E.empDetails.branch.branchId,$scope.loggedInUserOrgId=E.empDetails.organization.orgId,$scope.loggedInEmpId=E.empDetails.empId,E.checkMenuAccess("Suggestions")||(window.location.href="template.html#!/homepage");var D=E.empDetails.organization.alies,f=(null==D||angular.isUndefined(D)||"cg"!=D?null==D||angular.isUndefined(D)||"gmr"!=D?u.addPart("Suggestion"):u.addPart("gmr/Suggestion"):u.addPart("kaizen/Suggestion"),g.refresh(),$scope.productOrgConfigList={},$scope.getProductOrgConfig=function(){b.httpGet("getProductOrgConfig/"+parseInt($scope.loggedInUserBranchId)).then(function(e){e.result?($scope.productOrgConfigList=e.productOrgConfig,$scope.productOrgConfigList.isPriorityMadatory=1==$scope.productOrgConfigList.isImplmentationPriorityOn,$scope.productOrgConfigList.isTargetMandatory=1==$scope.productOrgConfigList.isTargetMandatory,$scope.productOrgConfigList.isBenchmarkMandatory=1==$scope.productOrgConfigList.isBenchmarkMandatory,$scope.productOrgConfigList.isLineMandatory=1==$scope.productOrgConfigList.isLineMandatory,$scope.isEmpty($scope.roleAccess)||8!=$scope.roleAccess.id||($scope.isEscalation=1==e.productOrgConfig.isEvalEscalation),$scope.getCategoryList(E.empDetails.branch.branchId)):$scope.productOrgConfigList={}})},$scope.getProductOrgConfig(),$scope.selectedSuggestionTab="suggestions",$scope.suggScreenView={flag:"New"},$scope.changeUI=function(){$("#confirmInitiate").modal({backdrop:"static",keyboard:!1})},JSON.parse(localStorage.getItem("userDet"))),h={version:"version_1.0",empId:f.empId};$scope.newUI=function(){window.localStorage.setItem("versionObject",JSON.stringify(h)),window.location.href="template.html#!/suggestions",window.location.reload(),$("#confirmInitiate").modal("hide")},$scope.changePrevious=function(){$scope.suggScreenView={flag:"New"},$("#confirmInitiate").modal("hide")},$scope.imgViewerScrollConfig={scrollButtons:{scrollAmount:"auto",enable:!0},axis:"x",theme:"blue",advanced:{updateOnContentResize:!0}},$scope.suggestionInputDetails={},$scope.suggestionInputDetails.currentDate=$filter("date")(new Date,"yyyy-MM-dd"),$scope.kaizenExportUrl=o.trustAsResourceUrl(E.appDomain+"downloadFile"),$scope.analyticsExportUrl=o.trustAsResourceUrl(E.appDomain+"getAllGraphs"),$scope.suggDetailModel={fromDate:"",toDate:"",searchModule:!1,searchById:!1,isJuryFlag:"N"},null!=E.empDetails&&($scope.loggedInEmpId=E.empDetails.empId,$scope.loggedInName=E.empDetails.firstName+" "+E.empDetails.lastName,$scope.loggedInUserOrgId=E.empDetails.organization.orgId,$scope.loggedInUserDeptId=E.empDetails.dept.deptId,$scope.loggedInUserTeamTypeId=0,$scope.loggedInUserBranchId=E.empDetails.branch.branchId,$scope.loggedInRole=E.empDetails.roles,$scope.orgUrl=E.empDetails.organization.logo),null!=E.empDetails.departmentLevel&&0<E.empDetails.departmentLevel.length?$scope.loggedInUserLevel=E.empDetails.departmentLevel[0].level:$scope.loggedInUserLevel=0,$scope.flagfillterApply=!1,$scope.flagapplydata=!0,$scope.customFilter=function(){return function(e){return 6==$scope.typeFilter?1===e.id||5===e.id:""===e.id||1===e.id||2===e.id||3===e.id||4===e.id}},$scope.searchList=[{id:"",searchBy:"Addon Search"},{id:1,searchBy:"gmr"==D?"Idea ID":"Suggestion ID"},{id:2,searchBy:"gmr"==D?"My Created Idea":"My Created Suggestion"},{id:3,searchBy:"Employee ID"},{id:4,searchBy:"Employee Name"},{id:5,searchBy:"Suggestion Title"}],$scope.sustanceSearchList=[{id:"",searchBy:"Addon Search"},{id:1,searchBy:"Suggestion ID"},{id:3,searchBy:"Employee ID"},{id:4,searchBy:"Employee Name"}],$scope.suggestionLevelList=[{id:1,level:"WITHIN_PLANT",name:"Within Plant"},{id:2,level:"HD_SUGGESTION",name:"HD Suggestion"}],$scope.suggDetailModel.searchBy=$scope.searchList[1],$scope.suggDetailModel.selectedLevel=$scope.suggestionLevelList[0],$scope.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},$scope.isComment=function(){for(var e,t=!1,s=0;s<E.empDetails.roles.length;s++)if(8==E.empDetails.roles[s].id){t=!0;break}return t&&!$scope.isEmpty($scope.suggestionDet)&&null!=$scope.suggestionDet.sugesstionStatusAudit&&0<$scope.suggestionDet.sugesstionStatusAudit.length&&(null!=(e=$filter("filter")($scope.suggestionDet.sugesstionStatusAudit,{status_master:{status:$scope.CONST.STATUS.EvaluationRequestAccepted.status}},!0))&&0!=e.length||(t=!1)),t},$scope.selectedAfterImage="abc",$scope.getFormatedDate=function(e,t,s){var i="";return"fristDay"==s?i=new Date(e,t,1):"lastDay"==s&&(i=new Date(e,t+1,0)),i},$scope.getMonthByMonthAbr=function(e){return"Jan"==e?0:"Feb"==e?1:"Mar"==e?2:"Apr"==e?3:"May"==e?4:"Jun"==e?5:"Jul"==e?6:"Aug"==e?7:"Sept"==e?8:"Oct"==e?9:"Nov"==e?10:"Dec"==e?11:void 0};u=(new Date).getFullYear()-1;$scope.prevYear=u,$scope.curYear=(new Date).getFullYear(),$scope.arrMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"],$scope.mainTab=1,$scope.setMainTab=function(e,t){$scope.mainTab=e,1==$scope.mainTab?($scope.suggToken=t,$scope.applyFilter({filterId:1}),$scope.resetWinnigFilter()):2==$scope.mainTab?($scope.accessBranchList=angular.copy($scope.allBranchaccessList),$timeout(function(){$scope.getDeptWiseCount($scope.from,$scope.to),$scope.getCostEffect($scope.from,$scope.to),$scope.getBenefitWiseCount($scope.from,$scope.to),$scope.getStatusGraph($scope.from,$scope.to)},2e3),$scope.resetSuggestionFilter(),$scope.resetWinnigFilter()):4==$scope.mainTab?($scope.suggToken=t,$scope.getsuggestionList("inFlight")):3==$scope.mainTab&&($scope.winnerPaginate=!0,$scope.getWinningList(),$scope.resetSuggestionFilter()),$scope.suggDetailModel.searchModule=!1},$scope.isSetMainTab=function(e){return $scope.mainTab===e},$scope.priorityList=[{id:"H",name:"High"},{id:"M",name:"Medium"},{id:"L",name:"Low"}],$scope.getSuggAccessList=function(e){e=E.getOrgByAlies("dcmsugar")?"getSuggConfigList/"+E.empDetails.organization.orgId+"/"+e:"getSuggConfigList/"+E.empDetails.organization.orgId;b.httpGet(e).then(function(e){1==e.result?(!E.getOrgByAlies("dcmsugar")||null!=e.suggFlowConfig&&e.suggFlowConfig[0].branchId===E.empDetails.branch.branchId||(e.suggFlowConfig[0].isPlantEnbld=$scope.suggFlowConfig.isPlantEnbld),$scope.suggFlowConfig=e.suggFlowConfig[0],$scope.tab="Y"==$scope.suggFlowConfig.isChgDocEnbld?1:"Y"==$scope.suggFlowConfig.isKaizenActEnbld?4:"Y"==$scope.suggFlowConfig.isSavingTypeEnbld?2:"Y"==$scope.suggFlowConfig.isParticularsEnbld?3:"Y"==$scope.suggFlowConfig.isHorizDplymntsEnbld?5:""):($scope.suggFlowConfig={},$scope.suggFlowConfig.isSuggFlowSetupcmpltd="N",$scope.tab=1)})},$scope.getSuggAccessList(E.empDetails.branch.branchId),$scope.implFiles=[],$scope.getImplFileDetails=function(i){0<$scope.implFiles.length?C.create($filter("translate")("Only one image upload"),5e3,"error"):$scope.$apply(function(){for(var e=0;e<i.files.length;e++){var t=i.files[e].type,s=i.files[e].name.replace(/\.[^/.]+$/,""),t=t.split("/")[1];if("jpg"!=angular.lowercase(t)&&"jpeg"!=angular.lowercase(t)&&"png"!=angular.lowercase(t))return void C.create($filter("translate")("Invalid_file"),5e3,"error");if(10485760<i.files[e].size)return C.create($filter("translate")("Image_size_exceeds_limit"),5e3,"error"),void(document.getElementById("file").value="");i.files[e].fileName=s,i.files[e].ext=t,$scope.implFiles.push(i.files[e])}})},$scope.clearImpleImage=function(e,t){$scope.implFiles.splice(e,1),$scope.implBeforFiles.splice(e,1)},$scope.clearResultImage=function(e,t){$scope.resultImageFiles.splice(e,1),$scope.resultImageBeforFiles.splice(e,1)},$scope.fileReaderImpl=function(t){var e=new FileReader;e.onload=function(e){$scope.$apply(function(){t.imgsrcImpl=e.target.result})},e.readAsDataURL(t)},$scope.scrollToBottom=function(e){angular.element(e).mCustomScrollbar("update"),setTimeout(function(){angular.element(e).mCustomScrollbar("scrollTo","bottom")},100)},$scope.ClearListDate=function(){$scope.suggestionPagination={fromDt:"",toDt:""},0==$scope.statusCountFilter?$scope.getsuggestionList("allSuggestion"):$scope.getsuggestionList("onUpdate"),$scope.getStatusWiseCount()},$scope.setKnowledgeDate=function(){$(function(){$("#frmDate_datepicker").datepicker({format:"yyyy-mm-dd",endDate:"today",autoclose:!0}),$("#toDate_datepicker").datepicker({format:"yyyy-mm-dd",endDate:"today",autoclose:!0})})},$scope.dateSelected=function(){localStorage.setItem("portalFormDt",$scope.suggDetailModel.fromDate),localStorage.setItem("portalToDt",$scope.suggDetailModel.toDate),$scope.selectedFrDate=$("#toDate_datepicker").datepicker("getFormattedDate")},$(function(){new Date;$("#toDate_datepicker").datepicker({format:"yyyy-mm-dd",endDate:"today",autoclose:!0})}),$scope.$watch("suggestionPagination.fromDt",function(e,t){$scope.isEmpty($scope.suggestionPagination)||$scope.suggestionPagination.hasOwnProperty("fromDt")&&null!=$scope.suggestionPagination.fromDt&&null!=$scope.suggestionPagination.fromDt&&""!=$scope.suggestionPagination.fromDt&&($scope.suggestionPagination.fromDt=moment(e).format("YYYY-MM-DD"),$scope.dateSelected())}),$scope.$watch("suggestionPagination.toDt",function(e,t){$scope.isEmpty($scope.suggestionPagination)||$scope.suggestionPagination.hasOwnProperty("toDt")&&null!=$scope.suggestionPagination.toDt&&null!=$scope.suggestionPagination.toDt&&""!=$scope.suggestionPagination.toDt&&($scope.suggestionPagination.toDt=moment(e).format("YYYY-MM-DD"),$scope.dateSelected())}),$scope.$watch("suggDetailModel.fromDt",function(e,t){$scope.isEmpty($scope.suggDetailModel)||$scope.suggDetailModel.hasOwnProperty("fromDt")&&null!=$scope.suggDetailModel.fromDt&&null!=$scope.suggDetailModel.fromDt&&""!=$scope.suggDetailModel.fromDt&&($scope.suggDetailModel.fromDt=moment(e).format("YYYY-MM-DD"),$scope.dateSelected())}),$scope.$watch("suggDetailModel.toDt",function(e,t){$scope.isEmpty($scope.suggDetailModel)||$scope.suggDetailModel.hasOwnProperty("toDt")&&null!=$scope.suggDetailModel.toDt&&null!=$scope.suggDetailModel.toDt&&""!=$scope.suggDetailModel.toDt&&($scope.suggDetailModel.toDt=moment(e).format("YYYY-MM-DD"),$scope.dateSelected())}),$scope.dateSelectedFrom=function(){localStorage.setItem("portalFormDt",$scope.suggDetailModel.fromDate),localStorage.setItem("portalToDt",$scope.suggDetailModel.toDate),$scope.suggestionPagination.fromDt=$scope.suggestionPagination.selectedfromDt,$scope.selectedFrDate=$("#frmDate_datepicker").datepicker("getFormattedDate"),$(function(){new Date;angular.element("#toDate_datepicker").datepicker({format:"yyyy-mm-dd",endDate:"today",autoclose:!0}),angular.element("#toDate_datepicker").datepicker("setStartDate",$scope.selectedFrDate)})},$(function(){var e=new Date+1;angular.element("#know_datepicker").datepicker({format:"yyyy-mm-dd",autoclose:!0,endDate:e})}),$(function(){new Date;$("#frmDate_datepicker").datepicker({format:"yyyy-mm-dd",endDate:"today",autoclose:!0})}),""==localStorage.getItem("portalFormDt")&&""==localStorage.getItem("portalToDt")?($scope.portalFromDt=localStorage.getItem("portalFormDt"),$scope.portalToDt=localStorage.getItem("portalToDt")):($scope.portalFromDt=moment().subtract(1,"months").format("YYYY-MM-DD"),$scope.portalToDt=$filter("date")(new Date,"yyyy-MM-dd")),$scope.suggDetailModel.fromDate=$scope.portalFromDt,$scope.suggDetailModel.toDate=$scope.portalToDt,$scope.loggedInName=$scope.loggedInName+" "+localStorage.getItem("lastName"),$scope.flagTeamDetPopupLoading=!1,$scope.flagAcceptSugg=!1,$scope.flagRejectSugg=!1,$scope.suggestionList=[],$scope.suggestion=[],$scope.date=[],$scope.cardSel={},$scope.flagrejarea=!1,$scope.flagrejectEvalarea=!1,$scope.flagrejectonhold=!1,$scope.flagresumeonhold=!1,$scope.flagAccPillerLeavel=!1,$scope.flagAccRejTextarea=!1,$scope.flagSuggListIndicator=!1,$scope.flagSuggGraphBoxIndicator=!1,$scope.flagDeptGraphBoxIndicator=!1,$scope.flagRecSuggSpinner=!1,$scope.uploadAttachmentModalSpinner=!1,$scope.flagSuggDetLoader=!1,$scope.isSelectedSuggestionEdited=!1,$scope.flagDeptGraphDataNotAvail=!1,$scope.flagStatusGraphDataNotAvail=!1,$scope.flagSuggDetBoxIndicator=!1,$scope.flagSelectTeamMem=!1,$scope.flagSuggestionFilter=!1,$scope.flagCloseConcernSpinner=!1,$scope.flagTeamDetNotAvailMsg=!1,$scope.flagDeptWiseGraphIndicator=!1,$scope.flagCatWiseGraphIndicator=!1,$scope.flagStatusWiseGraphIndicator=!1,$scope.allSuggestionCount=0,$scope.suggestionPagination={current:1,totalSuggestion:0,suggestionPerPage:20,suggestionPerPageNew:10,selectedCatId:0,selectedDeptId:0,selectedStatus:"",fromDt:"",toDt:"",maxSize:5},$scope.staticPagination={currentPage:1,limit:10,maxSize:6,totalCount:0},$scope.paginateConfig={itemsPerPage:10,current:1},$scope.onPageChanged=function(e){$scope.paginateConfig.current=e},$scope.isExecutiveSugg=!1,$scope.labelsDepartment=[],$scope.departmentData=[],$scope.statusCountGraphOpt={},$scope.kaizenExportFormatedData={benefits:""},$scope.resetSuggestionFilter=function(){$scope.suggestionPagination.current=1,$scope.suggestionPagination.totalSuggestion=0,$scope.suggestionPagination.suggestionPerPage=20,$scope.suggestionPagination.selectedCatId=0,$scope.suggestionPagination.selectedDeptId=0},$scope.flagTeamDetPopupSpinner=!1,$scope.flagHrAccRejSpinner=!1,$scope.flagEvalAccRejSpinner=!1,$scope.isSuggestionAccess=E.checkSubMenuAccess("Suggestions","Suggestions"),$scope.CONST=a,$scope.CONST.STATUS=E.suggStatus,$scope.CONST_HELP_STMT=n,$scope.FILTER=l,$scope.filterStatusIds="",null!=$scope.CONST.STATUS&&($scope.sustanaceStatusList=[{statusId:$scope.CONST.STATUS.AssignedForSustainanceCheck.statusId,label:$scope.CONST.STATUS.AssignedForSustainanceCheck.label},{statusId:$scope.CONST.STATUS.ReassignedToSustenanceAuditor.statusId,label:$scope.CONST.STATUS.ReassignedToSustenanceAuditor.label},{statusId:$scope.CONST.STATUS.SustainanceVerificationInProgress.statusId,label:$scope.CONST.STATUS.SustainanceVerificationInProgress.label},{statusId:$scope.CONST.STATUS.Sustained.statusId,label:$scope.CONST.STATUS.Sustained.label},{statusId:$scope.CONST.STATUS.SustainanceFailed.statusId,label:$scope.CONST.STATUS.SustainanceFailed.label}]),$scope.$on("handleBroadcast",function(){$scope.portalFromDt=localStorage.getItem("portalFormDt"),$scope.portalToDt=localStorage.getItem("portalToDt"),0==$scope.statusCountFilter?$scope.getsuggestionList("allSuggestion"):$scope.getsuggestionList("onUpdate"),$scope.getStatusWiseCount()}),$scope.txtColorPallet=["txt-green","txt-orange","txt-blue","txt-yellow","txt-darkgray","txt-pink","txt-blue1","txt-red","txt-darkgray-1","txt-purpul"],$scope.graphColorPallet=["#466289","#FA6121","#3ba682","#627894","#996699","#8792D6","#ffbe70","#DBE8F9","#A0AEC1","#8792D6","#A0AEC1"],$scope.bgColorPallet=["#33C771","#f68421","#8776F8","#E5C212","#EE428C","#505050","#288AEC"],$scope.hzBarChartColor="#33C771",$scope.deptChartOpt={legend:{display:!0,position:"right"}},$scope.isAccess=function(e,t){if(0==t){for(var s=0;s<E.empDetails.roles.length;s++)if(e==E.empDetails.roles[s].id)return!0}else if(0<t)for(s=0;s<E.empDetails.roles.length;s++)if("NA"!=e){if(e==E.empDetails.roles[s].id&&t==E.empDetails.departmentLevel[0].level)return!0}else if(t==E.empDetails.departmentLevel[0].level)return!0;return!1},$scope.printAnalytics=function(){html2canvas(document.getElementById("dashboard"),{onrendered:function(e){e=e.toDataURL();pdfMake.createPdf({content:[{image:e,width:500}]}).download("test.pdf")}})},$scope.getCircleControllerList=function(){$scope.data={branchId:$scope.loggedInUserBranchId,levelId:0},b.httpPost($scope.data,"getCircleLevelUserDetails").then(function(e){1==e.result?$scope.circleControllerList=e.circleLevelUsers:C.create($filter("translate")("Error_occured_Please_try_again"),5e3,"error")})},$scope.isSuperAdminForJury=function(){for(var e=!1,t=0;t<E.empDetails.roles.length;t++)if("SUPERADMIN"==E.empDetails.roles[t].name){e=!0;break}return e},$scope.isPublishDisabled=function(){var e=!1,t=new Date,s=t.getFullYear(),i=t.getMonth()+1;t.getDay();return e=null!=$scope.suggestionPagination.selectedMonth&&null!=$scope.suggestionPagination.selectedMonth&&$scope.suggestionPagination.selectedMonth.month==i&&$scope.suggestionPagination.selectedMonth.year==s?!0:e},$scope.juryCureentMonth=(new Date).getMonth()+1,$scope.getJuryTopKiazenList=function(){b.httpGet("getCurrentTopKaizen/"+$scope.nominationId).then(function(e){1==e.result?$scope.CurrentTopKaizenList=e.list:$scope.CurrentTopKaizenList=[]})},$scope.getJueryStatusList=function(){$scope.data={nomId:$scope.nominationId},b.httpPost($scope.data,"getJuryAssessmentSummary").then(function(e){1==e.result?$scope.juryStatusList=e.list:$scope.juryStatusList=[]})},$scope.enableData=function(){var t=!1;if(null!=$scope.juryStatusList&&0<$scope.juryStatusList.length){for(let e=0;e<$scope.juryStatusList.length;e++)$scope.juryStatusList[e].totalJury=0,$scope.juryStatusList[e].totalJury=$scope.juryStatusList[e].pendingCount+$scope.juryStatusList[e].completedCount,0==$scope.juryStatusList[e].pendingCount&&$scope.juryStatusList[e].completedCount==$scope.juryStatusList[e].totalJury?t=!0:0<$scope.juryStatusList[e].pendingCount&&$scope.juryStatusList[e].completedCount!=$scope.juryStatusList[e].totalJury&&0<$scope.juryStatusList[e].completedCount&&(t=!1);return t}},$scope.getJuryList=function(){b.httpGet("getSuggestionJurySetup/"+$scope.loggedInUserBranchId).then(function(e){if($scope.flagTblemployee=!0,e.result){$scope.flagJuryDetNotAvail=!1,$scope.juryList=e.list;for(var t=0;t<e.list.length;t++)$scope.monthNumber=parseInt(e.list[t].month),e.list[t].newMonth=$scope.monthNumber}else $scope.juryList=[]})},$scope.juryPasstopeerPopup=function(){$("#teamDetModalforJury").modal({backdrop:"static",keyboard:!1})},$scope.selectTeamJuryOnRowClick=function(e){angular.element(".rdoEmpSelect").attr("checked",!1),angular.element(e).attr("checked",!0),$.each($("input[name='empChk']:checked"),function(){$scope.selectedSingleEmpId=parseInt($(this).val())})},$scope.juryPasstopeer=function(){$scope.data={nominationId:$scope.nominationId,fromEmpId:$scope.loggedInEmpId,toEmpId:$scope.selectedSingleEmpId},b.httpPost($scope.data,"passToPeerAssessment").then(function(e){1==e.result?($("#teamDetModalforJury").modal("hide"),C.create($filter("translate")("Assigned_to_peer_successfully"),5e3,"success"),$scope.getStatusWiseCount(),$scope.getsuggestionList(),$scope.getJuryTopKiazenList(),$scope.getJueryStatusList()):C.create($filter("translate")("Error_occured_Please_try_again"),5e3,"error")})},$scope.conformPublishTemplate=function(){$("#confirmPublishModal").modal({backdrop:"static",keyboard:!1})},$scope.publishJuryAssesment=function(){var e={nomId:$scope.nominationId,orgId:$scope.loggedInUserOrgId,branchId:E.empDetails.branch.branchId};b.httpPost(e,"publishTopKaizenWinners").then(function(e){$("#confirmPublishModal").modal("hide"),e.result?100==e.statusCode?($scope.statusReason=e.reason,C.create($filter("translate")("Please_complete_pending_assessment"),3e3,"error")):(C.create($filter("translate")("Assessment_process_completed_and_winners_are_displayed_on_winners_board"),3e3,"success"),$scope.getStatusWiseCount(),$scope.getsuggestionList(),$scope.getJuryTopKiazenList(),$scope.getJueryStatusList()):C.create($filter("translate")("Oops_Please_try_again"),"3000","error")})},$scope.getsuggestionList=function(g){var e,t="",t="inFlight"==g?($scope.suggestionList=[],$scope.data.orgId=$scope.loggedInUserOrgId,$scope.data.stsId=0,$scope.flagSuggListBoxIndicator=!0,$scope.data={branchIds:[],orgId:$scope.loggedInUserOrgId,typeId:$scope.statusCountFilter,assignedToId:$scope.loggedInEmpId},"implementedsuggestion"):"allSuggestion"==g?($scope.data={branchIds:[],orgId:$scope.loggedInUserOrgId,assignedToId:$scope.loggedInEmpId},"getallsuggestion"):($scope.data={branchIds:[],orgId:$scope.loggedInUserOrgId,typeId:$scope.statusCountFilter,assignedToId:$scope.loggedInEmpId},"getsuggestionlistnew");if(1==$scope.statusCountFilter&&($scope.data.orderByPriority="Y"),9==$scope.statusCountFilter&&null!=E.empDetails&&null!=E.empDetails&&null!=E.empDetails.roles&&null!=E.empDetails.roles&&0<E.empDetails.roles.length)for(let e=0;e<E.empDetails.roles.length;e++)"SUPERADMIN"==E.empDetails.roles[e].name&&($scope.flagIsSuperAdmin=!0,$scope.superadminRoleId=E.empDetails.roles[e].id);if($scope.flagIsSuperAdmin&&($scope.data.roleId=$scope.superadminRoleId),5==$scope.typeFilter&&($scope.data.nominationId=$scope.nominationId,$scope.data.monthValue=$scope.suggestionPagination.selectedMonth.month,$scope.data.yearValue=$scope.suggestionPagination.selectedMonth.year,1==$scope.juryTab?$scope.data.groupName="GROUP1":2==$scope.juryTab?$scope.data.groupName="GROUP2":3==$scope.juryTab?$scope.data.groupName="GROUP3":$scope.data.groupName="GROUP4"),5==$scope.statusCountFilter&&($scope.data.branchId=$scope.loggedInUserBranchId),7!=$scope.typeFilter&&6!=$scope.typeFilter&&9!=$scope.typeFilter&&(1==$scope.suggestionPagination.current?($scope.data.limit=$scope.suggestionPagination.suggestionPerPage,$scope.data.offset=0):($scope.data.limit=$scope.suggestionPagination.suggestionPerPage,$scope.data.offset=($scope.suggestionPagination.current-1)*$scope.suggestionPagination.suggestionPerPage)),7!=$scope.typeFilter&&6!=$scope.typeFilter&&9!=$scope.typeFilter||(1==$scope.suggestionPagination.current?($scope.data.limit=10,$scope.data.offset=0):($scope.data.limit=10,$scope.data.offset=10*($scope.suggestionPagination.current-1))),$scope.suggDetailModel.hasOwnProperty("searchBy")&&!$scope.isEmpty($scope.suggDetailModel.searchBy)&&(""!=$scope.suggDetailModel.searchBy&&2==$scope.suggDetailModel.searchBy.id?($scope.data.srchKey="SRCH_BY_EMP_ID",$scope.data.typeId=$scope.selectedFilter.filterId):""!=$scope.suggDetailModel.searchBy&&1==$scope.suggDetailModel.searchBy.id&&null!=$scope.suggDetailModel.suggestionNumber&&""!=$scope.suggDetailModel.suggestionNumber?($scope.data.srchKey="SRCH_BY_SUGG_NUMBER",$scope.suggDetailModel.searchById&&($scope.data.suggNum=$scope.suggDetailModel.suggestionNumber,$scope.data.typeId=$scope.selectedFilter.filterId)):""!=$scope.suggDetailModel.searchBy&&3==$scope.suggDetailModel.searchBy.id&&null!=$scope.suggDetailModel.suggestionNumber&&""!=$scope.suggDetailModel.suggestionNumber?($scope.data.srchKey="SRCH_BY_COMPANY_EMP_ID",$scope.suggDetailModel.searchById&&($scope.data.companyEmpNum=$scope.suggDetailModel.suggestionNumber,$scope.data.typeId=$scope.selectedFilter.filterId)):""!=$scope.suggDetailModel.searchBy&&4==$scope.suggDetailModel.searchBy.id&&null!=$scope.suggDetailModel.suggestionNumber&&""!=$scope.suggDetailModel.suggestionNumber?($scope.data.srchKey="SRCH_BY_EMP_NAME",$scope.suggDetailModel.searchById&&($scope.data.empName=$scope.suggDetailModel.suggestionNumber,$scope.data.typeId=$scope.selectedFilter.filterId)):""!=$scope.suggDetailModel.searchBy&&5==$scope.suggDetailModel.searchBy.id&&null!=$scope.suggDetailModel.suggestionNumber&&""!=$scope.suggDetailModel.suggestionNumber&&($scope.data.srchKey="SRCH_BY_SUGG_TITLE",$scope.suggDetailModel.searchById)&&($scope.data.suggestionTitle=$scope.suggDetailModel.suggestionNumber,$scope.data.typeId=$scope.selectedFilter.filterId)),0<$scope.suggestionPagination.selectedCatId?$scope.data.catId=$scope.suggestionPagination.selectedCatId:(delete $scope.data.catId,$scope.data.processType=$scope.suggDetailModel.selectedCategoryName),""!=$scope.data.processType&&null!=$scope.data.processType&&null!=$scope.data.processType||delete $scope.data.processType,0<$scope.suggestionPagination.selectedDeptId&&($scope.data.deptId=$scope.suggestionPagination.selectedDeptId),9==$scope.statusCountFilter)null!=$scope.suggestionPagination.selectedStatus&&""!=$scope.suggestionPagination.selectedStatus&&null!=$scope.suggestionPagination.selectedStatus.statusId?(e=[$scope.suggestionPagination.selectedStatus.statusId],$scope.data.statusIds=e):delete $scope.data.statusIds;else{var s=[];if(null!=$scope.suggDetailModel.statusList&&0<$filter("filter")($scope.suggDetailModel.statusList,{isSelected:!0},!0).length){for(let e=0;e<$scope.suggDetailModel.statusList.length;e++)$scope.suggDetailModel.statusList[e].isSelected&&"All"!=$scope.suggDetailModel.statusList[e].label&&s.push($scope.suggDetailModel.statusList[e].statusId);$scope.data.statusIds=s}}if("onLoad"==g||"allSuggestion"==g?($scope.suggestionList=[],$scope.flagSuggListBoxIndicator=!0):"onUpdate"==g&&($scope.flagSuggListLineIndicator=!0),6!=$scope.typeFilter&&7!=$scope.typeFilter&&8!=$scope.typeFilter&&(null!=$scope.accessBranchList||null!=$scope.accessBranchList))for(var i=0;i<$scope.accessBranchList.length;i++)$scope.accessBranchList[i].isSelected&&$scope.data.branchIds.push(parseInt($scope.accessBranchList[i].branchId));if(8==$scope.typeFilter&&(null!=$scope.guestBranchList||null!=$scope.guestBranchList))for(i=0;i<$scope.guestBranchList.length;i++)$scope.guestBranchList[i].isSelected&&$scope.data.branchIds.push(parseInt($scope.guestBranchList[i].branchId));if(7==$scope.typeFilter||6==$scope.typeFilter){if(""!=$scope.suggestionPagination.fromDt&&""!=$scope.suggestionPagination.toDt&&($scope.data.fromDt=$scope.suggestionPagination.fromDt+" 00:00:00",$scope.data.toDt=$scope.suggestionPagination.toDt+$filter("date")(new Date," HH:mm:ss")),null==$scope.listFilter.branchId||null==$scope.listFilter.branchId||""==$scope.listFilter.branchId){if(null!=$scope.listFilter.accessBranchList||null!=$scope.listFilter.accessBranchList)for(i=0;i<$scope.listFilter.accessBranchList.length;i++)$scope.listFilter.accessBranchList[i].isSelectBranch&&$scope.data.branchIds.push(parseInt($scope.listFilter.accessBranchList[i].branchId))}else $scope.data.branchIds=[parseInt($scope.listFilter.branchId)];null!=$scope.listFilter.sourceTypeId&&null!=$scope.listFilter.sourceTypeId&&""!=$scope.listFilter.sourceTypeId&&($scope.data.sourceTypes=[],$scope.data.sourceTypes=[$scope.listFilter.sourceTypeId]),null!=$scope.listFilter.deptId&&null!=$scope.listFilter.deptId&&""!=$scope.listFilter.deptId&&($scope.data.deptIds=[],$scope.data.deptIds=[$scope.listFilter.deptId]),null!=$scope.listFilter.catId&&null!=$scope.listFilter.catId&&""!=$scope.listFilter.catId&&($scope.data.catIds=$scope.listFilter.catId),null!=$scope.listFilter.activityId&&null!=$scope.listFilter.activityId&&""!=$scope.listFilter.activityId&&($scope.data.activityIds=$scope.listFilter.activityId),null!=$scope.listFilter.sourceId&&null!=$scope.listFilter.sourceId&&""!=$scope.listFilter.sourceId&&($scope.data.suggSource=$scope.listFilter.sourceId),null!=$scope.listFilter.circleId&&null!=$scope.listFilter.circleId&&""!=$scope.listFilter.circleId&&($scope.data.circleId=$scope.listFilter.circleId),null!=$scope.listFilter.operationId&&null!=$scope.listFilter.operationId&&""!=$scope.listFilter.operationId&&($scope.data.operationId=$scope.listFilter.operationId),null!=$scope.listFilter.machinePartId&&null!=$scope.listFilter.machinePartId&&""!=$scope.listFilter.machinePartId&&($scope.data.machinePartId=$scope.listFilter.machinePartId),null!=$scope.listFilter.machineId&&null!=$scope.listFilter.machineId&&""!=$scope.listFilter.machineId&&($scope.data.machineId=$scope.listFilter.machineId),null!=$scope.listFilter.stageId&&null!=$scope.listFilter.stageId&&""!=$scope.listFilter.stageId&&($scope.data.stageId=$scope.listFilter.stageId),null!=$scope.listFilter.productId&&null!=$scope.listFilter.productId&&""!=$scope.listFilter.productId&&($scope.data.productId=$scope.listFilter.productId),null!=$scope.listFilter.productNoId&&null!=$scope.listFilter.productNoId&&""!=$scope.listFilter.productNoId&&($scope.data.productNoId=$scope.listFilter.productNoId)}null==$scope.data.branchIds||0==$scope.data.branchIds.length?($scope.suggestionList=[],$scope.flagSuggListBoxIndicator=!1):(null!=$scope.suggDetailModel.selectedLevel&&null!=$scope.suggDetailModel.selectedLevel&&""!=$scope.suggDetailModel.selectedLevel&&($scope.data.suggestionLevel=$scope.suggDetailModel.selectedLevel.level),$scope.isFilterApplied&&$scope.suggDetailModel.fromDt&&$scope.suggDetailModel.toDt&&($scope.data.fromDt=moment($scope.suggDetailModel.fromDt).format("YYYY-MM-DD")+" 00:00:00",$scope.data.toDt=moment($scope.suggDetailModel.toDt).format("YYYY-MM-DD")+" 23:59:59"),$scope.isFilterApplied&&null!=$scope.suggDetailModel.suggPriorityFilter&&""!=$scope.suggDetailModel.suggPriorityFilter&&($scope.data.suggPriority=$scope.suggDetailModel.suggPriorityFilter),b.httpPost($scope.data,t).then(function(e){if($scope.data={},$scope.listFilter.listdeptIds=[],$scope.listFilter.listactivityIds=[],$scope.listFilter.listcatIds=[],$scope.listFilter.listsourceTypes=[],$scope.listFilter.listsuggSource=[],200==e.statusCode&&($scope.myPoints=e.empPoints),"onLoad"==g){if($scope.flagSuggListBoxIndicator=!1,null==e.sugessionsByEmpIdList)return $scope.suggestionList=[],void($scope.flagSuggNotAvailMsgBox=!0)}else if("inFlight"==g)$scope.flagSuggListBoxIndicator=!1,$scope.suggestionList=e.sugessionsByEmpIdList;else if("onUpdate"==g||"onAutoLoad"==g){if($scope.flagSuggListLineIndicator=!1,$scope.flagSuggNotAvailMsgBox=!1,null==e.sugessionsByEmpIdList)return $scope.suggestionList=[],void($scope.flagSuggNotAvailMsgBox=!0)}else"allSuggestion"==g&&($scope.flagSuggListBoxIndicator=!1,$scope.allSuggestionCount=e.sugessionsByEmpIdList.length);if($scope.suggestionList=e.sugessionsByEmpIdList,5==$scope.statusCountFilter)if(1==e.result){for(var t=[],s=0;s<e.sugessionsByEmpIdList.length;s++){var i=e.sugessionsByEmpIdList[s];if("JURY"==i.inputType){i.parameterList=angular.copy($scope.suggestionEvalParametersList);for(var a=0;a<i.parameterList.length;a++){i.parameterList[a].ratingList=angular.copy($scope.suggestionEvalRatingsList);for(var n=0;n<i.suggestionEvalJuryInput.length;n++)if(i.parameterList[a].id==i.suggestionEvalJuryInput[n].parameterId)for(var l=0;l<i.parameterList[a].ratingList.length;l++)i.parameterList[a].ratingList[l].id==i.suggestionEvalJuryInput[n].ratingId&&(i.parameterList[a].ratingList[l].isSelected=!0)}i.ratingList=null,t.push(i)}else if("PRODUCTION_HEAD"==i.inputType){i.ratingList=angular.copy($scope.suggestionEvalRatingsList);for(n=0;n<i.ratingList.length;n++)i.ratingList[n].id==i.phRatingId&&(i.ratingList[n].isSelected=!0);t.push(i)}}var o=t.reduce(function(e,t){var s={juryName:t.juryName,sugNominationId:t.sugNominationId,sugId:t.sugId,suggestionTitle:t.suggestionTitle,suggestionNumber:t.suggestionNumber,empName:t.empName,jStatus:t.jStatus,jAssinedToId:t.jAssinedToId,jTotalRating:t.jTotalRating,jUpdatedDate:t.jUpdatedDate,juryEmpId:t.juryEmpId,suggestionEvalJuryInput:t.suggestionEvalJuryInput,parameterList:t.parameterList,inputType:t.inputType,phRating:t.phRating,phRatingId:t.phRatingId,ratingList:t.ratingList,points:t.points,totalJuryScore:t.totalJuryScore,totalPoints:t.totalPoints,isupdate:"PENDING"==t.jStatus};return e[t.sugId]=e[t.sugId]||[],e[t.sugId].push(s),e},{}),r=Object.keys(o).map(function(e){return{sugId:e,suggestionTitle:o[e][0].suggestionTitle,empName:o[e][0].empName,suggestionNumber:o[e][0].suggestionNumber,points:o[e][0].points,totalJuryScore:o[e][0].totalJuryScore,totalPoints:o[e][0].totalPoints,assignedJuryList:o[e]}});$scope.juryData=r;for(s=0;s<$scope.juryData.length;s++)for(a=0;a<$scope.juryData[s].assignedJuryList.length;a++)$scope.loggedInEmpId==$scope.juryData[s].assignedJuryList[a].juryEmpId&&"PENDING"==$scope.juryData[s].assignedJuryList[a].jStatus&&($scope.checkJuryPending=!0)}else $scope.juryData=[];if(null!=$scope.suggestionList&&0<$scope.suggestionList.length)for(s=0;s<$scope.suggestionList.length;s++)$scope.suggestionList[s].suggestionNumber=$scope.suggestionList[s].suggestionNumber;if(5!=$scope.typeFilter)for(a=0;a<e.sugessionsByEmpIdList.length;a++)null!=e.sugessionsByEmpIdList[a].assignedDate&&0<e.sugessionsByEmpIdList[a].assignedDate.length?e.sugessionsByEmpIdList[a].inDays=E.getNoOfDaysUsingDate(e.sugessionsByEmpIdList[a].assignedDate):e.sugessionsByEmpIdList[a].inDays=0,1==e.sugessionsByEmpIdList[a].isSelfImplemented&&(e.sugessionsByEmpIdList[a].selfImpl="Self Implemented");9==$scope.statusCountFilter&&($scope.sustenanceCount={liveCount:e.liveCount,failedCount:e.failedCount,sustainedCount:e.sustainedCount,underVerificationCount:e.underVerificationCount}),$scope.suggestionList=e.sugessionsByEmpIdList}))},$scope.getSugCount=function(t){var s=0;if(null!=t&&0<t.length)for(let e=0;e<t.length;e++)"PRODUCTION_HEAD"==t[e].inputType?s+=t[e].phRating:"JURY"==t[e].inputType&&(s+=t[e].jTotalRating);return s},$scope.onPaginationClick=function(e){$scope.suggestionPagination.current=e,$scope.suggestionDet={},0==$scope.statusCountFilter?$scope.getsuggestionList("allSuggestion"):$scope.getsuggestionList("onLoad")},$scope.getStatusWiseCount=function(){if($scope.data={assignedToId:$scope.loggedInEmpId,juryBranchId:E.empDetails.branch.branchId,orgId:E.empDetails.organization.orgId,onHoldSugBranchIds:[],allSugBranchIds:[],pendSugBranchIds:[],mySugBranchIds:[],lateralSugBranchIds:[],knowledgeBankBranchIds:[],guestSuggBranchIds:[],sustainKaizenBranchIds:[],typeId:$scope.statusCountFilter},null!=E.empDetails&&null!=E.empDetails.roles&&null!=E.empDetails.roles&&0<E.empDetails.roles.length)for(let e=0;e<E.empDetails.roles.length;e++)"SUPERADMIN"==E.empDetails.roles[e].name&&($scope.flagIsSuperAdmin=!0,$scope.superadminRoleId=E.empDetails.roles[e].id);if($scope.flagIsSuperAdmin&&($scope.data.roleId=$scope.superadminRoleId),null!=$scope.nominationId&&""!=$scope.nominationId&&($scope.data.nominationId=$scope.nominationId),$scope.isFilterApplied&&$scope.suggDetailModel.fromDt&&$scope.suggDetailModel.toDt&&($scope.data.fromDt=moment($scope.suggDetailModel.fromDt).format("YYYY-MM-DD")+" 00:00:00",$scope.data.toDt=moment($scope.suggDetailModel.toDt).format("YYYY-MM-DD")+" 23:59:59"),""!=$scope.suggestionPagination.fromDt&&""!=$scope.suggestionPagination.toDt&&($scope.data.fromDt=$scope.suggestionPagination.fromDt+" 00:00:00",$scope.data.toDt=$scope.suggestionPagination.toDt+$filter("date")(new Date," HH:mm:ss")),0<$scope.suggestionPagination.selectedCatId?$scope.data.catId=$scope.suggestionPagination.selectedCatId:(delete $scope.data.catId,$scope.data.processType=$scope.suggDetailModel.selectedCategoryName),""!=$scope.data.processType&&null!=$scope.data.processType&&null!=$scope.data.processType||delete $scope.data.processType,0<$scope.suggestionPagination.selectedDeptId&&($scope.data.deptId=$scope.suggestionPagination.selectedDeptId),9==$scope.statusCountFilter){var e;null!=$scope.suggestionPagination.selectedStatus&&""!=$scope.suggestionPagination.selectedStatus&&null!=$scope.suggestionPagination.selectedStatus.statusId?(e=[$scope.suggestionPagination.selectedStatus.statusId],$scope.data.statusIds=e):delete $scope.data.statusIds}else{var t=[];if(null!=$scope.suggDetailModel.statusList&&0<$filter("filter")($scope.suggDetailModel.statusList,{isSelected:!0},!0).length){for(let e=0;e<$scope.suggDetailModel.statusList.length;e++)$scope.suggDetailModel.statusList[e].isSelected&&"All"!=$scope.suggDetailModel.statusList[e].label&&t.push($scope.suggDetailModel.statusList[e].statusId);$scope.data.statusIds=t}}if(null!=$scope.pendingBranchlist)for(var s=0;s<$scope.pendingBranchlist.length;s++)$scope.pendingBranchlist[s].isSelected&&$scope.data.pendSugBranchIds.push($scope.pendingBranchlist[s].branchId);if(null!=$scope.mySuggBranchlist)for(s=0;s<$scope.mySuggBranchlist.length;s++)$scope.mySuggBranchlist[s].isSelected&&$scope.data.mySugBranchIds.push($scope.mySuggBranchlist[s].branchId);if(null!=$scope.onholdBranchlist)for(s=0;s<$scope.onholdBranchlist.length;s++)$scope.onholdBranchlist[s].isSelected&&$scope.data.onHoldSugBranchIds.push($scope.onholdBranchlist[s].branchId);if(null!=$scope.allBranchaccessList)for(s=0;s<$scope.allBranchaccessList.length;s++)$scope.allBranchaccessList[s].isSelected&&$scope.data.allSugBranchIds.push($scope.allBranchaccessList[s].branchId);if(null!=$scope.sustainKaizenBrancList)for(s=0;s<$scope.sustainKaizenBrancList.length;s++)$scope.sustainKaizenBrancList[s].isSelected&&$scope.data.sustainKaizenBranchIds.push($scope.sustainKaizenBrancList[s].branchId);if(null!=$scope.guestBranchList)for(s=0;s<$scope.guestBranchList.length;s++)$scope.guestBranchList[s].isSelected&&$scope.data.guestSuggBranchIds.push($scope.guestBranchList[s].branchId);if(null==$scope.listFilter.branchId||null==$scope.listFilter.branchId||""==$scope.listFilter.branchId){if(null!=$scope.listFilter.accessBranchList||null!=$scope.listFilter.accessBranchList)for(s=0;s<$scope.listFilter.accessBranchList.length;s++)$scope.listFilter.accessBranchList[s].isSelectBranch&&$scope.data.knowledgeBankBranchIds.push($scope.listFilter.accessBranchList[s].branchId)}else $scope.data.knowledgeBankBranchIds.push($scope.listFilter.branchId.toString());if(null!=$scope.listFilter.sourceTypeId&&null!=$scope.listFilter.sourceTypeId&&""!=$scope.listFilter.sourceTypeId&&($scope.data.sourceTypes=[$scope.listFilter.sourceTypeId]),null==$scope.listFilter.branchId||null==$scope.listFilter.branchId||""==$scope.listFilter.branchId){if(null!=$scope.listFilter.accessBranchList||null!=$scope.listFilter.accessBranchList)for(s=0;s<$scope.listFilter.accessBranchList.length;s++)$scope.listFilter.accessBranchList[s].isSelectBranch&&$scope.data.lateralSugBranchIds.push($scope.listFilter.accessBranchList[s].branchId)}else $scope.data.lateralSugBranchIds.push($scope.listFilter.branchId.toString());null!=$scope.listFilter.circleId&&null!=$scope.listFilter.circleId&&""!=$scope.listFilter.circleId&&($scope.data.circleId=$scope.listFilter.circleId),null!=$scope.listFilter.operationId&&null!=$scope.listFilter.operationId&&""!=$scope.listFilter.operationId&&($scope.data.operationId=$scope.listFilter.operationId),null!=$scope.listFilter.machinePartId&&null!=$scope.listFilter.machinePartId&&""!=$scope.listFilter.machinePartId&&($scope.data.machinePartId=$scope.listFilter.machinePartId),null!=$scope.listFilter.machineId&&null!=$scope.listFilter.machineId&&""!=$scope.listFilter.machineId&&($scope.data.machineId=$scope.listFilter.machineId),null!=$scope.listFilter.stageId&&null!=$scope.listFilter.stageId&&""!=$scope.listFilter.stageId&&($scope.data.stageId=$scope.listFilter.stageId),null!=$scope.listFilter.productId&&null!=$scope.listFilter.productId&&""!=$scope.listFilter.productId&&($scope.data.productId=$scope.listFilter.productId),null!=$scope.listFilter.productNoId&&null!=$scope.listFilter.productNoId&&""!=$scope.listFilter.productNoId&&($scope.data.productNoId=$scope.listFilter.productNoId),$scope.suggDetailModel.hasOwnProperty("searchBy")&&!$scope.isEmpty($scope.suggDetailModel.searchBy)&&(""!=$scope.suggDetailModel.searchBy&&2==$scope.suggDetailModel.searchBy.id?($scope.data.srchKey="SRCH_BY_EMP_ID",$scope.data.typeId=$scope.selectedFilter.filterId):""!=$scope.suggDetailModel.searchBy&&1==$scope.suggDetailModel.searchBy.id&&null!=$scope.suggDetailModel.suggestionNumber&&""!=$scope.suggDetailModel.suggestionNumber?($scope.data.srchKey="SRCH_BY_SUGG_NUMBER",$scope.suggDetailModel.searchById&&($scope.data.suggNum=$scope.suggDetailModel.suggestionNumber,$scope.data.typeId=$scope.selectedFilter.filterId)):""!=$scope.suggDetailModel.searchBy&&3==$scope.suggDetailModel.searchBy.id&&null!=$scope.suggDetailModel.suggestionNumber&&""!=$scope.suggDetailModel.suggestionNumber?($scope.data.srchKey="SRCH_BY_COMPANY_EMP_ID",$scope.suggDetailModel.searchById&&($scope.data.companyEmpNum=$scope.suggDetailModel.suggestionNumber,$scope.data.typeId=$scope.selectedFilter.filterId)):""!=$scope.suggDetailModel.searchBy&&4==$scope.suggDetailModel.searchBy.id&&null!=$scope.suggDetailModel.suggestionNumber&&""!=$scope.suggDetailModel.suggestionNumber?($scope.data.srchKey="SRCH_BY_EMP_NAME",$scope.suggDetailModel.searchById&&($scope.data.empName=$scope.suggDetailModel.suggestionNumber,$scope.data.typeId=$scope.selectedFilter.filterId)):""!=$scope.suggDetailModel.searchBy&&5==$scope.suggDetailModel.searchBy.id&&null!=$scope.suggDetailModel.suggestionNumber&&""!=$scope.suggDetailModel.suggestionNumber&&($scope.data.srchKey="SRCH_BY_SUGG_TITLE",$scope.suggDetailModel.searchById)&&($scope.data.suggestionTitle=$scope.suggDetailModel.suggestionNumber,$scope.data.typeId=$scope.selectedFilter.filterId)),null!=$scope.suggestionPagination.selectedMonth&&null!=$scope.suggestionPagination.selectedMonth&&($scope.data.monthValue=$scope.suggestionPagination.selectedMonth.month,$scope.data.yearValue=$scope.suggestionPagination.selectedMonth.year),null!=$scope.listFilter.circleId&&null!=$scope.listFilter.circleId&&""!=$scope.listFilter.circleId&&($scope.data.circleId=$scope.listFilter.circleId),null!=$scope.listFilter.operationId&&null!=$scope.listFilter.operationId&&""!=$scope.listFilter.operationId&&($scope.data.operationId=$scope.listFilter.operationId),null!=$scope.listFilter.machinePartId&&null!=$scope.listFilter.machinePartId&&""!=$scope.listFilter.machinePartId&&($scope.data.machinePartId=$scope.listFilter.machinePartId),null!=$scope.listFilter.machineId&&null!=$scope.listFilter.machineId&&""!=$scope.listFilter.machineId&&($scope.data.machineId=$scope.listFilter.machineId),null!=$scope.listFilter.stageId&&null!=$scope.listFilter.stageId&&""!=$scope.listFilter.stageId&&($scope.data.stageId=$scope.listFilter.stageId),null!=$scope.listFilter.productId&&null!=$scope.listFilter.productId&&""!=$scope.listFilter.productId&&($scope.data.productId=$scope.listFilter.productId),null!=$scope.listFilter.productNoId&&null!=$scope.listFilter.productNoId&&""!=$scope.listFilter.productNoId&&($scope.data.productNoId=$scope.listFilter.productNoId),$scope.isFilterApplied&&null!=$scope.suggDetailModel.suggPriorityFilter&&""!=$scope.suggDetailModel.suggPriorityFilter&&($scope.data.suggPriority=$scope.suggDetailModel.suggPriorityFilter),null!=$scope.suggDetailModel.selectedLevel&&null!=$scope.suggDetailModel.selectedLevel&&""!=$scope.suggDetailModel.selectedLevel&&($scope.data.suggestionLevel=$scope.suggDetailModel.selectedLevel.level),b.httpPost($scope.data,"getMultiBranchSuggestionCount").then(function(e){$scope.data={},$scope.data.deptId=[],$scope.data.sourceTypes=[],$scope.listFilter.listdeptIds=[],$scope.listFilter.listactivityIds=[],$scope.listFilter.listcatIds=[],$scope.listFilter.listsourceTypes=[],$scope.listFilter.listsuggSource=[],$scope.suggestionDet={},p.setEmpBrowniePoints(),$scope.suggDetailModel.isJuryFlag=e.isJury||"N",$scope.suggDetailModel.isOnholdAuthorityFlag=e.onholdAuthority||"N",$scope.statusWiseCountList=e.suggestionCountList,$scope.totalSuggestionCount=e.totalSuggestionCount;for(var t=$scope.suggestionTotalCount=0;t<$scope.statusWiseCountList.length;t++){4==$scope.statusWiseCountList[t].filterId&&"N"==$scope.suggDetailModel.isOnholdAuthorityFlag&&$scope.statusWiseCountList.splice(t,1),$scope.suggestionTotalCount+=$scope.statusWiseCountList[t].noOfSugesstion,$scope.statusWiseCountList[t].filterId==$scope.statusCountFilter&&($scope.suggestionPagination.totalSuggestion=$scope.statusWiseCountList[t].noOfSugesstion),5==$scope.statusWiseCountList[t].filterId&&($scope.nominationId=$scope.statusWiseCountList[t].nominationId,$scope.flagkizan=!0),$scope.statusWiseCountList[t].viewLabel=$scope.statusWiseCountList[t].filterName;var s,i=E.empDetails.organization.alies;null==i||angular.isUndefined(i)||(s=$scope.statusWiseCountList[t].filterName,"cg"==i?$scope.statusWiseCountList[t].viewLabel=s.replace(/suggestion/gi,"Kaizen"):"gmr"==i&&($scope.statusWiseCountList[t].viewLabel="Lateral Suggestions"===s?"IDEAS HORIZONTAL DEPLOYED":"Kaizen Sustenance Monitoring"===s?"IDEA SUSTENANCE MONITORING":"Knowledge Bank"===s?"IDEA BANK":s.replace(/suggestion/gi,"Idea")))}for(var a=$scope.statusWiseCountList.length;a--;)7!=$scope.statusWiseCountList[a].filterId||E.checkSubMenuAccess("Suggestions","Lateral Suggestion")||$scope.statusWiseCountList.splice(a,1),6!=$scope.statusWiseCountList[a].filterId||E.checkSubMenuAccess("Suggestions","Knowledge Bank")||$scope.statusWiseCountList.splice(a,1),5!=$scope.statusWiseCountList[a].filterId||E.checkSubMenuAccess("Suggestions","Suggestions-Nomination")||"N"!=$scope.suggDetailModel.isJuryFlag||$scope.statusWiseCountList.splice(a,1);0==$scope.statusCountFilter&&($scope.suggestionPagination.totalSuggestion=$scope.totalSuggestionCount[0].noOfSugesstion),1==$scope.typeFilter&&($scope.accessBranchList=$scope.pendingBranchlist)})},$scope.getBranchAccessSetup=function(){b.httpGet("getBranchAccessSetupByEmpId/"+E.empDetails.organization.orgId+"/"+E.empDetails.empId).then(function(e){if($scope.accessBranchList=e.branchAccessList,null!=$scope.accessBranchList&&0<$scope.accessBranchList.length){for(var t=!1,s=0;s<$scope.accessBranchList.length;s++)$scope.accessBranchList[s].isSelected=!0,$scope.accessBranchList[s].branchId==E.empDetails.branch.branchId&&(t=!0);t||((i=angular.copy(E.empDetails.branch)).isSelected=!0,i.branchName=E.empDetails.branch.name,$scope.accessBranchList.push(i)),$scope.selectAllBranch=!0}else{var i;null!=E.empDetails.branch&&((i=angular.copy(E.empDetails.branch)).isSelected=!0,i.branchName=E.empDetails.branch.name,$scope.accessBranchList=[],$scope.accessBranchList.push(i),$scope.selectAllBranch=!0)}0<$scope.accessBranchList.length&&($scope.selectBranchId=$scope.accessBranchList[0].branchId.toString()),$scope.allBranchaccessList=angular.copy($scope.accessBranchList),$scope.sustainKaizenBrancList=angular.copy($scope.accessBranchList),$scope.guestBranchList=angular.copy($scope.accessBranchList),$scope.onholdBranchlist=angular.copy($scope.accessBranchList),$scope.listFilter.accessBranchList=angular.copy($scope.accessBranchList),$scope.listFilter.accessBranchKnowList=angular.copy($scope.listFilter.accessBranchList),$scope.listFilter.accessBranchLateralList=angular.copy($scope.listFilter.accessBranchList),$scope.listFilter.branchId="",$scope.KnowledgeBankBranchaccessList=angular.copy($scope.accessBranchList),$scope.LateralSuggestionsBranchaccessList=angular.copy($scope.accessBranchList),$scope.initMasterDataForSugg(),$scope.getbranchWiseDepartmentList(),$scope.getRoleList()})},$scope.getBranchAccessSetup(),$scope.getbranchWiseDepartmentList=function(){b.httpGet("getdepartmentlistbybranchid/"+$scope.selectBranchId).then(function(e){$scope.branchWiseDeptList=e.deptList,$scope.selectGraphDeptId=$scope.branchWiseDeptList[0].deptId.toString()})},$scope.deptToggle=function(){$(".deptclass .deptwrapper .list").slideToggle("fast")},$scope.toggleDeptDiv=function(e){var t=$(".deptclass .deptwrapper");t===e.target||t.has(e.target).length||$(".list").slideUp("fast")},$scope.rejectionToggle=function(){$(".deptwrapper .reasonList").slideToggle("fast")},$scope.secondRejectionToggle=function(){$(".deptwrapper .second-list").slideToggle("fast")},$scope.implementerRejection=function(){$(".deptwrapper .implementerlist").slideToggle("fast")},$scope.evaluatorRejection=function(){$(".deptwrapper .evaluator-list").slideToggle("fast")},$scope.financeRejection=function(){$(".deptwrapper .finance-list").slideToggle("fast")},$scope.setDeptSelected=function(e){e.isSelected=!e.isSelected;for(var t=0;t<$scope.accessBranchList.length;t++)$scope.accessBranchList.isSelected||($scope.selectAllBranch=!1);0==$scope.statusCountFilter?$scope.getsuggestionList("allSuggestion"):$scope.getsuggestionList("onLoad"),1==$filter("filter")($scope.accessBranchList,{isSelected:!0},!0).length&&null!=(e=$filter("filter")($scope.accessBranchList,{isSelected:!0},!0))[0]&&null!=e[0].branchId&&($scope.getDepartmentList(e[0].branchId),$scope.getCategoryList(e[0].branchId)),$scope.getStatusWiseCount(),$scope.deptToggle()},$scope.selectAllDepartment=function(){var e=!$scope.selectAllBranch;$scope.selectAllBranch=e;for(var t=0;t<$scope.accessBranchList.length;t++)$scope.accessBranchList[t].isSelected=$scope.selectAllBranch;$scope.getStatusWiseCount(),0==$scope.statusCountFilter?$scope.getsuggestionList("allSuggestion"):$scope.getsuggestionList("onLoad"),$scope.deptToggle()},$scope.setActiveFilter=function(e){$scope.typeFilter=e.filterId},$scope.isActiveFilter=function(e){return $scope.typeFilter===e.filterId},$scope.applyFilter=function(e){$scope.closedFilter("clearAll"),$scope.selectedFilter=e,$scope.suggDetailModel.suggPriorityFilter="",$scope.suggDetailModel.selectedLevel=$scope.suggestionLevelList[0],$scope.suggDetailModel.catFilter="",$scope.suggDetailModel.deptFilter="",$scope.suggestionPagination.selectedCatId=0,$scope.suggestionPagination.selectedDeptId=0,$scope.suggDetailModel.selectedCategoryName="",$scope.suggestionPagination.selectedStatus=null,$scope.suggDetailModel.searchModule&&($scope.suggDetailModel.searchModule=!1,$scope.suggDetailModel.searchById=!1),$scope.suggestionDet={},"all"==e?($scope.setActiveFilter("all"),$scope.statusCountFilter=0,$scope.accessBranchList=$scope.allBranchaccessList,$scope.getsuggestionList("allSuggestion")):($scope.setActiveFilter(e),1==$scope.typeFilter?$scope.accessBranchList=$scope.pendingBranchlist:2==$scope.typeFilter?$scope.accessBranchList=$scope.mySuggBranchlist:4==$scope.typeFilter?$scope.accessBranchList=$scope.onholdBranchlist:6==$scope.typeFilter?$scope.listFilter.accessBranchList=$scope.listFilter.accessBranchKnowList:7==$scope.typeFilter?$scope.listFilter.accessBranchList=$scope.listFilter.accessBranchLateralList:7==$scope.typeFilter||6==$scope.typeFilter?($scope.listFilter.catagoryList=$scope.listFilter.catagoryLateralList,$scope.listFilter.activityList=$scope.listFilter.activityLateralList,$scope.listFilter.suggestionSourceList=$scope.listFilter.suggestionSourceLateralList,$scope.listFilter.departmentList=$scope.listFilter.departmentLateralList):5==$scope.typeFilter?($scope.getJueryStatusList(),$scope.setJuryTab(1)):8==$scope.typeFilter?$scope.accessBranchList=$scope.guestBranchList:9==$scope.typeFilter&&($scope.accessBranchList=$scope.sustainKaizenBrancList),9!=$scope.typeFilter&&6!=$scope.typeFilter&&7!=$scope.typeFilter?($scope.suggestionPagination.current=1,$scope.suggestionPagination.suggestionPerPage=20):($scope.suggestionPagination.current=1,$scope.suggestionPagination.suggestionPerPage=10),$scope.statusCountFilter=e.filterId,$scope.suggDetailModel.searchKeyword="",$scope.suggDetailModel.suggestionNumber="",$scope.getsuggestionList("onLoad")),$scope.getStatusWiseCount(),$scope.flagSuggestionFilter=!0},$scope.defaultFilter={filterId:$scope.CONST.COUNT_FILTERS.PENDING},$scope.typeFilter=$scope.defaultFilter.filterId,$scope.onRepeatEnd=function(e){$timeout(function(){"onUpdate"==$scope.getSuggestionDetailsFlag?$scope.getSuggestionDetails($scope.selectedSuggId,"onSuggSelect"):"suggList"==e&&$scope.getSuggestionDetails($scope.suggestionList[0].sugId,"onSuggSelect",$scope.suggestionList[0].sourceType)},1)},$scope.getRoleList=function(){b.httpGet("getlistofrole").then(function(e){e.reason?$scope.roleList=e.roleList:$scope.RoleList=[]})},$scope.isReopenSugg=function(e){var t=!1;return t=!e||e.statusId!=$scope.CONST.STATUS.Sustained.statusId&&e.statusId!=$scope.CONST.STATUS.SustainanceFailed.statusId?t:!0},$scope.getSustenaceAuditorList=function(){if(null!=$scope.sustenanceAuditorList&&0<$filter("filter")($scope.sustenanceAuditorList,{branchId:$scope.selectedSustenaceData.branchId},!0).length)for(let e=0;e<$scope.sustenanceAuditorList.length;e++)$scope.sustenanceAuditorList[e].empId==$scope.selectedSustenaceData.susAuditorId&&($scope.selectedSustenaceData.susAuditorData=$scope.sustenanceAuditorList[e]);else{var e={branchId:$scope.selectedSustenaceData.branchId,type:"SUGGESTION"};b.httpPost(e,"getAuditorDetailsNew").then(function(t){if(t.result)if($scope.sustenanceAuditorList=[],null!=t.auditorList&&0<t.auditorList.length){for(let e=0;e<t.auditorList.length;e++)t.auditorList[e].empId==$scope.selectedSustenaceData.susAuditorId&&($scope.selectedSustenaceData.susAuditorData=t.auditorList[e]);$scope.sustenanceAuditorList=t.auditorList}else $scope.sustenanceAuditorList=[];else $scope.sustenanceAuditorList=[]})}},$scope.viewAuditorModal=function(e){$scope.selectedSustenaceData=e,$scope.getSustenaceAuditorList(),$("#sustenanceAuditorModal").modal({backdrop:"static",keyboard:!1})},$scope.submitLoader=!1,$scope.reopenSustenenceAudit=function(){$scope.submitLoader=!0;var e={sugId:$scope.selectedSustenaceData.sugId,auditorId:$scope.selectedSustenaceData.susAuditorData.empId,createdBy:$scope.loggedInEmpId,updatedBy:$scope.loggedInEmpId};b.httpPost(e,"ReassignedToSustenanceAuditor").then(function(e){$scope.submitLoader=!1,e.result?(C.create("Suggestion assinged successfully",3e3,"success"),$("#sustenanceAuditorModal").modal("hide"),$scope.selectedSustenaceData={},$scope.getsuggestionList("onUpdate")):100==e.statusCode?C.create(e.reason,3e3,"error"):C.create("Error occurred while submitting data. Please try again.",3e3,"error")})},$scope.getBenefitAnalysisList=function(e){b.httpGet("getbenefitanalysislist/0/"+e).then(function(t){if(t.result)if(null!=t.benefitAnalysisList&&0<t.benefitAnalysisList.length){for(let e=0;e<t.benefitAnalysisList.length;e++)t.benefitAnalysisList[e].isselect=!1,t.benefitAnalysisList[e].isBenefitChecked=!1;$scope.benefitList=t.benefitAnalysisList,$scope.isBenefitBeforChecked()}else $scope.benefitList=[];else $scope.benefitList=[]})},$scope.getSustenanceAudit=function(){b.httpGet("getSustenanceAuditParam").then(function(e){e.result&&null!=e.auditParamList&&0<e.auditParamList.length?$scope.suggestionDet.sustenanceAuditData.questions=e.auditParamList:$scope.suggestionDet.sustenanceAuditData.questions=[]})},$scope.showkaizenMonitorDetails=function(e,t,s,i){$scope.getSuggestionDetails(e,t,s),$scope.selectedAuditorName=i,$("#sustanceModal").modal({backdrop:"static",keyboard:!1})},$scope.getDocumentsList=function(e){b.httpGet("getdocumentlistbybranchid/"+e).then(function(e){e.result&&null!=e.document&&0<e.document.length?($scope.documentLists=e.document,$scope.isdocumentBeforeCheck()):$scope.documentLists=[]})},$scope.getSuggCategoryList=function(e){b.httpGet("getcategorylistbyorgid/0/"+e).then(function(e){e.result&&null!=e.catagoryList&&0<e.catagoryList.length?$scope.suggCatbranchwise=e.catagoryList:$scope.suggCatbranchwise=[]})},$scope.initSuggData=function(e){E.getOrgByAlies("dcmsugar")&&$scope.getSuggAccessList(e),$scope.getDepartmentList(e),$scope.getDocumentsList(e)},$scope.getSuggestionDetails=function(e,t,s){$scope.suggestionDet={},$scope.suggestionBranchConfig={},$scope.selectedsourceType=s,$scope.flagrejectEvalarea=!1,$scope.flagrejarea=!1,$scope.flagrejectonhold=!1,$scope.flagresumeonhold=!1,$scope.flagAccRejTextarea=!1,$scope.flagAccPillerLeavel=!1,$scope.flagImpReject=!1,$scope.isDropdownRejEval=!1,$scope.isEvaluatorReject=!1,$scope.isFinanceReject=!1,$scope.isDropdownRejFc=!1,$scope.isSubmitFinanace=!1,$scope.isRejectByEval=!1,$scope.selectAllRejection=!1,$scope.suggestionInputDetails={},$scope.suggestionInputDetails.currentDate=$filter("date")(new Date,"yyyy-MM-dd"),$scope.cfmValue="",$scope.selectedEmpList=[],$scope.showComment=!1,$scope.showCommentButon=!1,$scope.flagCheckVerify=!1,$scope.implData.safetImplactionSummary=null,$scope.underFinanceApprovalList=[],$scope.cfmValue="",$scope.empInputDet.selectedEmpIds=[],$scope.empInputDet.selectedEmpId="",$scope.empInputDet.selectedRowId="",1==$scope.mainTab?$scope.inFlightSugg=!0:4==$scope.mainTab&&($scope.inFlightSugg=!1),"onSuggSelect"==t?($scope.flagSuggDetBoxIndicator=!0,$scope.suggestionDet={}):$scope.flagSuggDetLoader=!0,$scope.setActiveSuggCard(e),$scope.selectedSuggId=e,$scope.suggestionInputDetails.acceptRejectStatus="",$scope.getSuggestionDetailsFlag="",$scope.analysisRecommendTabsFillStatus={changeDoc:!1,kaizenActivity:!1,otherBenefits:!1,horizontalDeployment:!1,recommendation:!1},$scope.tabContentChecked={benefits:!1,markBenefitsAsClicked:!1,otherBenefits:!1,markOtherBenefitsAsClicked:!1,hzDeployment:!1,markHzDeployementClicked:!1,whyAnalysis:!1,kaizenSustain:!1,results:!1,financeVerification:!1,teamMembers:!1,markTeamMemberAsClicked:!1},b.httpGet("getSuggestionDetails/"+e).then(function(e){if($scope.flagSuggDetLoader=!1,$scope.isExecutiveSugg=!1,$scope.flagSuggDetBoxIndicator=!1,$scope.isSelectedSuggestionEdited=!1,null!=e&&"success"==e.status){if($scope.clearSuggDetFields(),$scope.suggestionDet.exportCer="",$scope.suggestionDet=e.sugesstionDetails,$scope.suggestionBranchConfig=e.suggBranchConfig,e.data&&($scope.getFCList(),$scope.suggestionDet.FCData=e.data),$scope.checkImplData($scope.suggestionDet),$scope.getRejectionListDetails($scope.suggestionDet.sugId),$scope.dropDownRejectionList(),$scope.getEvalcommentDetails(),$scope.initSuggData($scope.suggestionDet.branch.branchId),$scope.getHDSuggestionConfigList($scope.suggestionDet.branch.branchId),$scope.suggestionDet.recommendationData={},$scope.suggestionDet.recommendationData.ideaAwardCommentEval=$scope.suggestionDet.ideaAwardCommentEval||"",$scope.suggestionDet.recommendationData.ideaAwardRecommEval=$scope.suggestionDet.ideaAwardRecommEval||"",$scope.suggestionDet.recommendationData.implAwardCommentEval=$scope.suggestionDet.implAwardCommentEval||"",$scope.suggestionDet.recommendationData.implAwardRecommEval=$scope.suggestionDet.implAwardRecommEval||"",null!=$scope.suggestionDet.isCFMRequired&&""!=$scope.suggestionDet.isCFMRequired&&"Y"==$scope.suggestionDet.isCFMRequired?$scope.suggestionDet.isCFMRequired=!0:$scope.suggestionDet.isCFMRequired=!1,null!=$scope.suggestionDet.isCFMApprove&&""!=$scope.suggestionDet.isCFMApprove&&"Y"==$scope.suggestionDet.isCFMApprove?$scope.suggestionDet.isCFMApprove=!0:$scope.suggestionDet.isCFMApprove=!1,"HD"==$scope.suggestionDet.sourceType&&null!=$scope.suggestionDet.suggestionHD&&($scope.suggestionDet.parentSuggestionHDId=$scope.suggestionDet.suggestionHD.parentSuggId),null!=$scope.suggestionDet.suggestionTrackerDetails)for(let e=0;e<$scope.suggestionDet.suggestionTrackerDetails.length;e++)null!=$scope.suggestionDet.suggestionTrackerDetails[e].team_type_master&&"Implementation"==$scope.suggestionDet.suggestionTrackerDetails[e].team_type_master.type&&($scope.implwhyWhyAnalysisData=$scope.suggestionDet.suggestionTrackerDetails[e]);if(null!=$scope.suggestionDet.category?$scope.suggestionDet.hdCatId=$scope.isEmpty($scope.suggestionDet.category)?"":$scope.suggestionDet.category:$scope.suggestionDet.hdCatId="",$scope.suggestionDet.suggestionPointAuditList=e.suggestionPointAuditList,$scope.suggestionDet.suggestionHDList=e.suggestionHDList,null!=e.suggestionHDList)for(var t=0;t<e.suggestionHDList.length;t++)e.suggestionHDList[t].filterCreatedDate=$filter("date")(new Date(e.suggestionHDList[t].createdDate),"yyyy-MM-dd");$scope.suggestionDet.sustenanceAuditorId&&($scope.implInputData.sustenanceAuditorId=$scope.suggestionDet.sustenanceAuditorId.toString()),$scope.setExportData(e.sugesstionDetails),$scope.suggestionDet.changeDocInput="",$scope.suggestionDet.docFileName="",null==$scope.suggestionDet.pillar||$scope.checkForHdConfig()||($scope.suggestionDet.activityId=$scope.suggestionDet.pillar.id),$scope.getParticular($scope.suggestionDet.branch.branchId);for(var s=0;s<$scope.suggestionDet.evaluationTeamList.length;s++)"null"==$scope.suggestionDet.evaluationTeamList[s].evaluationInputs&&($scope.suggestionDet.evaluationTeamList[s].evaluationInputs="");for(s=0;s<$scope.suggestionDet.implTeamList.length;s++)"null"==$scope.suggestionDet.implTeamList[s].implInputs&&($scope.suggestionDet.implTeamList[s].implInputs="");for(s=0;s<$scope.suggestionDet.sugEmpDocDetails.length;s++)null!=$scope.suggestionDet.sugEmpDocDetails[s].url&&null!=$scope.suggestionDet.sugEmpDocDetails[s].url.lastIndexOf(".")&&($scope.suggestionDet.sugEmpDocDetails[s].ext=$scope.suggestionDet.sugEmpDocDetails[s].url.substring($scope.suggestionDet.sugEmpDocDetails[s].url.lastIndexOf(".")+1));if(1==$scope.suggestionDet.isExecutive&&($scope.isExecutiveSugg=!0),$scope.clTab=$scope.suggestionDet.evaluationTeamList.length-1,$scope.implClTab=$scope.suggestionDet.implTeamList.length-1,$scope.lastSuggStatusAuditId=$scope.suggestionDet.sugesstionStatusAudit[$scope.suggestionDet.sugesstionStatusAudit.length-1].status_master.statusId,0<$scope.suggestionDet.implBenefitAnalysisList.length&&null!=$scope.suggestionDet.implBenefitAnalysisList){for(var i=[],s=0;s<$scope.suggestionDet.implBenefitAnalysisList.length;s++)i.push($scope.suggestionDet.implBenefitAnalysisList[s].benefitAnalysis.benefits);$scope.kaizenExportFormatedData.benefits=i.toString()}if(null!=$scope.suggestionDet.document&&0!=$scope.suggestionDet.document.length){$scope.suggestionDet.doc={};for(s=0;s<$scope.suggestionDet.document.length;s++)null!=$scope.suggestionDet.document[s].fileName||""!=$scope.suggestionDet.document[s].fileName?$scope.suggestionDet.doc.fileName=$scope.suggestionDet.document[s].fileName:$scope.suggestionDet.doc.fileName="N/A",null!=$scope.suggestionDet.document[s].document.documentName||""!=$scope.suggestionDet.document[s].document.documentName?$scope.suggestionDet.doc.docName=$scope.suggestionDet.document[s].document.documentName:$scope.suggestionDet.doc.docName="N/A",null==$scope.suggestionDet.document[s].document.owner.firstName&&""==$scope.suggestionDet.document[s].document.owner.firstName&&""==$scope.suggestionDet.document[s].document.owner.lastName&&null==$scope.suggestionDet.document[s].document.owner.lastName||($scope.suggestionDet.doc.ownerName=$scope.suggestionDet.document[s].document.owner.firstName+" "+$scope.suggestionDet.document[s].document.owner.lastName)}else $scope.suggestionDet.doc={};for(s=0;s<$scope.suggestionDet.sugesstionStatusAudit.length;s++){if($scope.suggestionDet.sugesstionStatusAudit[s].status_master.status==$scope.CONST.STATUS.EditedByCreator.status&&($scope.isSelectedSuggestionEdited=!0),$scope.suggestionDet.sugesstionStatusAudit[s].status_master.status==$scope.CONST.STATUS.EvaluationAssigned.status&&($scope.evalAssignedStatusAdtId=$scope.suggestionDet.sugesstionStatusAudit[s].stsadtId),$scope.suggestionDet.sugesstionStatusAudit[s].status_master.status==$scope.CONST.STATUS.ImplementationAssigned.status&&($scope.evalAssignedStatusAdtId=$scope.suggestionDet.sugesstionStatusAudit[s].stsadtId,$scope.implAssignedStatusAdtId=$scope.suggestionDet.sugesstionStatusAudit[s].stsadtId),null!=$scope.suggestionDet.sugesstionStatusAudit[s].emp_details&&null!=$scope.suggestionDet.sugesstionStatusAudit[s].emp_details&&null!=$scope.suggestionDet.sugesstionStatusAudit[s].emp_details.departmentLevel&&0<$scope.suggestionDet.sugesstionStatusAudit[s].emp_details.departmentLevel.length&&($scope.maxUserLevel=$scope.suggestionDet.sugesstionStatusAudit[s].emp_details.departmentLevel[0].level),$scope.suggestionDet.sugesstionStatusAudit[s].status_master.status==$scope.CONST.STATUS.Implemented.status){if($scope.suggestionDet.ownerDetails=[],null!=$scope.suggestionDet.document&&0!=$scope.suggestionDet.document.length)for(var a,t=0;t<$scope.suggestionDet.document.length;t++)"COMPLETED"==$scope.suggestionDet.document[t].status&&(a={ownerName:$scope.suggestionDet.document[t].document.owner.firstName+" "+$scope.suggestionDet.document[t].document.owner.lastName,docName:$scope.suggestionDet.document[t].document.documentName,docDate:$scope.suggestionDet.document[t].updatedDate},$scope.suggestionDet.ownerDetails.push(a));$scope.suggestionDet.sustenanceAuditData={},$scope.getSustenanceAudit()}$scope.suggestionDet.sugesstionStatusAudit[s].status_master.status==$scope.CONST.STATUS.UnderFinanceVerification.status&&$scope.underFinanceApprovalList.push($scope.suggestionDet.sugesstionStatusAudit[s])}if(null!=$scope.suggestionDet.evaluationPointsSavingList&&0!=$scope.suggestionDet.evaluationPointsSavingList.length){$scope.SavingTypeLists=[];for(let e=0;e<$scope.suggestionDet.evaluationPointsSavingList.length;e++){var n=$scope.suggestionDet.evaluationPointsSavingList[e].setPointsForSaving,n={type:n.savingOptions.name,option:n.savingOptionsRole.name,amt:n.amountUpto+"("+n.currency.code+")",points:n.points,minutes:n.minutes,tabId:n.savingOptions.id,selectedId:$scope.suggestionDet.evaluationPointsSavingList[e].id,amtId:n.id};$scope.SavingTypeLists.push(n)}}else $scope.SavingTypeLists=[];if(null!=$scope.activityList&&0<$scope.activityList.length)for(var l=0;l<$scope.activityList.length;l++)$scope.activityList[l].isselect=!1;if(null!=$scope.suggestionDet.suggestionActivityList&&0<$scope.suggestionDet.suggestionActivityList.length)for(s=0;s<$scope.suggestionDet.suggestionActivityList.length;s++)for(t=0;t<$scope.activityList.length;t++)if($scope.suggestionDet.suggestionActivityList[s].activity.id==$scope.activityList[t].id){$scope.activityList[t].isselect=!0,$scope.activityIdList=$scope.suggestionDet.suggestionActivityList[s].activity.id;break}for(s=0;s<$scope.suggestionDet.suggestionTrackerDetails.length;s++)if(null!=$scope.suggestionDet.suggestionTrackerDetails[s].team_type_master&&1==$scope.suggestionDet.suggestionTrackerDetails[s].team_type_master.teamTypeId){$scope.suggestionDet.eval=$scope.suggestionDet.suggestionTrackerDetails[s];break}for(l=0;l<$scope.orgLevelBenefitMasterList.length;l++)$scope.orgLevelBenefitMasterList[l].isselect=!1;if(null!=$scope.suggestionDet.implBenefitAnalysisList&&0<$scope.suggestionDet.implBenefitAnalysisList.length)for(s=0;s<$scope.suggestionDet.implBenefitAnalysisList.length;s++)for(t=0;t<$scope.orgLevelBenefitMasterList.length;t++)if($scope.orgLevelBenefitMasterList[t].benfitId==$scope.suggestionDet.implBenefitAnalysisList[s].benefitAnalysis.benfitId){$scope.orgLevelBenefitMasterList[t].isselect=!0;break}$scope.setDocumentStatusData();var o=$scope.suggestionDet.sugesstionStatusAudit.reduce(function(e,t){var s;return t.status_master.statusId==$scope.CONST.STATUS.AssignedToImplementorForHorizantalDeployement.statusId&&(e[s=t.status_master.statusId]=e[s]||[],e[s].push(t)),e},{}),r=Object.keys(o).map(function(e){return{statusId:e,status_master:$scope.CONST.STATUS.AssignedToImplementorForHorizantalDeployement,status_audit:o[e],emp_details:o[e][0].emp_details,actionStatus:o[e][0].actionStatus}}),g=-1;if(null!=r&&0<r.length)for(s=0;s<$scope.suggestionDet.sugesstionStatusAudit.length;s++)$scope.suggestionDet.sugesstionStatusAudit[s].status_master.status==$scope.CONST.STATUS.AssignedToImplementorForHorizantalDeployement.status&&(-1==g?($scope.suggestionDet.sugesstionStatusAudit[s]=r[0],g=s):$scope.suggestionDet.sugesstionStatusAudit.splice(s,1));var u=$scope.suggestionDet.suggestionHorizontalDept.reduce(function(e,t){var s=t.deptId;return e[s]=e[s]||[],e[s].push(t),e},{});$scope.suggestionDet.suggestionHorizontalDeptGroup=[],$scope.suggestionDet.suggestionHorizontalDeptGroup=Object.keys(u).map(function(e){var s=[],i=!1;return angular.forEach(u[e],function(e,t){null!=e.lineId&&0!=e.lineId&&(i=!0,s.push({id:e.id,lineId:e.lineId,name:e.lineName,isselect:!0,isEvalselect:!0,isImplselect:!0}))}),i&&s.push({id:0,lineId:0,name:"All",isselect:!0}),{id:0==s.length?u[e][0].id:0,deptId:parseInt(e),deptName:u[e][0].deptName,lineFound:0<s.length,lineList:s,data:u[e],isselect:!0}});for(s=0;s<$scope.departmentList.length;s++){$scope.departmentList[s].isselect=!1,$scope.departmentList[s].isEvalselect=!1,$scope.departmentList[s].isImplselect=!1,$scope.departmentList[s].lineFound=!1,$scope.departmentList[s].lineList=[];var d=$filter("filter")($scope.suggestionDet.suggestionHorizontalDeptGroup,{deptId:$scope.departmentList[s].deptId},!0).length;if("All"!=$scope.departmentList[s].deptName&&0<d){$scope.departmentList[s].isselect=!0,$scope.departmentList[s].isEvalselect=!0,$scope.departmentList[s].isImplselect=!0,$scope.departmentList[s].lineList=[];for(t=0;t<$scope.suggestionDet.suggestionHorizontalDeptGroup.length;t++)$scope.suggestionDet.suggestionHorizontalDeptGroup[t].deptId==$scope.departmentList[s].deptId&&$scope.suggestionDet.suggestionHorizontalDeptGroup[t].lineFound&&($scope.departmentList[s].lineFound=!0,$scope.departmentList[s].lineList=$scope.suggestionDet.suggestionHorizontalDeptGroup[t].lineList)}}null!=$scope.suggestionDet.sugEmpDocDetails&&0<$filter("filter")($scope.suggestionDet.sugEmpDocDetails,{docType:"beforeDoc"},!0).length?$scope.suggestionDet.beforeImgArray=$filter("filter")($scope.suggestionDet.sugEmpDocDetails,{docType:"beforeDoc"},!0):$scope.suggestionDet.beforeImgArray=[],$scope.suggestionDet.blocksummery={};var c=[];if(null!=$scope.suggestionDet.sugEmpDocDetails&&0<$filter("filter")($scope.suggestionDet.sugEmpDocDetails,{docType:"beforeDoc"},!0).length?$scope.suggestionDet.blocksummery.beforeImg=$filter("filter")($scope.suggestionDet.sugEmpDocDetails,{docType:"beforeDoc"},!0):$scope.suggestionDet.blocksummery.beforeImg=[],null!=$scope.suggestionDet.implBenefitAnalysisList&&0<$scope.suggestionDet.implBenefitAnalysisList.length){for(s=0;s<$scope.suggestionDet.implBenefitAnalysisList.length;s++)c.push($scope.suggestionDet.implBenefitAnalysisList[s].benefitAnalysis.benefits);$scope.suggestionDet.blocksummery.benefits=c.join()}var p="";if(null!=$scope.orgLevelBenefitMasterList&&0<$scope.orgLevelBenefitMasterList.length){for(s=0;s<$scope.orgLevelBenefitMasterList.length;s++)$scope.orgLevelBenefitMasterList[s].branch.branchId==$scope.suggestionDet.branch.branchId&&($scope.orgLevelBenefitMasterList[s].isselect?p+="<span style='width: 30px;border: 1px solid #000;margin: 1px;position: relative;padding:5px;font-weight:bold;'>"+$scope.orgLevelBenefitMasterList[s].benefits[0]+"<div style='position: absolute;right: 0px;top:-3px;'><span style='font-size:12px;color: #615b5b;font-weight:bold;'>&#10003;</span></div></span>":p+="<span style='width: 30px;border: 1px solid #000;margin: 1px;position: relative;padding:5px;'>"+$scope.orgLevelBenefitMasterList[s].benefits[0]+"</span>");$scope.suggestionDet.blocksummery.category=p}for(s=0;s<$scope.suggestionDet.sugesstionStatusAudit.length;s++)$scope.suggestionDet.sugesstionStatusAudit[s].status_master.status==$scope.CONST.STATUS.SuggestionAssigned.status&&($scope.suggestionDet.blocksummery.controller=$scope.suggestionDet.sugesstionStatusAudit[s].emp_details);var m=[];if(null!=$scope.suggestionDet.evaluationTeamList&&0<$scope.suggestionDet.evaluationTeamList.length){for(s=0;s<$scope.suggestionDet.evaluationTeamList.length;s++)m.push($scope.suggestionDet.evaluationTeamList[s].empName);$scope.suggestionDet.blocksummery.evaluator=m.join()}var D=[];if(null!=$scope.suggestionDet.implTeamList&&0<$scope.suggestionDet.implTeamList.length){for(s=0;s<$scope.suggestionDet.implTeamList.length;s++)D.push($scope.suggestionDet.implTeamList[s].empName);$scope.suggestionDet.blocksummery.implementor=D.join()}var f=[],h=[],I=[];if(null!=$scope.suggestionDet.document&&null!=$scope.suggestionDet.document&&0<$scope.suggestionDet.document.length){for(var y=0;y<$scope.suggestionDet.document.length;y++)"COMPLETED"==$scope.suggestionDet.document[y].status&&(f.push($scope.suggestionDet.document[y].document.owner.firstName+" "+$scope.suggestionDet.document[y].document.owner.lastName),h.push($scope.suggestionDet.document[y].document.documentName),I.push($scope.suggestionDet.document[y].createdDate));$scope.suggestionDet.blocksummery.documentOwnerName=f.join(),$scope.suggestionDet.blocksummery.documentName=h.join(),$scope.suggestionDet.blocksummery.documentModifyDate=I.join()}var S=[];if(null!=$scope.suggestionDet.sugImplTeam&&null!=$scope.suggestionDet.sugImplTeam&&0<$scope.suggestionDet.sugImplTeam.length){for(s=0;s<$scope.suggestionDet.sugImplTeam.length;s++)S.push($scope.suggestionDet.sugImplTeam[s].empName);$scope.suggestionDet.blocksummery.implementationTeam=S.join()}var L="";if(null!=$scope.suggestionDet.implTeamList&&null!=$scope.suggestionDet.implTeamList&&0<$scope.suggestionDet.implTeamList.length){for(s=0;s<$scope.suggestionDet.implTeamList.length;s++)L=$scope.suggestionDet.implTeamList[0].costEffective;$scope.suggestionDet.blocksummery.savingCost=L}if(null!=$scope.suggestionDet.sugesstionStatusAudit&&0<$scope.suggestionDet.sugesstionStatusAudit.length)for(s=0;s<$scope.suggestionDet.sugesstionStatusAudit.length;s++)$scope.suggestionDet.sugesstionStatusAudit[s].status_master.status==$scope.CONST.STATUS.Implemented.status&&($scope.suggestionDet.kaizenEndDate=$filter("date")(new Date($scope.suggestionDet.sugesstionStatusAudit[s].createdDate),"d MMM, y"),$scope.suggestionDet.implInputs=$scope.suggestionDet.sugesstionStatusAudit[s].summary||"N/A"),$scope.suggestionDet.sugesstionStatusAudit[s].status_master.status==$scope.CONST.STATUS.UnderFinanceApproval.status&&($scope.suggestionDet.blocksummery.financeController=$scope.suggestionDet.sugesstionStatusAudit[s].emp_details.firstName+" "+$scope.suggestionDet.sugesstionStatusAudit[s].emp_details.lastName);if(null!=$scope.suggestionDet.sugesstionStatusAudit&&0<$scope.suggestionDet.sugesstionStatusAudit.length)for(s=0;s<$scope.suggestionDet.sugesstionStatusAudit.length;s++)$scope.suggestionDet.sugesstionStatusAudit[s].status_master.status==$scope.CONST.STATUS.UnderFinanceVerification.status&&($scope.suggestionDet.blocksummery.financeValidator=$scope.suggestionDet.sugesstionStatusAudit[s].emp_details.firstName+" "+$scope.suggestionDet.sugesstionStatusAudit[s].emp_details.lastName);var v,T=[];if(null!=$scope.suggestionDet.document&&0<$scope.suggestionDet.document.length){for(let e=0;e<$scope.suggestionDet.document.length;e++)"COMPLETED"==$scope.suggestionDet.document[e].status&&(v=$scope.suggestionDet.document[e],T.push(v.document.documentName));$scope.suggestionDet.blocksummery.document=T.join()}if($scope.machineHDList=[],null!=$scope.suggestionDet.suggestionHorizontalDept&&0<$scope.suggestionDet.suggestionHorizontalDept.length)for(s=0;s<$scope.suggestionDet.suggestionHorizontalDept.length;s++)null!=$scope.suggestionDet.suggestionHorizontalDept[s].operationId&&"PLANT_LEVEL"==$scope.suggestionDet.suggestionHorizontalDept[s].hdType&&(E={circle:{id:$scope.suggestionDet.suggestionHorizontalDept[s].circleId,circleName:$scope.suggestionDet.suggestionHorizontalDept[s].circleName},stage:{id:$scope.suggestionDet.suggestionHorizontalDept[s].stageId,stageName:$scope.suggestionDet.suggestionHorizontalDept[s].stageName},product:{id:$scope.suggestionDet.suggestionHorizontalDept[s].productId,productName:$scope.suggestionDet.suggestionHorizontalDept[s].productName},machine:{id:$scope.suggestionDet.suggestionHorizontalDept[s].machineId,machineName:$scope.suggestionDet.suggestionHorizontalDept[s].machineName},productNo:{id:$scope.suggestionDet.suggestionHorizontalDept[s].productNoId,productNo:$scope.suggestionDet.suggestionHorizontalDept[s].productNo},operation:{id:$scope.suggestionDet.suggestionHorizontalDept[s].operationId,operationType:$scope.suggestionDet.suggestionHorizontalDept[s].operationType}},$scope.machineHDList.push(E));if($scope.implMachineHDList=[],null!=$scope.suggestionDet.suggestionHorizontalDept&&0<$scope.suggestionDet.suggestionHorizontalDept.length)for(var E,s=0;s<$scope.suggestionDet.suggestionHorizontalDept.length;s++)null!=$scope.suggestionDet.suggestionHorizontalDept[s].operationId&&"PLANT_LEVEL"==$scope.suggestionDet.suggestionHorizontalDept[s].hdType&&(E={id:$scope.suggestionDet.suggestionHorizontalDept[s].id,circle:{id:$scope.suggestionDet.suggestionHorizontalDept[s].circleId,circleName:$scope.suggestionDet.suggestionHorizontalDept[s].circleName},stage:{id:$scope.suggestionDet.suggestionHorizontalDept[s].stageId,stageName:$scope.suggestionDet.suggestionHorizontalDept[s].stageName},product:{id:$scope.suggestionDet.suggestionHorizontalDept[s].productId,productName:$scope.suggestionDet.suggestionHorizontalDept[s].productName},machine:{id:$scope.suggestionDet.suggestionHorizontalDept[s].machineId,machineName:$scope.suggestionDet.suggestionHorizontalDept[s].machineName},productNo:{id:$scope.suggestionDet.suggestionHorizontalDept[s].productNoId,productNo:$scope.suggestionDet.suggestionHorizontalDept[s].productNo},operation:{id:$scope.suggestionDet.suggestionHorizontalDept[s].operationId,operationType:$scope.suggestionDet.suggestionHorizontalDept[s].operationType}},$scope.implMachineHDList.push(E));if(null!=$scope.suggestionDet.pillar&&null!=$scope.activityList&&0<$scope.activityList.length)for(let e=0;e<$scope.activityList.length;e++)$scope.activityList[e].isselectjury=!1,$scope.activityList[e].id==$scope.suggestionDet.pillar.id&&($scope.activityList[e].isselectjury=!0);if(null!=$scope.suggestionDet.sustenanceAuditorInputs&&0<$scope.suggestionDet.sustenanceAuditorInputs.length)for(let e=0;e<$scope.suggestionDet.sustenanceAuditorInputs.length;e++)$scope.suggestionDet.sustenanceAuditorInputs[e].createdDate=$scope.suggestionDet.sustenanceAuditorInputs[e].createdDate?$filter("date")(new Date($scope.suggestionDet.sustenanceAuditorInputs[e].createdDate),"dd/MM/yyyy"):"",$scope.suggestionDet.sustenanceAuditorInputs[e].verificationDt=$scope.suggestionDet.sustenanceAuditorInputs[e].verificationDt?$filter("date")(new Date($scope.suggestionDet.sustenanceAuditorInputs[e].verificationDt),"dd/MM/yyyy"):""}else $scope.suggestionDet={},C.create($filter("translate")("Oops_Please_try_again"),4e3,"error");0==$scope.suggestionList.length&&($scope.suggestionDet={}),$scope.isEmpty($scope.suggestionDet)||5==$scope.statusCountFilter||6==$scope.typeFilter||$scope.scrollToBottom("#suggDetailsContainer")})},$scope.setDocumentStatusData=function(){for(var e=[],t=-1,s=0;s<$scope.suggestionDet.sugesstionStatusAudit.length;s++)if((c=$scope.suggestionDet.sugesstionStatusAudit[s]).status_master.status==$scope.CONST.STATUS.PendingDocumentUpdate.status){for(var i=-1,a=0;a<$scope.suggestionDet.document.length;a++)if($scope.suggestionDet.document[a].audit.stsadtId==c.stsadtId){i=a,t=s;break}e.push(-1!=i?{audit:c,document:$scope.suggestionDet.document[i]}:{audit:c})}0<e.length&&($scope.suggestionDet.sugesstionStatusAudit[t]={status_master:e[0].audit.status_master,docList:e});var n,l,o=$scope.suggestionDet.sugesstionStatusAudit.reduce(function(e,t){var s;return t.status_master.statusId==$scope.CONST.STATUS.DCAssignedForVerification.statusId&&(e[s=t.status_master.statusId]=e[s]||[],e[s].push(t)),e},{}),r=Object.keys(o).map(function(e){return{statusId:e,status_master:$scope.CONST.STATUS.DCAssignedForVerification,status_audit:o[e],emp_details:o[e][0].emp_details,actionStatus:o[e][0].actionStatus,docList:$scope.suggestionDet.document}}),g=(consoleLog("Dock List"),consoleLog(r),-1);if(null!=r&&0<r.length)for(s=0;s<$scope.suggestionDet.sugesstionStatusAudit.length;s++)(c=$scope.suggestionDet.sugesstionStatusAudit[s]).status_master.status==$scope.CONST.STATUS.DCAssignedForVerification.status&&(-1==g?($scope.suggestionDet.sugesstionStatusAudit[s]=r[0],g=s):$scope.suggestionDet.sugesstionStatusAudit.splice(s,1));if($scope.suggestionDet.status_master.status==$scope.CONST.STATUS.PendingDocumentUpdate.status||$scope.suggestionDet.status_master.status==$scope.CONST.STATUS.DCAssignedForVerification.status)$scope.suggestionDet.status_master.status==$scope.CONST.STATUS.PendingDocumentUpdate.status?(0<r.length&&$scope.suggestionDet.sugesstionStatusAudit.push({status_masterDV:$scope.CONST.STATUS.DCAssignedForVerification,docList:r,status_master:$scope.CONST.STATUS.DCAssignedForVerification}),0<e.length&&$scope.suggestionDet.sugesstionStatusAudit.push({status_masterDC:e[0].audit.status_master,docList:e,status_master:e[0].audit.status_master})):$scope.suggestionDet.status_master.status==$scope.CONST.STATUS.DCAssignedForVerification.status&&(0<e.length&&$scope.suggestionDet.sugesstionStatusAudit.push({status_masterDC:e[0].audit.status_master,docList:e,status_master:e[0].audit.status_master}),0<r.length)&&$scope.suggestionDet.sugesstionStatusAudit.push({status_masterDV:$scope.CONST.STATUS.DCAssignedForVerification,docList:r,status_master:$scope.CONST.STATUS.DCAssignedForVerification});else{for(var u=-1,d=-1,s=0;s<$scope.suggestionDet.sugesstionStatusAudit.length;s++){var c=$scope.suggestionDet.sugesstionStatusAudit[s];if(c.status_master.status==$scope.CONST.STATUS.DCAssignedForVerification.status&&-1==d){d=s;break}}for(s=0;s<$scope.suggestionDet.sugesstionStatusAudit.length;s++){c=$scope.suggestionDet.sugesstionStatusAudit[s];if(c.status_master.status==$scope.CONST.STATUS.PendingDocumentUpdate.status&&-1==u){u=s;break}}0<e.length&&($scope.suggestionDet.sugesstionStatusAudit[u]={status_masterDC:e[0].audit.status_master,docList:e,status_master:e[0].audit.status_master}),0<r.length&&($scope.suggestionDet.sugesstionStatusAudit[d]={status_masterDV:$scope.CONST.STATUS.DCAssignedForVerification,docList:r,status_master:$scope.CONST.STATUS.DCAssignedForVerification})}$scope.suggestionDetInput.DCStsAdt={},$scope.suggestionDetInput.DVStsAdt={},null!=$scope.suggestionDet.sugesstionStatusAudit&&0<$scope.suggestionDet.sugesstionStatusAudit.length&&(n=$filter("filter")($scope.suggestionDet.sugesstionStatusAudit,function(e){return e.hasOwnProperty("status_masterDC")&&e.status_masterDC.statusId==$scope.CONST.STATUS.PendingDocumentUpdate.statusId&&null!=e.docList&&0<e.docList.length}),l=$filter("filter")($scope.suggestionDet.sugesstionStatusAudit,function(e){return e.hasOwnProperty("status_masterDV")&&e.status_masterDV.statusId==$scope.CONST.STATUS.DCAssignedForVerification.statusId&&null!=e.docList&&0<e.docList.length}),null!=n&&0<n.length&&($scope.suggestionDetInput.DCStsAdt=n[n.length-1]),null!=l)&&0<l.length&&($scope.suggestionDetInput.DVStsAdt=l[l.length-1]),consoleLog("Document Verification"),consoleLog($scope.suggestionDet.sugesstionStatusAudit)},$scope.checkCategoryVal=function(t){var s=!1;if(t)for(let e=0;e<$scope.catbranchwise.length;e++){var i=$scope.catbranchwise[e].categoryName.toLowerCase();if($scope.catbranchwise[e].catId==t&&"cost"==i){s=!0;break}}return s},$scope.clearSuggDetFields=function(){$scope.suggestionInputDetails.acceptRejComment="",$scope.closeConcernComment="",$scope.acceptRejEvalComment="",$scope.suggestionInputDetails.evalEndDate="",$scope.suggestionInputDetails.implEndDate="",$scope.evaluationInputs="",$scope.estimatedCost="",$scope.validation.summary="",$scope.acceptRejImplComment="",$scope.implData.implSummary="",$scope.implData.implactionSummary="",$scope.implData.implementedCost=0,$scope.implData.costEffective=0,$scope.implData.onHoldImplSummary="",$scope.implData.rejectionReason="",$scope.implData.onholdDate=""},$scope.getMonthIndex=function(e){return["January","February","March","April","May","June","July","August","September","October","November","December"].indexOf(e)},$scope.getWinnersKaizenList=function(e,t){$scope.data={empId:$scope.selectedEmp.empId,branchId:E.empDetails.branch.branchId,fromDt:e,toDt:t},$scope.data.name=1==$scope.winningTab?"winnersBoard":"EOM",b.httpPost($scope.data,"getWinnersKaizenListByEmpId").then(function(e){$scope.WinnersKaizenList=e.sugessionsByEmpIdList,$scope.implement=0;for(var t=$scope.underImplemented=0;t<$scope.WinnersKaizenList.length;t++)$scope.WinnersKaizenList[t].statusId==E.suggStatus.Implemented.statusId&&($scope.implement+=1);for(t=0;t<$scope.WinnersKaizenList.length;t++)$scope.WinnersKaizenList[t].statusId==E.suggStatus.ImplementationRequestAccepted.statusId&&($scope.underImplemented+=1)})},$scope.getWinnersBenefitList=function(){var e=$scope.getMonthIndex($scope.selectedEmp.monthName),t=$scope.selectedEmp.year,s=$scope.getFormatedDate(t,e,"fristDay"),i=$scope.getFormatedDate(t,e,"lastDay"),s=$filter("date")(s,"yyyy-MM-dd"),i=$filter("date")(i,"yyyy-MM-dd");$scope.data={empId:$scope.selectedEmp.empId,branchId:E.empDetails.branch.branchId,fromDt:s,toDt:i},b.httpPost($scope.data,"getBenefitWiseCountByEmpId").then(function(e){$scope.WinnersBenefitList=e.dataList,$scope.getWinnersKaizenList(s,i)})},$scope.getWinnerCount=function(e){1==$scope.winningTab?$scope.title=$filter("translate")("Winner_Analysis"):2==$scope.winningTab&&($scope.title=$filter("translate")("Employee_Of_The_Month_Analysis")),$scope.selectedEmp=e,$("#totalSuggCount").modal({backdrop:"static",keyboard:!1}),$scope.getWinnersBenefitList()},$scope.getWinnersKaizenMonthList=function(){$scope.data={empId:$scope.selectedEmp.empId,branchId:E.empDetails.branch.branchId,fromDt:$scope.winningFromDt,toDt:$scope.winningToDt},b.httpPost($scope.data,"getEmployeeOfMonthKaizen").then(function(e){$scope.WinnersKaizenMonthList=e.dataList,$scope.getWinnersKaizenMonthList()})},$scope.getMonthCount=function(e){$scope.selectedEmp=e,$("#totalMonthCount").modal({backdrop:"static",keyboard:!1}),$scope.getWinnersBenefitList()},$scope.showImageViewer=function(e,t){$scope.selectedDocIndex=t,$scope.viewerImages=e,$("#imageViewer").modal({backdrop:"static",keyboard:!1}),$scope.selectedDocSectionName=$scope.viewerImages.section,$scope.selectedDocType=$scope.viewerImages.name;for(var s=0;s<$scope.viewerImages.length;s++)s==t?($scope.viewerImages[s].selected=!0,$("#imageViewer .img-holder").attr("src",$scope.viewerImages[s])):$scope.viewerImages[s].selected=!1;$("#imageViewer .img-holder").attr("src",$scope.viewerImages[t].url)},$scope.showImageViewerafter=function(e,t){$scope.selectedDocIndex=t,$scope.viewerImages=e,$("#imageViewerafter").modal({backdrop:"static",keyboard:!1}),$scope.selectedDocSectionName=$scope.viewerImages.section,$scope.selectedDocType=$scope.viewerImages.name;for(var s=0;s<$scope.viewerImages.length;s++)s==t?($scope.viewerImages[s].selected=!0,$("#imageViewerafter .img-holder").attr("src",$scope.viewerImages[s])):$scope.viewerImages[s].selected=!1;$("#imageViewerafter .img-holder").attr("src",$scope.viewerImages[t].url)},$scope.zoomIn=function(e){var e=document.getElementById(e),t=(e.clientWidth,e.clientHeight);if(865<=$scope.currWidth||865<=$scope.currHeight)return!1;e.style.width="100%40px",e.style.height=t+40+"px",$scope.lableVal=$scope.lableVal+10},$scope.lableVal=100,$scope.zoomOut=function(e){var e=document.getElementById(e),t=(e.clientWidth,e.clientHeight);if(t<=100)return!1;e.style.width="NaNpx",e.style.height=t-40+"px",$scope.lableVal=$scope.lableVal-10},$scope.onePrint=function(e){$scope.printAllImage([e])},$scope.zoomInafter=function(){var e=document.getElementById("Imageafter"),t=(e.clientWidth,e.clientHeight);if(865<=$scope.currWidth||865<=$scope.currHeight)return!1;e.style.width="100%40px",e.style.height=t+40+"px",$scope.lableVal=$scope.lableVal+10},$scope.zoomOutafter=function(){var e=document.getElementById("Imageafter"),t=(e.clientWidth,e.clientHeight);if(t<=100)return!1;e.style.width="NaNpx",e.style.height=t-40+"px",$scope.lableVal=$scope.lableVal-10},$scope.setSelectedViewerImage=function(e){$scope.selectedDocIndex=e,$scope.selectedDocIndex=document.getElementById("Image").style.cssText=" currHeight : 100% ; currWidth : 100%";for(var t=0;t<$scope.viewerImages.length;t++)t==e?($scope.viewerImages[t].selected=!0,$scope.selectedImgUrl=$scope.viewerImages[t].url,$("#imageViewer .img-holder").attr("src",$scope.viewerImages[t].url),$("#imageViewerafter .img-holder").attr("src",$scope.viewerImages[t].url)):$scope.viewerImages[t].selected=!1},$scope.removeDocFromImageViewer=function(){$scope.viewerImages[i].splice($scope.selectedDocIndex,0),0==$scope.viewerImages[i].length&&($("#imageViewer").modal("hide"),$("#imageViewerafter").modal("hide")),$scope.setSelectedViewerImage(0)},$scope.printAllImage=function(e){var t=window.open("about:blank","_new");t.document.open(),t.document.write((e=>{for(var t="<html><head><script>function step1(){",t=(t+="setTimeout('step2()', 10);}")+"function step2(){window.print();window.close()}"+"<\/script></head><body onload='step1()'>",s=0;s<e.length;s++)t=t+"<img src='"+e[s]+"'height='200' width='400'/><br/>";return t+="</body></html>"})(e)),t.document.close()},$scope.clickPrint=function(e){for(var t=[],s=0;s<e.length;s++)t.push(e[s].url);$scope.printAllImage(t)},$scope.onePrint=function(e){$scope.printAllImage([e])},$scope.showImplFinanceEmpList=function(s){$scope.flagTeamDetPopupLoading=!0,$scope.flagTeamDetNotAvailMsg=!1;var e={orgId:E.empDetails.organization.orgId,branchId:$scope.suggestionDet.branch.branchId,userType:{id:s}};b.httpPost(e,"getSuggestionUserDetails").then(function(t){if($scope.flagTeamDetPopupLoading=!1,t.result)if(null!=t.list&&0<t.list.length){for(let e=0;e<t.list.length;e++)t.list[e].empName=t.list[e].name;if("byImpl"==$scope.suggestionInputDetails.acceptRejBy&&"passToPeer"==$scope.selectedTeamTypeForAssign)for(var e=t.list.length;e--;)t.list[e].empId==E.empDetails.empId&&t.list.splice(e,1);$scope.empListByTeamType=t.list}else $scope.empListByTeamType=[],$scope.flagTeamDetNotAvailMsg=!0,3==s&&$scope.getEmployeeList($scope.suggestionDet.branch.branchId);else $scope.empListByTeamType=[],$scope.flagTeamDetNotAvailMsg=!0,3==s&&$scope.getEmployeeList($scope.suggestionDet.branch.branchId)})},$scope.acceptScrutinizer=function(){$scope.showImplFinanceEmpList(3),$scope.popupTitle="Implementers",$("#teamDetModal").modal({backdrop:"static",keyboard:!1})},$scope.assignToImpl=function(){$scope.flagTeamDetPopupSpinner=!0;var e,t=[];!(1==$scope.suggestionDet.isSelfImplemented||"Tier-1"==$scope.suggestionDet.category.processType&&1==$scope.suggestionBranchConfig.isTierOneSelfImpl||"Tier-2"==$scope.suggestionDet.category.processType&&1==$scope.suggestionBranchConfig.tierTwoSelfImpl)||"passToPeer"==$scope.selectedTeamTypeForAssign?t=$scope.empInputDet.selectedEmpIds:$scope.suggestionDet.emp_details.hasOwnProperty("empType")&&"CW"==$scope.suggestionDet.emp_details.empType?t.push($scope.suggestionDet.createdBy.empId):t.push($scope.suggestionDet.emp_details.empId),$scope.data={sugg_id:$scope.selectedSuggId,stsId:$scope.CONST.STATUS.ImplementationAssigned.statusId,empIds:t,assigned_by:parseInt($scope.loggedInEmpId),tmtypeId:$scope.CONST.TEAM_TYPE.IMPLEMENTATION},1==$scope.suggestionDet.isSelfImplemented||null!=t&&0!=t.length?(e="","passToPeer"==$scope.selectedTeamTypeForAssign?(e="passtopeer",$scope.data={empId:t[0],sugId:parseInt($scope.selectedSuggId),assignedById:parseInt($scope.loggedInEmpId),summary:$scope.suggestionDet.passToPeerSummary},$scope.data.statusId=$scope.CONST.STATUS.PassToPeerImplementer.statusId,$scope.data.teamTypeId=2):e="assignSuggestionToImpl",b.httpPost($scope.data,e).then(function(e){$scope.flagTeamDetPopupSpinner=!1,e.result?($scope.selectedTeamTypeForAssign="",$("#teamDetModal").modal("hide"),$scope.getSuggestionDetails($scope.selectedSuggId),$scope.getsuggestionList("onLoad"),$scope.getStatusWiseCount(),1==$scope.suggestionDet.isSelfImplemented?C.create($filter("translate")("Suggestion_assinged_implementer_implementation"),6e3,"success"):C.create($filter("translate")("Suggestion_implementer_successfully"),6e3,"success")):C.create($filter("translate")("Oops_Please_try_again"),6e3,"error")})):($scope.flagTeamDetPopupSpinner=!1,angular.element("#errId_team").text($filter("translate")("Please_select_team_member")))},$scope.showAcceptRejectSection=function(e,t){var s=E.empDetails.organization.alies;$scope.suggestionInputDetails.acceptRejectStatus=e,$scope.suggestionInputDetails.acceptRejBy=t,$scope.suggestionInputDetails.acceptRejComment="",$scope.evaluationInputs="",$scope.suggestionDet.evaluationInputs="","accept"==e?($scope.isEvalAcceptSection=!1,$scope.flagAccRejTextarea=!1,$scope.textareaLabel="",$scope.flagAccPillerLeavel=!0,$scope.isOther=!1):"reject"==e?($scope.isEvalAcceptSection=!1,$scope.flagAccRejTextarea=!0,$scope.flagrejectEvalarea=!0,$scope.flagrejarea=!0,$scope.flagrejectonhold=!0,$scope.isDropdownRej=!0,$scope.isDropdownRejImpl=!0,$scope.isDropdownRejEval=!0,$scope.isRejectByEval=!0,$scope.flagImpReject=!0,$scope.flagresumeonhold=!1,$scope.flagFurtherhold=!1,$scope.flagAccPillerLeavel=!1,$scope.suggestionInputDetails.acceptRejectStatus=e,$scope.isOther=!1,$scope.isImplementerRej=!1,$scope.isEvaluatorReject=!1,$scope.textareaLabel="Reason"):"reAssignForEdit"==e?($scope.isEvalAcceptSection=!1,$scope.flagAccRejTextarea=!0,$scope.flagAccPillerLeavel=!1,$scope.isOther=!0,$scope.isDropdownRej=!1,$scope.textareaLabel="gmr"==s?"Reason for reassigning idea":"Reason for reassigning suggestion"):"passToPeer"==e?($scope.isEvalAcceptSection=!1,$scope.flagAccRejTextarea=!1,$scope.flagAccPillerLeavel=!1,$scope.textareaLabel="",$scope.isOther=!1,$scope.showTeamDetPopup("ind","passToPeer")):"resume"==e?($scope.flagresumeonhold=!0,$scope.flagFurtherhold=!1,$scope.flagrejectonhold=!1,$scope.textareaLabel="Reason"):"onhold"==e&&($scope.flagresumeonhold=!1,$scope.flagrejectonhold=!1,$scope.flagFurtherhold=!0),$scope.scrollToBottom("#suggDetailsContainer")},$scope.setActiveSuggCard=function(e){$scope.activeCard=e},$scope.isSuggCardActive=function(e){return $scope.activeCard===e},$scope.change_flag_supervisor=function(){""==$scope.suggestionInputDetails.acceptRejComment||null==$scope.suggestionInputDetails.acceptRejComment||null==$scope.suggestionInputDetails.acceptRejComment?($scope.flagRejectSugg=!0,$scope.flagReassign=!1):$scope.flagRejectSugg=!1},$scope.change_flag_reassign=function(){""==$scope.suggestionInputDetails.acceptRejCommentacceptRejComment||null==$scope.suggestionInputDetails.acceptRejComment||null==$scope.suggestionInputDetails.acceptRejComment?($scope.flagReassign=!0,$scope.flagRejectSugg=!1):$scope.flagReassign=!1},$scope.change_flag_eval=function(){""==$scope.acceptRejEvalComment||null==$scope.acceptRejEvalComment||null==$scope.acceptRejEvalComment?$scope.flagRejectSugg=!0:$scope.flagRejectSugg=!1},$scope.change_flag_evalEndDate=function(){consoleLog("inide in eval"),"HD"!=$scope.suggestionDet.sourceType?($scope.suggestionInputDetails.acceptRejectStatus="accept",$scope.suggestionInputDetails.acceptRejBy="byEval",""==$scope.suggestionInputDetails.evalEndDate||null==$scope.suggestionInputDetails.evalEndDate||null==$scope.suggestionInputDetails.evalEndDate?$scope.flagRejectSugg=!0:($scope.flagRejectSugg=!1,null==$scope.roleEscalationList?$scope.getRoleEscalateInfo():$scope.calculateTaskTime())):($scope.flagRejectSugg=!1,$scope.suggestionInputDetails.acceptRejectStatus="accept",$scope.suggestionInputDetails.acceptRejBy="byEval",null==$scope.roleEscalationList?$scope.getRoleEscalateInfo():$scope.calculateTaskTime())},$scope.calculateTaskTime=function(){var e=0,t="";if("byEval"==$scope.suggestionInputDetails.acceptRejBy)if("HD"!=$scope.suggestionDet.sourceType){for(var t=$scope.suggestionInputDetails.evalEndDate,s=0;s<$scope.roleEscalationList.length;s++)if($scope.roleEscalationList[s].role.id==$scope.CONST.ROLES.EVALUATOR){e=$scope.roleEscalationList[s].numberOfDays;break}}else{t=$scope.newSug.evalEndDate;for(s=0;s<$scope.roleEscalationList.length;s++)if($scope.roleEscalationList[s].role.id==$scope.CONST.ROLES.EVALUATOR){e=$scope.roleEscalationList[s].numberOfDays;break}}else if("byImpl"==$scope.suggestionInputDetails.acceptRejBy){t=$scope.suggestionInputDetails.implEndDate;for(s=0;s<$scope.roleEscalationList.length;s++)if($scope.roleEscalationList[s].role.id==$scope.CONST.ROLES.IMPLEMENTER){e=$scope.roleEscalationList[s].numberOfDays;break}}else if("byFCEval"==$scope.suggestionInputDetails.acceptRejBy){t=$scope.suggestionDet.fCEvalEndDate;for(s=0;s<$scope.roleEscalationList.length;s++)if($scope.roleEscalationList[s].role.id==$scope.CONST.ROLES.FINANCE_APPROVAL){e=$scope.roleEscalationList[s].numberOfDays;break}}else if("byFCImpl"==$scope.suggestionInputDetails.acceptRejBy){t=$scope.suggestionDet.fCImplEndDate;for(s=0;s<$scope.roleEscalationList.length;s++)if($scope.roleEscalationList[s].role.id==$scope.CONST.ROLES.FINANCE_CONTROLLER){e=$scope.roleEscalationList[s].numberOfDays;break}}else if("byDC"==$scope.suggestionInputDetails.acceptRejBy){t=$scope.suggestionDet.dcEndDate;for(s=0;s<$scope.roleEscalationList.length;s++)if($scope.roleEscalationList[s].role.id==$scope.CONST.ROLES.DOCUMENT_OWNER){e=$scope.roleEscalationList[s].numberOfDays;break}}0<e&&($scope.currentDate=(new Date).getTime(),$scope.taskTime=new Date(t).getTime(),e<Math.ceil(($scope.taskTime-$scope.currentDate)/864e5)?("byEval"==$scope.suggestionInputDetails.acceptRejBy?($scope.suggestionDet.evalTaskDeviation=!0,$scope.suggestionDet.extraTimeDeviationDays=e):"byImpl"==$scope.suggestionInputDetails.acceptRejBy?($scope.suggestionDet.implTaskDeviation=!0,$scope.suggestionDet.extraImpleTimeDeviationDays=e):"byFCEval"==$scope.suggestionInputDetails.acceptRejBy?($scope.suggestionDet.fcEvalTaskDeviation=!0,$scope.suggestionDet.extraFCEvalTimeDeviationDays=e):"byFCImpl"==$scope.suggestionInputDetails.acceptRejBy?($scope.suggestionDet.fcImplTaskDeviation=!0,$scope.suggestionDet.extrafcImplTimeDeviationDays=e):"byDC"==$scope.suggestionInputDetails.acceptRejBy&&($scope.suggestionDet.dcTaskDeviation=!0,$scope.suggestionDet.extraDCTimeDeviationDays=e),$scope.scrollToBottom("#suggDetailsContainer")):"byEval"==$scope.suggestionInputDetails.acceptRejBy?$scope.suggestionDet.evalTaskDeviation=!1:"byImpl"==$scope.suggestionInputDetails.acceptRejBy?$scope.suggestionDet.implTaskDeviation=!1:"byFCEval"==$scope.suggestionInputDetails.acceptRejBy?$scope.suggestionDet.fcEvalTaskDeviation=!1:"byFCImpl"==$scope.suggestionInputDetails.acceptRejBy?$scope.suggestionDet.fcImplTaskDeviation=!1:"byDC"==$scope.suggestionInputDetails.acceptRejBy&&($scope.suggestionDet.dcTaskDeviation=!1))},$scope.getRoleEscalateInfo=function(){null!=$scope.roleEscalationList&&0<$scope.roleEscalationList.size||b.httpGet("getroleescalationsetup/"+$scope.suggestionDet.branch.branchId).then(function(e){$scope.flagConfigDetLoading=!1,$scope.flagConfigDetLineIndicator=!1,e.result&&($scope.roleEscalationList=e.roleEscalationSetupList,$scope.calculateTaskTime())})},$scope.change_flag_implEndDate=function(){$scope.suggestionInputDetails.acceptRejectStatus="accept",$scope.suggestionInputDetails.acceptRejBy="byImpl",""==$scope.suggestionInputDetails.implEndDate||null==$scope.suggestionInputDetails.implEndDate||null==$scope.suggestionInputDetails.implEndDate?$scope.flagRejectSugg=!0:(null==$scope.roleEscalationList||null==$scope.roleEscalationList?$scope.getRoleEscalateInfo():$scope.calculateTaskTime(),$scope.flagRejectSugg=!1)},$scope.acceptRejectByFC=function(e,t){$scope.suggestionInputDetails.acceptRejectStatus=e,$scope.suggestionInputDetails.acceptRejBy=t,$scope.acceptRejectSugg()},$scope.getSuggestionListOnUpdate=function(){var e={sugId:$scope.selectedSuggId,branchId:$scope.suggestionDet.branch.branchId,orgId:$scope.suggestionDet.organization.orgId,assignedToId:$scope.loggedInEmpId,typeId:1};$scope.isFilterApplied&&""!=$scope.suggestionPagination.fromDt&&""!=$scope.suggestionPagination.toDt&&(e.fromDt=$scope.suggestionPagination.fromDt+" 00:00:00",e.toDt=$scope.suggestionPagination.toDt+$filter("date")(new Date," HH:mm:ss")),b.httpPost(e,"getsuggestionlistnew").then(function(t){if(t.result&&null!=t.sugessionsByEmpIdList&&0<t.sugessionsByEmpIdList.length&&null!=$scope.suggestionList&&0<$scope.suggestionList.length){var s,e=$scope.suggestionList.length-1;for(let e=0;e<$scope.suggestionList.length;e++)if($scope.suggestionList[e].sugId==$scope.selectedSuggId){$scope.suggestionList[e]=t.sugessionsByEmpIdList[0],s=e;break}$scope.getSuggestionDetailsFlag="onUpdate",e!=s&&$scope.getSuggestionDetails($scope.selectedSuggId,"onSuggSelect",$scope.selectedsourceType)}})},$scope.getSuggestionDetailsFlag="",$scope.acceptRejectSugg=function(){if($scope.suggestionInputDetails.flagHrAccRejSpinner=!0,""==$scope.suggestionInputDetails.acceptRejectStatus||""==$scope.suggestionInputDetails.acceptRejBy)$scope.suggestionInputDetails.flagHrAccRejSpinner=!1;else{$scope.data={sugg_id:$scope.selectedSuggId,updatedBy:parseInt($scope.loggedInEmpId)};var s,e="";if("accept"==$scope.suggestionInputDetails.acceptRejectStatus){if("byHr"==$scope.suggestionInputDetails.acceptRejBy)$scope.flagHrAccRejSpinner=!0,$scope.data.stsId=$scope.CONST.STATUS.HRAccepts.statusId,$scope.data.summary=$scope.suggestionInputDetails.acceptRejComment,e="acceptrejectSuggestionByHR";else if("bySupervisor"==$scope.suggestionInputDetails.acceptRejBy){if($scope.flagHrAccRejSpinner=!0,$scope.loggedInUserLevel<2)$scope.data.stsId=$scope.CONST.STATUS.HRAccepts.statusId;else{$scope.data.stsId=$scope.CONST.STATUS.AcceptedByScrutinizerLevelUp.statusId;for(var t=0;t<$scope.suggestionDet.sugesstionStatusAudit.length;t++)if($scope.suggestionDet.sugesstionStatusAudit[t].status_master.status==$scope.CONST.STATUS.SuggestionAssigned.status&&0==$scope.suggestionDet.sugesstionStatusAudit[t].emp_details.departmentLevel[0].level){$scope.data.deptFirstLvlId=$scope.suggestionDet.sugesstionStatusAudit[t].emp_details.empId;break}}$scope.data.summary=$scope.suggestionInputDetails.acceptRejComment,$scope.data.deptId=$scope.loggedInUserDeptId,$scope.data.levelId=$scope.loggedInUserLevel,$scope.data.orgId=$scope.loggedInUserOrgId,e="acceptrejectSuggestionByHR"}else if("byEval"==$scope.suggestionInputDetails.acceptRejBy){if(""==$scope.suggestionInputDetails.evalEndDate||null==$scope.suggestionInputDetails.evalEndDate||null==$scope.suggestionInputDetails.evalEndDate)return $scope.flagRejectSugg=!0,$scope.suggestionInputDetails.flagHrAccRejSpinner=!1,void angular.element("#errId_evalEndDate").text($filter("translate")("Please_select_estimated_evaluation_time"));if($scope.suggestionDet.evalTaskDeviation&&(null==$scope.suggestionDet.evalTaskDeviationInput||null==$scope.suggestionDet.evalTaskDeviationInput))return C.create($filter("translate")("Please_capture_reason_timeline_deviation"),5e3,"error"),void($scope.suggestionInputDetails.flagHrAccRejSpinner=!1);null!=$scope.cfmApprove||""!=$scope.cfmApprove?$scope.data.isCFMApprove=$scope.cfmApprove:$scope.data.isCFMApprove="N",$scope.flagEvalAccRejSpinner=!0,$scope.data.stsId=$scope.CONST.STATUS.EvaluationRequestAccepted.statusId,$scope.data.updatedBy=parseInt($scope.loggedInEmpId),$scope.data.updatedByName=$scope.loggedInName,$scope.data.summary=$scope.suggestionDet.evalTaskDeviationInput,$scope.data.endDate=$scope.suggestionInputDetails.evalEndDate,$scope.data.tmtypeId=$scope.loggedInUserTeamTypeId;for(t=0;t<$scope.suggestionDet.evaluationTeamList.length;t++)parseInt($scope.suggestionDet.evaluationTeamList[t].empId)==parseInt($scope.loggedInEmpId)&&($scope.data.sugTrackId=$scope.suggestionDet.evaluationTeamList[t].sugTrackId);e="acceptrejectSuggessionByEvalteam"}else if("byevalfc"==$scope.suggestionInputDetails.acceptRejBy){for(var i=0,t=0;t<=$scope.suggestionDet.sugesstionStatusAudit.length;t++){if($scope.suggestionDet.sugesstionStatusAudit[t].status_master.status==$scope.CONST.STATUS.PassToPeerEvaluator.status){i=$scope.suggestionDet.sugesstionStatusAudit[t].emp_details.empId;break}if($scope.suggestionDet.sugesstionStatusAudit[t].status_master.status==$scope.CONST.STATUS.EvaluationAssigned.status||$scope.suggestionDet.sugesstionStatusAudit[t].status_master.status==$scope.CONST.STATUS.EvaluationRequestAccepted.status){i=$scope.suggestionDet.sugesstionStatusAudit[t].emp_details.empId;break}}$scope.data={assignedById:parseInt($scope.loggedInEmpId),assignedToId:i,statusId:$scope.CONST.STATUS.ApprovedByFC.statusId,sugId:$scope.selectedSuggId,summary:$scope.suggestionDet.evalFCSummary,branchId:$scope.suggestionDet.branch.branchId,orgId:$scope.loggedInUserOrgId,amount:$scope.suggestionDet.eval.estimatedCost},e="acceptRejectSuggestionFinanceController"}else if("byImpl"==$scope.suggestionInputDetails.acceptRejBy){if(""==$scope.suggestionInputDetails.implEndDate||null==$scope.suggestionInputDetails.implEndDate||null==$scope.suggestionInputDetails.implEndDate)return $scope.flagRejectSugg=!0,$scope.suggestionInputDetails.flagHrAccRejSpinner=!1,void angular.element("#errId_implEndDate").text($filter("translate")("Please_select_estimated_evaluation_time"));if($scope.suggestionDet.implTaskDeviation&&(null==$scope.suggestionDet.implTaskDeviationInput||null==$scope.suggestionDet.implTaskDeviationInput))return $scope.suggestionInputDetails.flagHrAccRejSpinner=!1,void C.create($filter("translate")("Please_capture_reason_timeline_deviation"),5e3,"error");$scope.flagImplAccRejSpinner=!0,$scope.data.stsId=$scope.CONST.STATUS.ImplementationRequestAccepted.statusId,$scope.data.updatedBy=parseInt($scope.loggedInEmpId),$scope.data.updatedByName=$scope.loggedInName,$scope.data.summary=$scope.suggestionDet.implTaskDeviationInput,$scope.data.endDate=$scope.suggestionInputDetails.implEndDate,$scope.data.tmtypeId=$scope.loggedInUserTeamTypeId;for(t=0;t<$scope.suggestionDet.implTeamList.length;t++)parseInt($scope.suggestionDet.implTeamList[t].empId)==parseInt($scope.loggedInEmpId)&&($scope.data.sugTrackId=$scope.suggestionDet.implTeamList[t].sugTrackId);e="acceptrejectSuggessionByEvalteam"}}else if("reject"==$scope.suggestionInputDetails.acceptRejectStatus){if("byHr"==$scope.suggestionInputDetails.acceptRejBy){if(""==$scope.suggestionInputDetails.acceptRejComment||null==$scope.suggestionInputDetails.acceptRejComment||null==$scope.suggestionInputDetails.acceptRejComment)return $scope.flagRejectSugg=!0,$scope.flagReassign=!1,$scope.suggestionInputDetails.flagHrAccRejSpinner=!1,void angular.element("#errId").text($filter("translate")("Please_enter_reason_for_rejecting_suggestion"));$scope.flagHrAccRejSpinner=!0,$scope.data.stsId=$scope.CONST.STATUS.HRRejects.statusId,$scope.data.rejectionReason=$scope.suggestionInputDetails.acceptRejComment,$scope.data.updatedByName=$scope.loggedInName,e="acceptrejectSuggestionByHR"}else if("bySupervisor"==$scope.suggestionInputDetails.acceptRejBy){if(1==$scope.isOther){if(""==$scope.suggestionInputDetails.acceptRejComment||null==$scope.suggestionInputDetails.acceptRejComment||null==$scope.suggestionInputDetails.acceptRejComment)return $scope.flagRejectSugg=!0,$scope.suggestionInputDetails.flagHrAccRejSpinner=!1,void C.create("Please enter rejection reason",3e3,"error");$scope.data.summary=$scope.suggestionInputDetails.acceptRejComment,$scope.selectRejArray.push($scope.data.summary)}else if(0==$scope.isOther){if(0==$scope.count)return $scope.suggestionInputDetails.flagHrAccRejSpinner=!1,void C.create("Please select rejection reason from list",3e3,"error");$scope.data.suggReasonIds=$scope.selectRejArray}$scope.flagHrAccRejSpinner=!0,$scope.data.stsId=$scope.CONST.STATUS.SuggestionDeclined.statusId,null!=$scope.suggestionDet.dept&&($scope.data.deptId=$scope.suggestionDet.dept.deptId),null!=E.empDetails.departmentLevel&&0<E.empDetails.departmentLevel.length&&(s=!1,angular.forEach(E.empDetails.departmentLevel,function(e,t){$scope.isEmpty(e.dept)||null==e.deptId||null==$scope.suggestionDet.dept||e.dept.deptId==$scope.suggestionDet.dept.deptId&&($scope.data.levelId=e.level,s=!0)}),s)||($scope.data.levelId=0),$scope.data.orgId=$scope.loggedInUserOrgId,e="acceptrejectSuggestionByHR"}else if("byEval"==$scope.suggestionInputDetails.acceptRejBy){if(""==$scope.acceptRejEvalComment||null==$scope.acceptRejEvalComment||null==$scope.acceptRejEvalComment)return $scope.flagRejectSugg=!0,$scope.suggestionInputDetails.flagHrAccRejSpinner=!1,void angular.element("#errId_eval").text($filter("translate")("Please_enter_reason_for_rejecting_suggestion"));$scope.flagEvalAccRejSpinner=!0,$scope.data.stsId=$scope.CONST.STATUS.EvaluationRequestDecline.statusId,$scope.data.updatedBy=parseInt($scope.loggedInEmpId),$scope.data.updatedByName=$scope.loggedInName,$scope.data.summary=$scope.acceptRejEvalComment,$scope.data.isDecline=1;for(t=$scope.data.deptFirstLvlId=0;t<$scope.suggestionDet.sugesstionStatusAudit.length;t++)if($scope.suggestionDet.sugesstionStatusAudit[t].status_master.status==$scope.CONST.STATUS.HRAccepts.status&&null!=$scope.suggestionDet.sugesstionStatusAudit[t].emp_details.departmentLevel&&0<$scope.suggestionDet.sugesstionStatusAudit[t].emp_details.departmentLevel.length&&0==$scope.suggestionDet.sugesstionStatusAudit[t].emp_details.departmentLevel[0].level){$scope.data.deptFirstLvlId=$scope.suggestionDet.sugesstionStatusAudit[t].emp_details.empId;break}for(t=0;t<$scope.suggestionDet.evaluationTeamList.length;t++)parseInt($scope.suggestionDet.evaluationTeamList[t].empId)==parseInt($scope.loggedInEmpId)&&($scope.data.sugTrackId=$scope.suggestionDet.evaluationTeamList[t].sugTrackId);e="acceptrejectSuggessionByEvalteam"}else if("byevalfc"==$scope.suggestionInputDetails.acceptRejBy){if(null==$scope.suggestionDet.evalFCSummary||null==$scope.suggestionDet.evalFCSummary||""==$scope.suggestionDet.evalFCSummary)return $scope.suggestionInputDetails.flagHrAccRejSpinner=!1,void C.create($filter("translate")("Please_enter_comments"),5e3,"error");for(i=0,t=0;t<=$scope.suggestionDet.sugesstionStatusAudit.length;t++){if($scope.suggestionDet.sugesstionStatusAudit[t].status_master.status==$scope.CONST.STATUS.PassToPeerEvaluator.status){i=$scope.suggestionDet.sugesstionStatusAudit[t].emp_details.empId;break}if($scope.suggestionDet.sugesstionStatusAudit[t].status_master.status==$scope.CONST.STATUS.EvaluationAssigned.status||$scope.suggestionDet.sugesstionStatusAudit[t].status_master.status==$scope.CONST.STATUS.EvaluationRequestAccepted.status){i=$scope.suggestionDet.sugesstionStatusAudit[t].emp_details.empId;break}}$scope.data={assignedById:parseInt($scope.loggedInEmpId),assignedToId:i,statusId:$scope.CONST.STATUS.DeclinedByFC.statusId,sugId:$scope.selectedSuggId,summary:$scope.suggestionDet.evalFCSummary,branchId:$scope.suggestionDet.branch.branchId,orgId:$scope.loggedInUserOrgId},e="acceptRejectSuggestionFinanceController"}else if("byImpl"==$scope.suggestionInputDetails.acceptRejBy){if(""==$scope.acceptRejImplComment||null==$scope.acceptRejImplComment||null==$scope.acceptRejImplComment)return $scope.flagRejectSugg=!0,$scope.suggestionInputDetails.flagHrAccRejSpinner=!1,void angular.element("#errId_impl").text($filter("translate")("Please_enter_reason_for_declining_suggestion"));$scope.flagImplAccRejSpinner=!0,$scope.data.stsId=$scope.CONST.STATUS.ImplementationRequestDecline.statusId,$scope.data.updatedBy=parseInt($scope.loggedInEmpId),$scope.data.updatedByName=$scope.loggedInName,$scope.data.summary=$scope.acceptRejImplComment,$scope.data.tmtypeId=$scope.loggedInUserTeamTypeId,$scope.data.isDecline=1;for(t=0;t<$scope.suggestionDet.implTeamList.length;t++)parseInt($scope.suggestionDet.implTeamList[t].empId)==parseInt($scope.loggedInEmpId)&&($scope.data.sugTrackId=$scope.suggestionDet.implTeamList[t].sugTrackId);for(t=0;t<$scope.suggestionDet.sugesstionStatusAudit.length;t++)if($scope.suggestionDet.sugesstionStatusAudit[t].status_master.status==$scope.CONST.STATUS.ImplementationRecommended.status){$scope.data.evalTeamId=$scope.suggestionDet.sugesstionStatusAudit[t].emp_details.empId;break}e="acceptrejectSuggessionByEvalteam"}}else if("reAssignForEdit"==$scope.suggestionInputDetails.acceptRejectStatus){if(""==$scope.suggestionInputDetails.acceptRejComment||null==$scope.suggestionInputDetails.acceptRejComment||null==$scope.suggestionInputDetails.acceptRejComment)return $scope.flagReassign=!0,$scope.flagRejectSugg=!1,$scope.suggestionInputDetails.flagHrAccRejSpinner=!1,void C.create($filter("translate")("Please_enter_reason_for_reassigning_suggestion"),3e3,"error");$scope.flagHrAccRejSpinner=!0,$scope.data.stsId=$scope.CONST.STATUS.AssignedForEdit.statusId,$scope.data.summary=$scope.suggestionInputDetails.acceptRejComment,$scope.data.orgId=$scope.loggedInUserOrgId;var a=$scope.suggestionDet.sugesstionStatusAudit.length-1;0<=a&&($scope.suggestionDet.sugesstionStatusAudit[a].status_master.status==$scope.CONST.STATUS.EvaluationAssigned.status||$scope.suggestionDet.sugesstionStatusAudit[a].status_master.status==$scope.CONST.STATUS.PassToPeerEvaluator.status)?($scope.data.stsId=$scope.CONST.STATUS.ReassignedByEvaluator.statusId,$scope.data.empId=$scope.suggestionDet.createdBy.empId,$scope.data.createdBy=$scope.suggestionDet.sugesstionStatusAudit[a].emp_details.empId,$scope.data.updatedBy=$scope.suggestionDet.sugesstionStatusAudit[a].emp_details.empId):$scope.data.stsId=$scope.CONST.STATUS.AssignedForEdit.statusId;for(t=0;t<$scope.suggestionDet.sugesstionStatusAudit.length;t++)if("Y"==$scope.suggestionDet.isSuggOnBehalf)$scope.data.empId=$scope.suggestionDet.createdBy.empId;else if($scope.suggestionDet.sugesstionStatusAudit[t].status_master.status==$scope.CONST.STATUS.Created.status){$scope.data.empId=$scope.suggestionDet.sugesstionStatusAudit[t].emp_details.empId;break}e="acceptrejectSuggestionByHR"}b.httpPost($scope.data,e).then(function(e){$scope.flagHrAccRejSpinner=!1,$scope.flagEvalAccRejSpinner=!1,$scope.flagImplAccRejSpinner=!1,$scope.flagRejectSugg=!1,$scope.flagReassign=!1,$scope.suggestionInputDetails.flagHrAccRejSpinner=!1,"success"==e.status?("accept"==$scope.suggestionInputDetails.acceptRejectStatus?(C.create($filter("translate")("Suggestion_accepted_successfully"),5e3,"success"),$scope.flagAcceptSugg=!0,"bySupervisor"==$scope.suggestionInputDetails.acceptRejBy||"byEval"==$scope.suggestionInputDetails.acceptRejBy||"byImpl"==$scope.suggestionInputDetails.acceptRejBy?($scope.getSuggestionListOnUpdate(),$scope.isDropdownRejEval=!1):"byevalfc"==$scope.suggestionInputDetails.acceptRejBy&&($scope.getStatusWiseCount(),$scope.getSuggestionDetailsFlag="",$scope.getsuggestionList("onUpdate"))):"reAssignForEdit"==$scope.suggestionInputDetails.acceptRejectStatus?($scope.getStatusWiseCount(),$scope.suggestionDet={},$scope.getsuggestionList("onLoad"),C.create($filter("translate")("Suggestion_initiator_successfully"),5e3,"success")):"reject"==$scope.suggestionInputDetails.acceptRejectStatus&&($scope.getStatusWiseCount(),$scope.suggestionDet={},$scope.getSuggestionDetailsFlag="",$scope.getsuggestionList("onUpdate"),"byevalfc"==$scope.suggestionInputDetails.acceptRejBy?C.create($filter("translate")("Suggestion_reassigned_to_evaluator_successfully"),5e3,"success"):"bySupervisor"==$scope.suggestionInputDetails.acceptRejBy?C.create($filter("translate")("Suggestion_is_rejected_by_controller_successfully"),5e3,"success"):C.create("Suggestion rejected successfully",5e3,"success")),$scope.flagAccRejTextarea=!1):($scope.suggestionInputDetails.flagHrAccRejSpinner=!1,$scope.suggestionInputDetails.acceptRejectStatus,C.create($filter("translate")("Oops_Please_try_again"),5e3,"error"))})}},$scope.setEvalTargetDate=function(){$scope.suggestionInputDetails.evalEndDate=$filter("date")(new Date,"yyyy-MM-dd"),$(".target-date-picker").datepicker({update:$scope.suggestionInputDetails.evalEndDate,autoclose:!0,todayHighlight:!0})},$scope.setEvalTargetDateHD=function(){$scope.newSug.evalEndDate=$filter("date")(new Date,"yyyy-MM-dd"),$(".target-date-picker").datepicker({update:$scope.newSug.evalEndDate,autoclose:!0,todayHighlight:!0})},$scope.setImplTargetDate=function(){$scope.suggestionInputDetails.implEndDate=$filter("date")(new Date,"yyyy-MM-dd"),$(".target-date-picker").datepicker({update:$scope.suggestionInputDetails.implEndDate,autoclose:!0,todayHighlight:!0})},$scope.$watch("suggestionInputDetails.evalEndDate",function(e,t){$scope.isEmpty($scope.suggestionInputDetails)||$scope.suggestionInputDetails.hasOwnProperty("evalEndDate")&&null!=$scope.suggestionInputDetails.evalEndDate&&null!=$scope.suggestionInputDetails.evalEndDate&&""!=$scope.suggestionInputDetails.evalEndDate&&($scope.suggestionInputDetails.evalEndDate=moment(e).format("YYYY-MM-DD"),$scope.change_flag_evalEndDate())}),$scope.$watch("suggestionDet.fCEvalEndDate",function(e,t){$scope.isEmpty($scope.suggestionDet)||$scope.suggestionDet.hasOwnProperty("fCEvalEndDate")&&null!=$scope.suggestionDet.fCEvalEndDate&&null!=$scope.suggestionDet.fCEvalEndDate&&""!=$scope.suggestionDet.fCEvalEndDate&&($scope.suggestionDet.fCEvalEndDate=moment(e).format("YYYY-MM-DD"),$scope.change_flag_fcEvalEndDate())}),$scope.$watch("suggestionInputDetails.implEndDate",function(e,t){$scope.isEmpty($scope.suggestionInputDetails)||$scope.suggestionInputDetails.hasOwnProperty("implEndDate")&&null!=$scope.suggestionInputDetails.implEndDate&&null!=$scope.suggestionInputDetails.implEndDate&&""!=$scope.suggestionInputDetails.implEndDate&&($scope.suggestionInputDetails.implEndDate=moment(e).format("YYYY-MM-DD"),$scope.change_flag_implEndDate())}),$scope.$watch("implData.onholdDate",function(e,t){$scope.isEmpty($scope.implData)||$scope.implData.hasOwnProperty("onholdDate")&&null!=$scope.implData.onholdDate&&null!=$scope.implData.onholdDate&&""!=$scope.implData.onholdDate&&($scope.implData.onholdDate=moment(e).format("YYYY-MM-DD"))}),$scope.change_flag_recommend=function(){""==$scope.validation.summary||null==$scope.validation.summary||null==$scope.validation.summary?$scope.flagRejectSugg=!0:$scope.flagRejectSugg=!1},$scope.validation={summary:""},$scope.change_flagEval=function(e){$scope.evaluationInputs=e.target.value,""==$scope.evaluationInputs||null==$scope.evaluationInputs||null==$scope.evaluationInputs?($scope.flagReassigneval=!0,$scope.flagRejectevalSugg=!1):$scope.flagReassigneval=!1},$scope.recommendSuggestion=function(e,t){if($scope.data={statusId:e,sugId:$scope.selectedSuggId,summary:t.evaluationInputs,assignedById:parseInt($scope.loggedInEmpId),rejectionReason:t.estimatedCost,orgId:E.empDetails.organization.orgId,branchId:E.empDetails.branch.branchId},$scope.flagrejectEvalarea||$scope.flagrejarea){if(1==$scope.isEvaluatorReject){if(""==$scope.suggestionDet.evaluationInputs||null==$scope.suggestionDet.evaluationInputs||null==$scope.suggestionDet.evaluationInputs)return $scope.flagReassigneval=!0,void angular.element("#errId_reassign").text("Please enter rejection reason.");$scope.data.summary=$scope.suggestionDet.evaluationInputs,delete $scope.data.suggReasonIds}else if(0==$scope.isEvaluatorReject){if(0==$scope.count)return void C.create("Please select rejection reason from list",3e3,"error");$scope.data.suggReasonIds=$scope.selectRejArray,delete $scope.data.summary}delete $scope.data.rejectionReason}else{if(""==t.evaluationInputs||null==t.evaluationInputs||null==t.evaluationInputs)return C.create($filter("translate")("Evaluation_details_are_mandatory"),6e3,"error"),void($scope.flagRejectSugg=!0);if("HD"==$scope.suggestionDet.sourceType){if($scope.isEmpty($scope.suggestionDet.hdCatId)||null==$scope.suggestionDet.hdCatId||null==$scope.suggestionDet.hdCatId||""==$scope.suggestionDet.hdCatId)return void C.create($filter("translate")("Please_select_category"),6e3,"error");$scope.data.catId=parseInt($scope.suggestionDet.hdCatId.catId)}}$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!0,b.httpPost($scope.data,"recommended").then(function(e){$scope.flagrejectEvalarea=!1,$scope.flagrejarea=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,"success"==e.status?($scope.suggestionDet={},$scope.getSuggestionDetails($scope.selectedSuggId),C.create($filter("translate")("Suggestion_rejected_successfully"),5e3,"success"),$scope.getsuggestionList("onUpdate"),$scope.getStatusWiseCount()):"Futuristic committee setup not found "==e.reason?(C.create($filter("translate")("Futuristic Committee setup not found for this department. Please add futuristic committee (Go to Setup & config -> Suggestions -> Configure -> Escalation)"),5e3,"error"),$scope.flagrejectEvalarea=!0,$scope.flagrejarea=!0):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")})},$scope.rejectSuggestion=function(e){if($scope.data={statusId:e,sugId:$scope.selectedSuggId,assignedById:parseInt($scope.loggedInEmpId),rejectionReason:0,orgId:E.empDetails.organization.orgId,branchId:E.empDetails.branch.branchId},1==$scope.isFinanceReject){if(""==$scope.suggestionInputDetails.acceptRejComment||null==$scope.suggestionInputDetails.acceptRejComment||null==$scope.suggestionInputDetails.acceptRejComment)return $scope.flagRejectSugg=!0,$scope.suggestionInputDetails.flagHrAccRejSpinner=!1,void C.create("Please enter rejection reason",3e3,"error");$scope.data.summary=$scope.suggestionInputDetails.acceptRejComment,$scope.selectRejArray.push($scope.data.summary)}else if(0==$scope.isFinanceReject){if(0==$scope.count)return void C.create("Please select rejection reason from list",3e3,"error");$scope.data.suggReasonIds=$scope.selectRejArray}$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!0,b.httpPost($scope.data,"recommended").then(function(e){$scope.flagrejectEvalarea=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,"success"==e.status?($scope.suggestionDet={},$scope.getSuggestionDetails($scope.selectedSuggId),C.create($filter("translate")("Suggestion_rejected_successfully"),5e3,"success"),$scope.getsuggestionList("onUpdate"),$scope.getStatusWiseCount()):"Futuristic committee setup not found "==e.reason?(C.create($filter("translate")("Futuristic Committee setup not found for this department. Please add futuristic committee (Go to Setup & config -> Suggestions -> Configure -> Escalation)"),5e3,"error"),$scope.flagrejectEvalarea=!0,$scope.flagrejarea=!0):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")})},$scope.showAcceptSugg=function(){$scope.flagAcceptSugg=!0,$scope.flagRejectSugg=!1},$scope.showRejectSugg=function(){$scope.flagRejectSugg=!0,$scope.flagAcceptSugg=!1},$scope.selectedParticular=function(e){if(angular.element(e).prop("checked",!1).attr("checked",!1),angular.element(e).prop("checked",!0).attr("checked",!0),$.each($("input[name='particularEvalChk']:checked"),function(){$scope.particularDet=parseInt($(this).val())}),null!=$scope.particulars&&0<$scope.particulars.length)for(var t=0;t<$scope.particulars.length;t++)$scope.particulars[t].isChecked=!1,$scope.particulars[t].id==$scope.particularDet&&($scope.particulars[t].isChecked=!0,$scope.particulars[t].newUnit="",$scope.particulars[t].evalExistingValue="",$scope.particulars[t].newValue="",$scope.particulars[t].impactValue="",$scope.particulars[t].newImpactValue="",$scope.particulars[t].newInitImpactValue="")},$scope.selectedImplParticular=function(e){if(angular.element(e).prop("checked",!1).attr("checked",!1),angular.element(e).prop("checked",!0).attr("checked",!0),$.each($("input[name='particularChk']:checked"),function(){$scope.particularImplDet=parseInt($(this).val())}),null!=$scope.particulars&&0<$scope.particulars.length)for(var t=0;t<$scope.particulars.length;t++)$scope.particulars[t].id==$scope.particularImplDet?($scope.particulars[t].isChecked=!0,$scope.particulars[t].newUnit="",$scope.particulars[t].implExistingValue="",$scope.particulars[t].newValue="",$scope.particulars[t].newImpactValue="",$scope.particulars[t].newInitImpactValue="",$scope.particulars[t].impactValue=""):$scope.particulars[t].isChecked=!1},$scope.showTeamDetPopup=function(e,n,t){$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!0,$scope.evaluationDet=t,$scope.flagTeamDetPopupLoading=!0,$scope.flagTeamDetNotAvailMsg=!1,$scope.selectedTeamTypeForAssign=n,1==$scope.suggestionDet.isHDRequire?$scope.isHorizDeployReq="NA":$scope.isHorizDeployReq="Y";t="";if(n==$scope.CONST.TEAM_TYPE.EVALUATION)$scope.popupTitle="Evaluators",t="getlistofusersbranchwise/"+$scope.suggestionDet.branch.branchId+"/0/0/8",$("#teamDetModalforEval").modal({backdrop:"static",keyboard:!1});else{if(n==$scope.CONST.TEAM_TYPE.IMPLEMENTATION){if(null==$scope.evaluationDet.evaluationInputs||""==$scope.evaluationDet.evaluationInputs)return C.create($filter("translate")("Evaluation_details_are_mandatory"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if("HD"==$scope.suggestionDet.sourceType&&($scope.isEmpty($scope.suggestionDet.hdCatId)||null==$scope.suggestionDet.hdCatId||null==$scope.suggestionDet.hdCatId||""==$scope.suggestionDet.hdCatId))return C.create($filter("translate")("Please_select_category"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if($scope.isEmpty($scope.suggestionDet.hdCatId)||null==$scope.suggestionDet.hdCatId||null==$scope.suggestionDet.hdCatId||""==$scope.suggestionDet.hdCatId||($scope.data.catId=parseInt($scope.suggestionDet.hdCatId.catId)),"Y"==$scope.suggFlowConfig.isEvalSapCodeEnbld&&1==E.empDetails.productOrgConfigDet.isSapCodeMandatory)for(let e=0;e<$scope.catbranchwise.length;e++)if($scope.catbranchwise[e].catId==$scope.suggestionDet.hdCatId.catId&&"Y"==$scope.catbranchwise[e].isSapCodeRequired&&(""==$scope.suggestionDet.sapCode||null==$scope.suggestionDet.sapCode||null==$scope.suggestionDet.sapCode))return C.create($filter("translate")("Plese_enter_SAPCode"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if("Y"==$scope.suggFlowConfig.isParticularsEnbld){if("Y"==$scope.suggFlowConfig.kaizenCheckReqEval&&1==E.empDetails.productOrgConfigDet.isSusAuditRequired&&"Y"==$scope.suggestionDet.hdCatId.isSusAuditRequired&&(null==$scope.suggestionDet.evalSustenanceflow||null==$scope.suggestionDet.evalSustenanceflow||!$scope.suggestionDet.evalSustenanceflow))return C.create($filter("translate")("Sustenance_audit_is_mandatory"),5e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if("Y"==$scope.suggFlowConfig.kaizenCheckReqEval&&null!=$scope.suggestionDet.evalSustenanceflow&&null!=$scope.suggestionDet.evalSustenanceflow&&$scope.suggestionDet.evalSustenanceflow){if(null==$scope.suggestionDet.sustenanceAuditorList||0==$scope.suggestionDet.sustenanceAuditorList.length)return C.create($filter("translate")("Auditor_setup_not_found_for_this_category_Please_add_Auditor"),6e3,"error"),$scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if(null==$scope.suggestionDet.sustenanceAuditorId||null==$scope.suggestionDet.sustenanceAuditorId||""==$scope.suggestionDet.sustenanceAuditorId)return C.create($filter("translate")("Please_select_sustenance_auditor"),6e3,"error"),$scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);$scope.data.kaizenSusReqByEval=$scope.suggestionDet.evalSustenanceflow,$scope.data.sustenanceAuditorId=$scope.suggestionDet.sustenanceAuditorId}}if(1==E.empDetails.productOrgConfigDet.isDocChangeOn&&"Y"==$scope.suggFlowConfig.isChgDocEnbld&&!$scope.suggestionDet.tmpIsDocumentChangeRequire&&0==$filter("filter")($scope.documentLists,{isChecked:!0}).length)return C.create($filter("translate")("Its_mandatory_to_assign_documents_for_update"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if("Y"==$scope.suggFlowConfig.isHorizDplymntsEnbld&&!$scope.suggestionDet.isHDRequire&&$scope.suggestionDet.hdSelected)return C.create($filter("translate")("Evaluation_horizontal_deployment_mandatory"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if("Y"==$scope.suggFlowConfig.isHorizDplymntsEnbld&&"Y"==$scope.suggFlowConfig.isEvalEnbld&&"Y"==$scope.isHorizDeployReq&&"DEPT"==$scope.hdConfigData.hdLevel){for(var s=void 0,i=0;i<$scope.departmentList.length;i++)if($scope.departmentList[i].isEvalselect&&$scope.departmentList[i].lineFound)for(var s=[],a=0;a<$scope.departmentList[i].lineList.length;a++)s.push($scope.departmentList[i].lineList);if(0<$filter("filter")($scope.departmentList,{isEvalselect:!0,lineFound:!0}).length&&null!=s&&0==$filter("filter")(s,{isEvalselect:!0}).length)return C.create($filter("translate")("Please_select_line_horizontal_deployment"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1)}if("Y"==$scope.suggFlowConfig.isParticularsEnbld&&1==E.empDetails.productOrgConfigDet.isPraticularsMandatory&&0==$filter("filter")($scope.particulars,{isChecked:!0}).length)return C.create($filter("translate")("Particulars_Other_Benefits_is_mandatory"),5e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);for(var l=[],i=0;i<$scope.documentLists.length;i++)$scope.documentLists[i].isChecked&&(u={suggestion:{sugId:$scope.selectedSuggId},branch:{branchId:$scope.suggestionDet.branch.branchId},document:{id:parseInt($scope.documentLists[i].id)}},l.push(u));$scope.data.document=l;for(var o=[],i=0;i<$scope.activityList.length;i++)$scope.activityList[i].isselect&&(D={id:0,suggestion:{sugId:$scope.selectedSuggId},activity:$scope.activityList[i]},o.push(D));if($scope.data.suggActivity=o,"Y"==$scope.suggFlowConfig.isParticularsEnbld){var r=[];if(null!=$scope.particulars&&0<$scope.particulars.length)for(i=0;i<$scope.particulars.length;i++){if(1<$filter("filter")($scope.particulars,{isChecked:!0}).length)return $scope.flagTeamDetPopupSpinner=!1,C.create($filter("translate")("Please_select_only_one_benefit"),5e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if($scope.particulars[i].isChecked&&$scope.particulars[i].tangible){if(!$scope.particulars[i].hasOwnProperty("newUnit")&&!$scope.particulars[i].hasOwnProperty("newValue"))return $scope.flagTeamDetPopupSpinner=!1,C.create($filter("translate")("Please_enter_value_and_unit_for_tangible_benefit"),5e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if($scope.particulars[i].hasOwnProperty("newUnit")&&$scope.particulars[i].hasOwnProperty("newValue")&&(null==$scope.particulars[i].newUnit||""==$scope.particulars[i].newUnit||$scope.isEmpty($scope.particulars[i].newUnit)||null==$scope.particulars[i].newValue||""==$scope.particulars[i].newValue))return $scope.flagTeamDetPopupSpinner=!1,C.create($filter("translate")("Please_enter_value_and_unit_for_tangible_benefit"),5e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1)}var g=$scope.particulars[i],u={};if(0==$scope.particulars[i].selectedId&&$scope.particulars[i].isChecked){if(u={id:0,particular:{id:g.id},suggestion:{sugId:$scope.selectedSuggId},createdById:$scope.loggedInEmpId,isActive:"Y",tangible:g.tangible,recommendedBy:$scope.loggedInEmpId,action:"ADD",roleId:8,catId:parseInt($scope.suggestionDet.selectedEvalCatId)},g.tangible&&(u.unit=g.newUnit.unit,u.masterUnit={id:g.newUnit.id},u.value=g.value,u.frequency=g.evalFrequency?g.evalFrequency.value:g.frequency,g.evalExistingValue)&&0<g.evalExistingValue&&(u.existingValue=g.evalExistingValue),null!=$scope.suggestionDet.emp_details&&null!=$scope.suggestionDet.emp_details&&(u.sugCreatedByEmpId=$scope.suggestionDet.emp_details.empId),null!=$scope.suggestionDet.customEvaluationParticularsList&&0<$scope.suggestionDet.customEvaluationParticularsList.length)for(var d=0;d<$scope.suggestionDet.customEvaluationParticularsList.length;d++){var c={id:$scope.suggestionDet.customEvaluationParticularsList[d].id,action:"DELETE"};r.push(c)}r.push(u)}else 0<$scope.particulars[i].selectedId&&$scope.particulars[i].isChecked&&(g.tangible?$scope.particulars[i].hasOwnProperty("newUnit")&&$scope.particulars[i].hasOwnProperty("newValue")&&($scope.particulars[i].unit=$scope.particulars[i].newUnit,$scope.particulars[i].value=$scope.particulars[i].newValue,$scope.particulars[i].frequency=$scope.particulars[i].evalFrequency?$scope.particulars[i].evalFrequency.value:$scope.particulars[i].frequency,$scope.particulars[i].existingValue=$scope.particulars[i].evalExistingValue,$scope.checkBenefitsValue($scope.particulars[i]))&&(u={id:g.selectedId,particular:{id:g.id},suggestion:{sugId:$scope.selectedSuggId},createdById:$scope.loggedInEmpId,isActive:"Y",tangible:g.tangible,recommendedBy:$scope.loggedInEmpId,action:"UPDATE",roleId:8},g.tangible&&(u.unit=g.unit.unit,u.masterUnit={id:g.unit.id},u.value=g.value,u.unit=g.unit.unit,u.frequency=g.frequency,g.existingValue)&&0<g.existingValue&&(u.existingValue=g.existingValue),null!=$scope.suggestionDet.emp_details&&null!=$scope.suggestionDet.emp_details&&(u.sugCreatedByEmpId=$scope.suggestionDet.emp_details.empId),r.push(u)):(u={id:g.selectedId,particular:{id:g.id},suggestion:{sugId:$scope.selectedSuggId},createdById:$scope.loggedInEmpId,isActive:"Y",tangible:g.tangible,recommendedBy:$scope.loggedInEmpId,action:"UPDATE",roleId:8},null!=$scope.suggestionDet.emp_details&&null!=$scope.suggestionDet.emp_details&&(u.sugCreatedByEmpId=$scope.suggestionDet.emp_details.empId),r.push(u)))}$scope.data.suggParticulars=r,consoleLog($scope.data.suggParticulars)}var p=[];if(null!=$scope.SavingTypeLists&&0<$scope.SavingTypeLists.length)for(i=0;i<$scope.SavingTypeLists.length;i++){u={id:0,setPointsForSaving:{id:parseInt($scope.SavingTypeLists[i].amt.id)},suggestion:{sugId:$scope.selectedSuggId},sugCreatedByEmpId:$scope.suggestionDet.emp_details.empId,points:$scope.SavingTypeLists[i].points,createdById:$scope.loggedInEmpId};p.push(u)}null!=p&&0<p.length&&($scope.data.evalPoints=p);var m=E.empDetails.productOrgConfigDet;return"Y"!=$scope.suggFlowConfig.isKaizenActEnbld||"Y"!=$scope.suggFlowConfig.isEvalEnbld||1!=m.isActivityOn||null!=$scope.data.suggActivity&&0!=$scope.data.suggActivity.length?($scope.popupTitle="Implementers",null==$scope.evaluationDet.evaluationInputs||""==$scope.evaluationDet.evaluationInputs?(C.create($filter("translate")("Evaluation_details_are_mandatory"),6e3,"error"),$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,void($scope.flagEvalText=!0)):$scope.suggestionDet.status_master.status!=$scope.CONST.STATUS.EvaluationRequestAccepted.status&&$scope.suggestionDet.status_master.status!=$scope.CONST.STATUS.ReassignedToEvaluationTeam.status||1!=$scope.productOrgConfigList.isPriorityMadatory||null!=$scope.suggestionDet.suggPriority||"Y"!=$scope.suggFlowConfig.isImplPriority?($("#implTeamDetModal").modal({backdrop:"static",keyboard:!1}),void $scope.showImplFinanceEmpList(3)):(C.create($filter("translate")("Implementation_Priority_is_mandatory"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1))):(C.create($filter("translate")("Kaizen_activities_are_mandatory"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1))}if(n==$scope.CONST.TEAM_TYPE.APPROVEDBYFC)return $scope.popupTitle="Implementers",$("#implTeamDetModal").modal({backdrop:"static",keyboard:!1}),void $scope.showImplFinanceEmpList(3);if("executiveMgmtController"==n)$scope.popupTitle="Management Controllers",t="getAllEmpListForExecutor/"+$scope.loggedInUserBranchId,$("#teamDetModal").modal({backdrop:"static",keyboard:!1});else if("passToPeer"==n){if("bySupervisor"==$scope.suggestionInputDetails.acceptRejBy&&($scope.popupTitle="Controllers",null!=$scope.suggestionDet.circle?$scope.getCircleControllerList():t="getlistofusersbranchwise/"+$scope.suggestionDet.branch.branchId+"/0/0/6",$("#teamDetModalforController").modal({backdrop:"static",keyboard:!1})),"byEval"==$scope.suggestionInputDetails.acceptRejBy&&($scope.popupTitle="Evaluators",t="getlistofusersbranchwise/"+$scope.suggestionDet.branch.branchId+"/0/0/8",$("#teamDetModalforEval").modal({backdrop:"static",keyboard:!1})),"byImpl"==$scope.suggestionInputDetails.acceptRejBy)return $scope.popupTitle="Implementers",$("#implTeamDetModal").modal({backdrop:"static",keyboard:!1}),void $scope.showImplFinanceEmpList(3)}else{if(n==$scope.CONST.TEAM_TYPE.EVALFC){if(null==$scope.evaluationDet.evaluationInputs||""==$scope.evaluationDet.evaluationInputs)return C.create($filter("translate")("Evaluation_details_are_mandatory"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if(null==$scope.evaluationDet.estimatedCost||""==$scope.evaluationDet.estimatedCost||0==$scope.evaluationDet.estimatedCost)return C.create($filter("translate")("Budgetary_Cost_is_mandatory"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if("HD"==$scope.suggestionDet.sourceType&&($scope.isEmpty($scope.suggestionDet.hdCatId)||null==$scope.suggestionDet.hdCatId||null==$scope.suggestionDet.hdCatId||""==$scope.suggestionDet.hdCatId))return C.create($filter("translate")("Please_select_category"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if($scope.isEmpty($scope.suggestionDet.hdCatId)||null==$scope.suggestionDet.hdCatId||null==$scope.suggestionDet.hdCatId||""==$scope.suggestionDet.hdCatId||($scope.data.catId=parseInt($scope.suggestionDet.hdCatId.catId)),"Y"==$scope.suggFlowConfig.isEvalSapCodeEnbld&&1==E.empDetails.productOrgConfigDet.isSapCodeMandatory)for(let e=0;e<$scope.catbranchwise.length;e++)if($scope.catbranchwise[e].catId==$scope.suggestionDet.hdCatId.catId&&"Y"==$scope.catbranchwise[e].isSapCodeRequired&&(""==$scope.suggestionDet.sapCode||null==$scope.suggestionDet.sapCode||null==$scope.suggestionDet.sapCode))return C.create($filter("translate")("Plese_enter_SAPCode"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if("Y"==$scope.suggFlowConfig.isHorizDplymntsEnbld&&!$scope.suggestionDet.isHDRequire&&$scope.suggestionDet.hdSelected)return C.create($filter("translate")("Evaluation_horizontal_deployment_mandatory"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if(1==E.empDetails.productOrgConfigDet.isDocChangeOn&&"Y"==$scope.suggFlowConfig.isChgDocEnbld&&!$scope.suggestionDet.tmpIsDocumentChangeRequire&&0==$filter("filter")($scope.documentLists,{isChecked:!0}).length)return C.create($filter("translate")("Its_mandatory_to_assign_documents_for_update"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if(null==$scope.evaluationDet.estimatedCost||""==$scope.evaluationDet.estimatedCost||0==$scope.evaluationDet.estimatedCost)return C.create($filter("translate")("Budgetary_Cost_is_mandatory"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if("Y"==$scope.suggFlowConfig.isParticularsEnbld&&1==E.empDetails.productOrgConfigDet.isPraticularsMandatory&&0==$filter("filter")($scope.particulars,{isChecked:!0}).length)return C.create($filter("translate")("Particulars_Other_Benefits_is_mandatory"),5e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);for(l=[],i=0;i<$scope.documentLists.length;i++)$scope.documentLists[i].isChecked&&(u={suggestion:{sugId:$scope.selectedSuggId},branch:{branchId:$scope.suggestionDet.branch.branchId},document:{id:parseInt($scope.documentLists[i].id)}},l.push(u));$scope.data.document=l;for(var D,o=[],i=0;i<$scope.activityList.length;i++)$scope.activityList[i].isselect&&(D={id:0,suggestion:{sugId:$scope.selectedSuggId},activity:$scope.activityList[i]},o.push(D));if($scope.data.suggActivity=o,"Y"==$scope.suggFlowConfig.isParticularsEnbld){r=[];if(null!=$scope.particulars&&0<$scope.particulars.length)for(i=0;i<$scope.particulars.length;i++){if(1<$filter("filter")($scope.particulars,{isChecked:!0}).length)return $scope.flagTeamDetPopupSpinner=!1,C.create($filter("translate")("Please_select_only_one_benefit"),5e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if($scope.particulars[i].isChecked&&$scope.particulars[i].tangible){if(!$scope.particulars[i].hasOwnProperty("newUnit")&&!$scope.particulars[i].hasOwnProperty("newValue"))return $scope.flagTeamDetPopupSpinner=!1,C.create($filter("translate")("Please_enter_value_and_unit_for_tangible_benefit"),5e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if($scope.particulars[i].hasOwnProperty("newUnit")&&$scope.particulars[i].hasOwnProperty("newValue")&&(null==$scope.particulars[i].newUnit||""==$scope.particulars[i].newUnit||$scope.isEmpty($scope.particulars[i].newUnit)||null==$scope.particulars[i].newValue||""==$scope.particulars[i].newValue))return $scope.flagTeamDetPopupSpinner=!1,C.create($filter("translate")("Please_enter_value_and_unit_for_tangible_benefit"),5e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1)}g=$scope.particulars[i],u={};if(0==$scope.particulars[i].selectedId&&$scope.particulars[i].isChecked){if(u={id:0,particular:{id:g.id},suggestion:{sugId:$scope.selectedSuggId},createdById:$scope.loggedInEmpId,isActive:"Y",tangible:g.tangible,recommendedBy:$scope.loggedInEmpId,action:"ADD",roleId:8,catId:parseInt($scope.suggestionDet.selectedEvalCatId)},g.tangible&&(u.unit=g.newUnit.unit,u.masterUnit={id:g.newUnit.id},u.value=g.value,u.frequency=g.evalFrequency?g.evalFrequency.value:g.frequency,g.evalExistingValue)&&0<g.evalExistingValue&&(u.existingValue=g.evalExistingValue),null!=$scope.suggestionDet.emp_details&&null!=$scope.suggestionDet.emp_details&&(u.sugCreatedByEmpId=$scope.suggestionDet.emp_details.empId),null!=$scope.suggestionDet.customEvaluationParticularsList&&0<$scope.suggestionDet.customEvaluationParticularsList.length)for(d=0;d<$scope.suggestionDet.customEvaluationParticularsList.length;d++){c={id:$scope.suggestionDet.customEvaluationParticularsList[d].id,action:"DELETE"};r.push(c)}r.push(u)}else 0<$scope.particulars[i].selectedId&&$scope.particulars[i].isChecked&&(g.tangible?$scope.particulars[i].hasOwnProperty("newUnit")&&$scope.particulars[i].hasOwnProperty("newValue")&&($scope.particulars[i].unit=$scope.particulars[i].newUnit,$scope.particulars[i].value=$scope.particulars[i].newValue,$scope.particulars[i].frequency=$scope.particulars[i].evalFrequency?$scope.particulars[i].evalFrequency.value:$scope.particulars[i].frequency,$scope.particulars[i].existingValue=$scope.particulars[i].evalExistingValue,$scope.checkBenefitsValue($scope.particulars[i]))&&(u={id:g.selectedId,particular:{id:g.id},suggestion:{sugId:$scope.selectedSuggId},createdById:$scope.loggedInEmpId,isActive:"Y",tangible:g.tangible,recommendedBy:$scope.loggedInEmpId,action:"UPDATE",roleId:8},g.tangible&&(u.unit=g.unit.unit,u.masterUnit={id:g.unit.id},u.value=g.value,u.unit=g.unit.unit,u.frequency=g.frequency,g.existingValue)&&0<g.existingValue&&(u.existingValue=g.existingValue),null!=$scope.suggestionDet.emp_details&&null!=$scope.suggestionDet.emp_details&&(u.sugCreatedByEmpId=$scope.suggestionDet.emp_details.empId),r.push(u)):(u={id:g.selectedId,particular:{id:g.id},suggestion:{sugId:$scope.selectedSuggId},createdById:$scope.loggedInEmpId,isActive:"Y",tangible:g.tangible,recommendedBy:$scope.loggedInEmpId,action:"UPDATE",roleId:8},null!=$scope.suggestionDet.emp_details&&null!=$scope.suggestionDet.emp_details&&(u.sugCreatedByEmpId=$scope.suggestionDet.emp_details.empId),r.push(u)))}$scope.data.suggParticulars=r,consoleLog($scope.data.suggParticulars)}$scope.data.suggParticulars=r;p=[];if(null!=$scope.SavingTypeLists&&0<$scope.SavingTypeLists.length)for(i=0;i<$scope.SavingTypeLists.length;i++){u={id:0,setPointsForSaving:{id:parseInt($scope.SavingTypeLists[i].amt.id)},suggestion:{sugId:$scope.selectedSuggId},sugCreatedByEmpId:$scope.suggestionDet.emp_details.empId,points:$scope.SavingTypeLists[i].points,createdById:$scope.loggedInEmpId};p.push(u)}null!=p&&0<p.length&&($scope.data.evalPoints=p);m=E.empDetails.productOrgConfigDet;return"Y"!=$scope.suggFlowConfig.isKaizenActEnbld||"Y"!=$scope.suggFlowConfig.isEvalEnbld||1!=m.isActivityOn||null!=$scope.data.suggActivity&&0!=$scope.data.suggActivity.length?$scope.suggestionDet.status_master.status==$scope.CONST.STATUS.EvaluationRequestAccepted.status&&1==$scope.productOrgConfigList.isPriorityMadatory&&null==$scope.suggestionDet.suggPriority&&"Y"==$scope.suggFlowConfig.isImplPriority?(C.create($filter("translate")("Implementation_Priority_is_mandatory"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1)):($scope.popupTitle="Finance Approval",$("#implTeamDetModal").modal({backdrop:"static",keyboard:!1}),void $scope.showImplFinanceEmpList(2)):(C.create($filter("translate")("Kaizen_activities_are_mandatory"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1))}if("onHoldToImpl"==n)return $scope.popupTitle="Implementers",$scope.flagcancelresumesugg=!1,""==$scope.implData.onHoldImplSummary||null==$scope.implData.onHoldImplSummary||null==$scope.implData.onHoldImplSummary?void($scope.flagcancelresumesugg=!0):($("#onHoldImplModal").modal({backdrop:"static",keyboard:!1}),void $scope.showImplFinanceEmpList(3))}}b.httpGet(t).then(function(e){if($scope.flagTeamDetPopupLoading=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,$scope.flagSelectTeamMem=!1,e.result){if($scope.empListByTeamType=[],"passToPeer"!=n)if(n==$scope.CONST.TEAM_TYPE.IMPLEMENTATION||n==$scope.CONST.TEAM_TYPE.EVALFC||n==$scope.CONST.TEAM_TYPE.APPROVEDBYFC){$scope.empListByTeamType=e.allEmpDetails;for(var t=0;t<$scope.empListByTeamType.length;t++)$scope.empListByTeamType[t].empName=$scope.empListByTeamType[t].firstName+" "+$scope.empListByTeamType[t].lastName,null!=$scope.empListByTeamType[t].dept&&null!=$scope.empListByTeamType[t].dept&&($scope.empListByTeamType[t].deptName=$scope.empListByTeamType[t].dept.deptName);null!=$scope.empListByTeamType&&0!=$scope.empListByTeamType.length||($scope.flagTeamDetNotAvailMsg=!0)}else n==$scope.CONST.TEAM_TYPE.EVALUATION?($scope.pillerWiseEvaluatorList=e.deptlvlusersList,$scope.empListByTeamType=e.deptlvlusersList):($scope.empListByTeamType=e.deptlvlusersList,null!=$scope.empListByTeamType&&0!=$scope.empListByTeamType.length||($scope.flagTeamDetNotAvailMsg=!0));else if("byImpl"==$scope.suggestionInputDetails.acceptRejBy){$scope.empListByTeamType=[];for(t=0;t<e.allEmpDetails.length;t++){var s,i=e.allEmpDetails[t];i.empId!=$scope.loggedInEmpId&&(s={empName:i.firstName+" "+i.lastName,deptName:i.dept.deptName},s=Object.assign({},s,i),$scope.empListByTeamType.push(s))}null!=$scope.empListByTeamType&&0!=$scope.empListByTeamType.length||($scope.flagTeamDetNotAvailMsg=!0)}else if($scope.empListByTeamType=[],0<e.deptlvlusersList.length)if("bySupervisor"==$scope.suggestionInputDetails.acceptRejBy)for(t=0;t<e.deptlvlusersList.length;t++)0==(a=e.deptlvlusersList[t]).level&&a.empId!=$scope.loggedInEmpId&&$scope.empListByTeamType.push(a);else{$scope.empListByTeamType=[],$scope.pillerWiseEvaluatorList=[];for(var a,t=0;t<e.deptlvlusersList.length;t++)0==(a=e.deptlvlusersList[t]).level&&a.empId!=$scope.loggedInEmpId&&($scope.empListByTeamType.push(a),$scope.pillerWiseEvaluatorList.push(a))}}else $scope.flagTeamDetNotAvailMsg=!0;$scope.flagHdpiller=!1})},$scope.selectTeamMemberOnRowClick=function(e){angular.element(".rdoEmpSelect").attr("checked",!1),angular.element(e).attr("checked",!0)},$scope.empInputDet={},$scope.empInputDet.selectedEmpIds=[],$scope.isSelectedRow=function(e){var t=!1;return t=null!=$scope.empInputDet.selectedEmpIds&&-1<$scope.empInputDet.selectedEmpIds.indexOf(e.empId)?!0:t},$scope.checkRow=function(e,t,s){"Single"===e?(s.forEach(function(e){e.isSelected=!1}),t.isSelected=!0,$scope.empInputDet.selectedEmpIds=[t.empId],$scope.empInputDet.selectedEmpId=t.empId,$scope.empInputDet.selectedRowId=t.id):"Multiple"===e&&(-1<$scope.empInputDet.selectedEmpIds.indexOf(t.empId)?(t.isSelected=!1,$scope.empInputDet.selectedEmpIds=$scope.empInputDet.selectedEmpIds.filter(e=>e!==t.empId)):(t.isSelected=!0,$scope.empInputDet.selectedEmpIds.push(t.empId)))},$scope.change_flag=function(){$scope.flagSelectTeamMem=!1},$scope.getFCList=function(){var e={orgId:E.empDetails.organization.orgId,branchId:$scope.suggestionDet.branch.branchId,userType:{id:1}};b.httpPost(e,"getSuggestionUserDetails").then(function(e){e.result&&(null!=e.list&&0<e.list.length?($scope.FCList=e.list,""!=$scope.suggestionDet.FCData&&null!=$scope.suggestionDet.FCData&&$scope.isFcAvailable($scope.suggestionDet.FCData)):$scope.FCList=[])})},$scope.checkToDisplayPending=function(e){return e.emp_details.empId==$scope.loggedInEmpId&&"PENDING"==e.actionStatus&&e.status_master.statusId==$scope.suggestionDet.status_master.statusId&&$scope.statusCountFilter==$scope.CONST.COUNT_FILTERS.PENDING},$scope.checkToDisplayOther=function(e){return"PENDING"!=e.actionStatus&&$scope.statusCountFilter!=$scope.CONST.COUNT_FILTERS.PENDING},$scope.callAssignSuggestion=function(e){C.create($filter("translate")("Suggestion_is_assinged_to_FC"),6e3,"success"),$scope.selectedTeamTypeForAssign=e,$scope.assignSuggestion()},$scope.assignImpl=function(){$scope.selectedTeamTypeForAssign=$scope.CONST.TEAM_TYPE.IMPLEMENTATION,$scope.assignSuggestion()},$scope.getCategoryValuefromPrt=function(t){var s={};if(null!=$scope.particulars&&0<$scope.particulars.length)for(let e=0;e<$scope.particulars.length;e++)$scope.particulars[e].id==t&&(s=$scope.particulars[e].category);return s},$scope.checkBenefitsValue=function(e){var t,s=!1;return null!=$scope.suggestionDet.benefitPointsAudit&&0<$scope.suggestionDet.benefitPointsAudit.length&&null!=(t=$filter("filter")($scope.suggestionDet.benefitPointsAudit,{particularPoints:{id:e.selectedId}},!0))&&0<t.length&&(t[0].new_value==e.value&&t[0].oldUnit==e.unit.id||(s=!0)),s},$scope.getSustenaceAuditor=function(){var e,s=("HD"==$scope.suggestionDet.sourceType?$scope.suggestionDet.hdCatId:$scope.suggestionDet.category).categoryName;null!=$scope.suggestionDet.sustenanceAuditorList&&0<$filter("filter")($scope.suggestionDet.sustenanceAuditorList,{branchId:$scope.suggestionDet.branch.branchId},!0).length?null!=$scope.suggestionDet.kaizenSusReqByEval&&1==$scope.suggestionDet.kaizenSusReqByEval?null!=$scope.suggestionDet.sustenanceAuditorId&&null!=$scope.suggestionDet.sustenanceAuditorId&&($scope.suggestionDet.sustenanceAuditorId=$scope.suggestionDet.sustenanceAuditorId.toString()):1!=$scope.suggestionDet.sustenanceAuditorList.length&&null!=(e=$filter("filter")($scope.suggestionDet.sustenanceAuditorList,{categoryName:s},!0))&&0<e.length?$scope.suggestionDet.sustenanceAuditorId=e[0].empId.toString():$scope.suggestionDet.sustenanceAuditorId=$scope.suggestionDet.sustenanceAuditorList[0].empId.toString():(e={branchId:$scope.suggestionDet.branch.branchId,type:"SUGGESTION"},b.httpPost(e,"getAuditorDetailsNew").then(function(t){if(t.result)if($scope.suggestionDet.sustenanceAuditorList=[],null!=t.auditorList&&0<t.auditorList.length){for(let e=0;e<t.auditorList.length;e++)t.auditorList[e].categoryName==s&&$scope.suggestionDet.sustenanceAuditorList.push(t.auditorList[e]);var e;null!=$scope.suggestionDet.kaizenSusReqByEval&&1==$scope.suggestionDet.kaizenSusReqByEval?null!=$scope.suggestionDet.sustenanceAuditorId&&null!=$scope.suggestionDet.sustenanceAuditorId&&($scope.suggestionDet.sustenanceAuditorId=$scope.suggestionDet.sustenanceAuditorId.toString()):1!=t.auditorList.length&&null!=(e=$filter("filter")(t.auditorList,{categoryName:s},!0))&&0<e.length?$scope.suggestionDet.sustenanceAuditorId=e[0].empId.toString():$scope.suggestionDet.sustenanceAuditorId=t.auditorList[0].empId.toString()}else $scope.suggestionDet.sustenanceAuditorList=[];else $scope.suggestionDet.sustenanceAuditorList=[]}))},$scope.assignSuggestion=function(){1==$scope.suggestionDet.isHDRequire?$scope.isHorizDeployReq="NA":$scope.isHorizDeployReq="Y",$scope.flagTeamDetPopupSpinner=!0;var e="";if("passToPeer"!=$scope.selectedTeamTypeForAssign){var t=[],s=0,e="assignSuggestioneval";if("HD"!=$scope.suggestionDet.sourceType&&$scope.selectedTeamTypeForAssign==$scope.CONST.TEAM_TYPE.IMPLEMENTATION&&(1==$scope.suggestionDet.isSelfImplemented||"Tier-1"==$scope.suggestionDet.category.processType&&1==$scope.suggestionBranchConfig.isTierOneSelfImpl||"Tier-2"==$scope.suggestionDet.category.processType&&1==$scope.suggestionBranchConfig.tierTwoSelfImpl)?$scope.suggestionDet.emp_details.hasOwnProperty("empType")&&"CW"==$scope.suggestionDet.emp_details.empType?t.push($scope.suggestionDet.createdBy.empId):t.push($scope.suggestionDet.emp_details.empId):(t=$scope.empInputDet.selectedEmpIds,s=$scope.empInputDet.selectedEmpIds[0]),$scope.data={sugg_id:parseInt($scope.selectedSuggId),empIds:t,assigned_by:parseInt($scope.loggedInEmpId),tmtypeId:$scope.selectedTeamTypeForAssign,isHorizDeployReq:$scope.suggestionDet.isHorizDeployReq},$scope.suggestionDet.pcrNumber&&"Y"==$scope.suggFlowConfig.isPCRNoEnbld&&($scope.data.pcrNo=$scope.suggestionDet.pcrNumber),delete $scope.data.isHorizDeployReq,$scope.suggestionDet.status_master.status!=$scope.CONST.STATUS.EvaluationRequestAccepted.status&&$scope.suggestionDet.status_master.status!=$scope.CONST.STATUS.ReassignedToEvaluationTeam.status||(1==$scope.productOrgConfigList.isPriorityMadatory&&null!=$scope.suggestionDet.suggPriority&&""!=$scope.suggestionDet.suggPriority?"Y"==$scope.suggFlowConfig.isImplPriority&&$scope.suggestionDet.suggPriority.id?$scope.data.suggPriority=$scope.suggestionDet.suggPriority.id:"Y"==$scope.suggFlowConfig.isImplPriority&&($scope.data.suggPriority=$scope.suggestionDet.suggPriority):"Y"==$scope.suggFlowConfig.isImplPriority&&null!=$scope.suggestionDet.suggPriority&&""!=$scope.suggestionDet.suggPriority&&($scope.suggestionDet.suggPriority.id?$scope.data.suggPriority=$scope.suggestionDet.suggPriority.id:$scope.data.suggPriority=$scope.suggestionDet.suggPriority)),0==t.length&&"reassignToFC"!=$scope.selectedTeamTypeForAssign)return $scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,void angular.element("#errId_team").text($filter("translate")("Please_select_team_member"));if($scope.selectedTeamTypeForAssign==$scope.CONST.TEAM_TYPE.EVALUATION)$scope.data.stsId=$scope.CONST.STATUS.EvaluationAssigned.statusId,(null!=$scope.suggestionDet.evalSummary&&null!=$scope.suggestionDet.evalSummary||""!=$scope.suggestionDet.summary)&&($scope.data.summary=$scope.suggestionDet.evalSummary),null!=$scope.cfmValue&&""!=$scope.cfmValue&&"Y"==$scope.cfmValue?$scope.data.isCFMRequired=$scope.cfmValue:$scope.data.isCFMRequired="N";else if($scope.selectedTeamTypeForAssign==$scope.CONST.TEAM_TYPE.IMPLEMENTATION)if($scope.data.stsId=$scope.CONST.STATUS.ImplementationAssigned.statusId,1==$scope.suggestionDet.isSelfImplemented&&$scope.selectedAudit.status_master.statusId==$scope.CONST.STATUS.ApprovedByFC.statusId){for(var i=0,a=0;a<$scope.suggestionDet.evaluationTeamList.length;a++)$scope.suggestionDet.evaluationTeamList[a].empId==$scope.loggedInEmpId&&(i=$scope.suggestionDet.evaluationTeamList[a].sugTrackId);$scope.data.sugTrackId=i,null!=$scope.evaluationDet&&($scope.data.estimatedCost=$scope.evaluationDet.estimatedCost)}else{for(var n=[],a=0;a<$scope.documentLists.length;a++)$scope.documentLists[a].isChecked&&(g={suggestion:{sugId:$scope.selectedSuggId},branch:{branchId:$scope.suggestionDet.branch.branchId},document:{id:parseInt($scope.documentLists[a].id)},isDeactive:0},n.push(g));for(a=0;a<$scope.documentLists.length;a++)if(!$scope.documentLists[a].isChecked&&null!=$scope.suggestionDet.document&&0<$scope.suggestionDet.document.length)for(let e=0;e<$scope.suggestionDet.document.length;e++)$scope.suggestionDet.document[e].document.id==$scope.documentLists[a].id&&(g={suggestion:{sugId:$scope.selectedSuggId},branch:{branchId:$scope.suggestionDet.branch.branchId},document:{id:parseInt($scope.documentLists[a].id)},isDeactive:1,id:$scope.suggestionDet.document[e].id},n.push(g));$scope.data.document=n;for(var l=[],a=0;a<$scope.activityList.length;a++)$scope.activityList[a].isselect&&(S={id:0,suggestion:{sugId:$scope.selectedSuggId},activity:$scope.activityList[a]},l.push(S));$scope.data.suggActivity=l;var o=[];if(null!=$scope.particulars&&0<$scope.particulars.length)for(a=0;a<$scope.particulars.length;a++){if(1<$filter("filter")($scope.particulars,{isChecked:!0}).length)return $scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,void C.create($filter("translate")("Please_select_only_one_benefit"),5e3,"error");if($scope.particulars[a].isChecked&&$scope.particulars[a].tangible){if(!$scope.particulars[a].hasOwnProperty("newUnit")&&!$scope.particulars[a].hasOwnProperty("newValue"))return $scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,void C.create($filter("translate")("Please_enter_value_and_unit_for_tangible_benefit"),5e3,"error");if($scope.particulars[a].hasOwnProperty("newUnit")&&$scope.particulars[a].hasOwnProperty("newValue")&&(null==$scope.particulars[a].newUnit||""==$scope.particulars[a].newUnit||$scope.isEmpty($scope.particulars[a].newUnit)||null==$scope.particulars[a].newValue||""==$scope.particulars[a].newValue))return $scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,void C.create($filter("translate")("Please_enter_value_and_unit_for_tangible_benefit"),5e3,"error")}var r=$scope.particulars[a],g={};if(0==$scope.particulars[a].selectedId&&$scope.particulars[a].isChecked){if(g={id:0,particular:{id:r.id},suggestion:{sugId:$scope.selectedSuggId},createdById:$scope.loggedInEmpId,isActive:"Y",tangible:r.tangible,recommendedBy:$scope.loggedInEmpId,action:"ADD",roleId:8,catId:parseInt($scope.suggestionDet.selectedEvalCatId)},r.tangible&&(g.unit=r.newUnit.unit,g.masterUnit={id:r.newUnit.id},g.value=r.newValue,g.frequency=r.evalFrequency?r.evalFrequency.value:r.frequency,r.evalExistingValue)&&0<r.evalExistingValue&&(g.existingValue=r.evalExistingValue),null!=$scope.suggestionDet.emp_details&&null!=$scope.suggestionDet.emp_details&&(g.sugCreatedByEmpId=$scope.suggestionDet.emp_details.empId),null!=$scope.suggestionDet.customEvaluationParticularsList&&0<$scope.suggestionDet.customEvaluationParticularsList.length)for(var u=0;u<$scope.suggestionDet.customEvaluationParticularsList.length;u++){var d={id:$scope.suggestionDet.customEvaluationParticularsList[u].id,action:"DELETE"};o.push(d)}o.push(g)}else 0<$scope.particulars[a].selectedId&&$scope.particulars[a].isChecked&&(r.tangible?$scope.particulars[a].hasOwnProperty("newUnit")&&$scope.particulars[a].hasOwnProperty("newValue")&&($scope.particulars[a].unit=$scope.particulars[a].newUnit,$scope.particulars[a].value=$scope.particulars[a].newValue,$scope.particulars[a].frequency=$scope.particulars[a].evalFrequency?$scope.particulars[a].evalFrequency.value:$scope.particulars[a].frequency,$scope.particulars[a].existingValue=$scope.particulars[a].evalExistingValue,$scope.checkBenefitsValue($scope.particulars[a]))&&(g={id:r.selectedId,particular:{id:r.id},suggestion:{sugId:$scope.selectedSuggId},createdById:$scope.loggedInEmpId,isActive:"Y",tangible:r.tangible,recommendedBy:$scope.loggedInEmpId,action:"UPDATE",roleId:8},r.tangible&&(g.unit=r.unit.unit,g.masterUnit={id:r.unit.id},g.value=r.value,g.unit=r.unit.unit,g.frequency=r.frequency,r.existingValue)&&0<r.existingValue&&(g.existingValue=r.existingValue),null!=$scope.suggestionDet.emp_details&&null!=$scope.suggestionDet.emp_details&&(g.sugCreatedByEmpId=$scope.suggestionDet.emp_details.empId),o.push(g)):(g={id:r.selectedId,particular:{id:r.id},suggestion:{sugId:$scope.selectedSuggId},createdById:$scope.loggedInEmpId,isActive:"Y",tangible:r.tangible,recommendedBy:$scope.loggedInEmpId,action:"UPDATE",roleId:8},null!=$scope.suggestionDet.emp_details&&null!=$scope.suggestionDet.emp_details&&(g.sugCreatedByEmpId=$scope.suggestionDet.emp_details.empId),o.push(g)))}$scope.data.suggParticulars=o;var c=[];if(null!=$scope.SavingTypeLists&&0<$scope.SavingTypeLists.length)for(a=0;a<$scope.SavingTypeLists.length;a++){g={id:0,setPointsForSaving:{id:parseInt($scope.SavingTypeLists[a].amt.id)},suggestion:{sugId:$scope.selectedSuggId},sugCreatedByEmpId:$scope.suggestionDet.emp_details.empId,points:$scope.SavingTypeLists[a].points,createdById:$scope.loggedInEmpId};c.push(g)}if(null!=c&&0<c.length&&($scope.data.evalPoints=c),null!=$scope.suggestionDet.dept&&"HD"!=$scope.suggestionDet.sourceType){var p=[];if(null!=$scope.departmentList&&0<$scope.departmentList.length){for(a=0;a<$scope.departmentList.length;a++){var m=$scope.departmentList[a];if($scope.departmentList[a].isEvalselect)if($scope.departmentList[a].lineFound)for(var D=0;D<$scope.departmentList[a].lineList.length;D++){var f=$scope.departmentList[a].lineList[D];!$scope.departmentList[a].lineList[D].isEvalselect||"All"==m.deptName&&"All"==f.name||p.push({deptId:m.deptId,suggestionDet:{sugId:$scope.selectedSuggId},lineId:f.id})}else p.push({deptId:m.deptId,suggestionDet:{sugId:$scope.selectedSuggId}})}null!=p&&0<p.length&&($scope.data.suggestionHorizontalDept=p)}}if(null!=$scope.suggestionDet.circle&&"HD"!=$scope.suggestionDet.sourceType){if($scope.pillarList=[],null!=$scope.machineHDList&&0<$scope.machineHDList.length)for(a=0;a<$scope.machineHDList.length;a++)L={circleId:$scope.machineHDList[a].circle.id,stageId:$scope.machineHDList[a].stage.id,productId:$scope.machineHDList[a].product.id,machineId:0,operationId:$scope.machineHDList[a].operation.id,productNoId:$scope.machineHDList[a].productNo.id,suggestionDet:{sugId:$scope.selectedSuggId}},null!=$scope.machineHDList[a].machine&&null!=$scope.machineHDList[a].machine&&(L.machineId=$scope.machineHDList[a].machine.id),$scope.pillarList.push(L);null!=$scope.pillarList&&0<$scope.pillarList.length&&($scope.data.suggestionHorizontalDept=$scope.pillarList)}if(null!=$scope.parentSuggType){if(0!=$scope.parentSuggType.deptId&&"HD"==$scope.suggestionDet.sourceType){p=[];if(null!=$scope.departmentList&&0<$scope.departmentList.length){for(a=0;a<$scope.departmentList.length;a++){m=$scope.departmentList[a];if($scope.departmentList[a].isEvalselect)if($scope.departmentList[a].lineFound)for(D=0;D<$scope.departmentList[a].lineList.length;D++){f=$scope.departmentList[a].lineList[D];$scope.departmentList[a].lineList[D].isEvalselect&&"All"!=m.deptName&&"All"!=f.name&&p.push({deptId:m.deptId,suggestionDet:{sugId:$scope.selectedSuggId},lineId:f.id})}else p.push({deptId:m.deptId,suggestionDet:{sugId:$scope.selectedSuggId}})}null!=p&&0<p.length&&($scope.data.suggestionHorizontalDept=p)}}if(0!=$scope.parentSuggType.circleId&&"HD"==$scope.suggestionDet.sourceType){if($scope.pillarList=[],null!=$scope.machineHDList&&0<$scope.machineHDList.length)for(a=0;a<$scope.machineHDList.length;a++)L={circleId:$scope.machineHDList[a].circle.id,stageId:$scope.machineHDList[a].stage.id,productId:$scope.machineHDList[a].product.id,machineId:0,operationId:$scope.machineHDList[a].operation.id,productNoId:$scope.machineHDList[a].productNo.id,suggestionDet:{sugId:$scope.selectedSuggId}},null!=$scope.machineHDList[a].machine&&null!=$scope.machineHDList[a].machine&&(L.machineId=$scope.machineHDList[a].machine.id),$scope.pillarList.push(L);null!=$scope.pillarList&&0<$scope.pillarList.length&&($scope.data.suggestionHorizontalDept=$scope.pillarList)}}if("OPT_FOR_OTH_PLANTS"==$scope.hdConfigData.hdOptions&&(null!=$scope.data.suggestionHorizontalDept&&null!=$scope.data.suggestionHorizontalDept||($scope.data.suggestionHorizontalDept=[]),$scope.data.branchIds=[],null!=$scope.hDBranchList)&&0<$scope.hDBranchList.length)for(let e=0;e<$scope.hDBranchList.length;e++)$scope.hDBranchList[e].isEvalPlantselect&&$scope.data.suggestionHorizontalDept.push({branchId:$scope.hDBranchList[e].branchId,suggestionDet:{sugId:$scope.selectedSuggId}});if(1!=$scope.suggestionDet.isHDRequire||null!=$scope.data.suggestionHorizontalDept&&0!=$scope.data.suggestionHorizontalDept.length?$scope.data.isHorizDeployReq="Y":$scope.data.isHorizDeployReq="NA",1!=$scope.suggestionDet.tmpIsDocumentChangeRequire||null!=$scope.data.document&&0!=$scope.data.document.length?$scope.data.isDocumentChangeRequire="Y":$scope.data.isDocumentChangeRequire="NA",null!=$scope.suggestionDet.dept&&"Y"==$scope.suggFlowConfig.isHorizDplymntsEnbld&&"Y"==$scope.suggFlowConfig.isEvalEnbld&&"Y"==$scope.isHorizDeployReq)for(a=0;a<$scope.departmentList.length;a++)if($scope.departmentList[a].isEvalselect&&$scope.departmentList[a].lineFound)for(D=0;D<$scope.departmentList[a].lineList.length;D++)if(0==$filter("filter")($scope.departmentList[a].lineList,{isEvalselect:!0}).length)return $scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,void C.create($filter("translate")("Please_select_line_horizontal_deployment"),6e3,"error");var h=E.empDetails.productOrgConfigDet;if("Y"==$scope.suggFlowConfig.isKaizenActEnbld&&"Y"==$scope.suggFlowConfig.isEvalEnbld&&1==h.isActivityOn&&(null==$scope.data.suggActivity||0==$scope.data.suggActivity.length))return C.create($filter("translate")("Kaizen_activities_are_mandatory"),6e3,"error"),$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,$scope.flagSelectTeamMem=!0,void($scope.flagTeamDetPopupSpinner=!1);var t=$filter("filter")($scope.particulars,{isChecked:!0});if("Y"==$scope.suggFlowConfig.isEvalEnbld&&"Y"==$scope.suggFlowConfig.isParticularsEnbld&&1==h.isPraticularsMandatory&&!(null!=t&&0!=t.length||null!=$scope.data.suggParticulars&&0!=$scope.data.suggParticulars.length))return C.create($filter("translate")("Other_benefits_are_mandatory"),6e3,"error"),$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,$scope.flagSelectTeamMem=!0,void($scope.flagTeamDetPopupSpinner=!1);if($scope.isEmpty($scope.suggestionDet.hdCatId)||null==$scope.suggestionDet.hdCatId||null==$scope.suggestionDet.hdCatId||""==$scope.suggestionDet.hdCatId)return $scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,void C.create($filter("translate")("Please_select_category"),6e3,"error");if($scope.isEmpty($scope.suggestionDet.hdCatId)||null==$scope.suggestionDet.hdCatId||null==$scope.suggestionDet.hdCatId||""==$scope.suggestionDet.hdCatId||($scope.data.catId=parseInt($scope.suggestionDet.hdCatId.catId)),"Y"==$scope.suggFlowConfig.isEvalSapCodeEnbld){if(1==E.empDetails.productOrgConfigDet.isSapCodeMandatory)for(let e=0;e<$scope.catbranchwise.length;e++)if($scope.catbranchwise[e].catId==$scope.suggestionDet.hdCatId.catId&&"Y"==$scope.catbranchwise[e].isSapCodeRequired&&(""==$scope.suggestionDet.sapCode||null==$scope.suggestionDet.sapCode||null==$scope.suggestionDet.sapCode))return C.create($filter("translate")("Plese_enter_SAPCode"),6e3,"error"),$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,$scope.flagSelectTeamMem=!0,void($scope.flagTeamDetPopupSpinner=!1);""!=$scope.suggestionDet.sapCode&&null!=$scope.suggestionDet.sapCode&&null!=$scope.suggestionDet.sapCode&&($scope.data.sapCode=$scope.suggestionDet.sapCode)}if($scope.data.estimatedCost=$scope.evaluationDet.estimatedCost,$scope.data.summary=$scope.evaluationDet.evaluationInputs,$scope.data.sugTrackId=$scope.evaluationDet.sugTrackId,null!=$scope.suggestionDet.whyWhyAnalysis&&null!=$scope.suggestionDet.whyWhyAnalysis&&""!=$scope.suggestionDet.whyWhyAnalysis&&($scope.data.whyWhyAnalysis=$scope.suggestionDet.whyWhyAnalysis),null!=$scope.suggestionDet.whatToDo&&null!=$scope.suggestionDet.whatToDo&&""!=$scope.suggestionDet.whatToDo&&($scope.data.whatToDo=$scope.suggestionDet.whatToDo),null!=$scope.suggestionDet.howToDo&&null!=$scope.suggestionDet.howToDo&&""!=$scope.suggestionDet.howToDo&&($scope.data.howToDo=$scope.suggestionDet.howToDo),null!=$scope.suggestionDet.benefits&&null!=$scope.suggestionDet.benefits&&""!=$scope.suggestionDet.benefits&&($scope.data.benefits=$scope.suggestionDet.benefits),null!=$scope.suggestionDet.results&&null!=$scope.suggestionDet.results&&""!=$scope.suggestionDet.results&&($scope.data.results=$scope.suggestionDet.results),null!=$scope.suggestionDet.kaizenIdea&&null!=$scope.suggestionDet.kaizenIdea&&""!=$scope.suggestionDet.kaizenIdea&&($scope.data.kaizenIdea=$scope.suggestionDet.kaizenIdea),null!=$scope.suggestionDet.frquency&&null!=$scope.suggestionDet.frquency&&""!=$scope.suggestionDet.frquency&&($scope.data.frquency=$scope.suggestionDet.frquency),null!=$scope.suggestionDet.counterMeasures&&null!=$scope.suggestionDet.counterMeasures&&""!=$scope.suggestionDet.counterMeasures&&($scope.data.counterMeasures=$scope.suggestionDet.counterMeasures),null!=$scope.suggestionDet.rootCause&&null!=$scope.suggestionDet.rootCause&&""!=$scope.suggestionDet.rootCause&&($scope.data.rootCause=$scope.suggestionDet.rootCause),"Y"==$scope.suggFlowConfig.isParticularsEnbld&&"Y"==$scope.suggFlowConfig.kaizenCheckReqEval&&null!=$scope.suggestionDet.evalSustenanceflow&&null!=$scope.suggestionDet.evalSustenanceflow&&$scope.suggestionDet.evalSustenanceflow){if(null==$scope.suggestionDet.sustenanceAuditorList||0==$scope.suggestionDet.sustenanceAuditorList.length)return C.create($filter("translate")("Auditor_setup_not_found_for_this_category_Please_add_Auditor"),6e3,"error"),$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,$scope.flagSelectTeamMem=!0,void($scope.flagTeamDetPopupSpinner=!1);if(null==$scope.suggestionDet.sustenanceAuditorId||null==$scope.suggestionDet.sustenanceAuditorId||""==$scope.suggestionDet.sustenanceAuditorId)return C.create($filter("translate")("Please_select_sustenance_auditor"),6e3,"error"),$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,$scope.flagSelectTeamMem=!0,void($scope.flagTeamDetPopupSpinner=!1);$scope.data.kaizenSusReqByEval=$scope.suggestionDet.evalSustenanceflow,$scope.data.sustenanceAuditorId=$scope.suggestionDet.sustenanceAuditorId}if(("Y"==$scope.suggFlowConfig.evalIdeaAward||"Y"==$scope.suggFlowConfig.evalImpleAward)&&null!=$scope.suggestionDet.sugesstionStatusAudit&&0<$scope.suggestionDet.sugesstionStatusAudit.length){for(var I=0,y=0;y<$scope.suggestionDet.sugesstionStatusAudit.length;y++)if($scope.suggestionDet.sugesstionStatusAudit[y].status_master.status==$scope.CONST.STATUS.EvaluationRequestAccepted.status){I=$scope.suggestionDet.sugesstionStatusAudit[y].stsadtId;break}0!=I&&($scope.data.statusAuditId=I)}"Y"==$scope.suggFlowConfig.evalIdeaAward&&($scope.data.ideaAwardRecommEval=!!$scope.suggestionDet.recommendationData.ideaAwardRecommEval,$scope.suggestionDet.recommendationData.ideaAwardRecommEval)&&null!=$scope.suggestionDet.recommendationData.ideaAwardCommentEval&&null!=$scope.suggestionDet.recommendationData.ideaAwardCommentEval&&0!=$scope.suggestionDet.recommendationData.ideaAwardCommentEval.trim().length&&($scope.data.ideaAwardCommentEval=$scope.suggestionDet.recommendationData.ideaAwardCommentEval),"Y"==$scope.suggFlowConfig.evalImpleAward&&($scope.data.implAwardRecommEval=!!$scope.suggestionDet.recommendationData.implAwardRecommEval,$scope.suggestionDet.recommendationData.implAwardRecommEval)&&null!=$scope.suggestionDet.recommendationData.implAwardCommentEval&&null!=$scope.suggestionDet.recommendationData.implAwardCommentEval&&0!=$scope.suggestionDet.recommendationData.implAwardCommentEval.trim().length&&($scope.data.implAwardCommentEval=$scope.suggestionDet.recommendationData.implAwardCommentEval)}else if($scope.selectedTeamTypeForAssign==$scope.CONST.TEAM_TYPE.APPROVEDBYFC)$scope.data.stsId=$scope.CONST.STATUS.ImplementationAssigned.statusId,$scope.data.tmtypeId=2;else if($scope.selectedTeamTypeForAssign==$scope.CONST.TEAM_TYPE.EVALFC){if(null==$scope.evaluationDet.evaluationInputs||""==$scope.evaluationDet.evaluationInputs)return C.create($filter("translate")("Evaluation_details_are_mandatory"),6e3,"error"),$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,$scope.flagSelectTeamMem=!0,void($scope.flagTeamDetPopupSpinner=!1);if(null==$scope.evaluationDet.estimatedCost||""==$scope.evaluationDet.estimatedCost||0==$scope.evaluationDet.estimatedCost)return C.create($filter("translate")("Budgetary_Cost_is_mandatory"),6e3,"error"),$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,$scope.flagSelectTeamMem=!0,void($scope.flagTeamDetPopupSpinner=!1);if(($scope.suggestionDet.status_master.status==$scope.CONST.STATUS.EvaluationRequestAccepted.status||$scope.suggestionDet.status_master.status==$scope.CONST.STATUS.ReassignedToEvaluationTeam.status)&&1==$scope.productOrgConfigList.isPriorityMadatory&&null==$scope.suggestionDet.suggPriority&&"Y"==$scope.suggFlowConfig.isImplPriority)return C.create($filter("translate")("Implementation_Priority_is_mandatory"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);$scope.data={sugId:parseInt($scope.selectedSuggId),statusId:$scope.CONST.STATUS.AssignedForFCApproval.statusId,assignedById:s,summary:$scope.evaluationDet.evaluationInputs,amount:$scope.evaluationDet.estimatedCost,branchId:$scope.suggestionDet.branch.branchId,orgId:$scope.loggedInUserOrgId,sugTrackId:$scope.evaluationDet.sugTrackId,teamTypeId:1},$scope.suggestionDet.status_master.status!=$scope.CONST.STATUS.EvaluationRequestAccepted.status&&$scope.suggestionDet.status_master.status!=$scope.CONST.STATUS.ReassignedToEvaluationTeam.status||(1==$scope.productOrgConfigList.isPriorityMadatory&&null!=$scope.suggestionDet.suggPriority&&""!=$scope.suggestionDet.suggPriority?"Y"==$scope.suggFlowConfig.isImplPriority&&$scope.suggestionDet.suggPriority.id?$scope.data.suggPriority=$scope.suggestionDet.suggPriority.id:"Y"==$scope.suggFlowConfig.isImplPriority&&($scope.data.suggPriority=$scope.suggestionDet.suggPriority):"Y"==$scope.suggFlowConfig.isImplPriority&&null!=$scope.suggestionDet.suggPriority&&""!=$scope.suggestionDet.suggPriority&&($scope.suggestionDet.suggPriority.id?$scope.data.suggPriority=$scope.suggestionDet.suggPriority.id:$scope.data.suggPriority=$scope.suggestionDet.suggPriority));for(n=[],a=0;a<$scope.documentLists.length;a++)$scope.documentLists[a].isChecked&&(g={suggestion:{sugId:$scope.selectedSuggId},branch:{branchId:$scope.suggestionDet.branch.branchId},document:{id:parseInt($scope.documentLists[a].id)},isDeactive:0},n.push(g));for(a=0;a<$scope.documentLists.length;a++)if(!$scope.documentLists[a].isChecked&&null!=$scope.suggestionDet.document&&0<$scope.suggestionDet.document.length)for(let e=0;e<$scope.suggestionDet.document.length;e++)$scope.suggestionDet.document[e].document.id==$scope.documentLists[a].id&&(g={suggestion:{sugId:$scope.selectedSuggId},branch:{branchId:$scope.suggestionDet.branch.branchId},document:{id:parseInt($scope.documentLists[a].id)},isDeactive:1,id:$scope.suggestionDet.document[e].id},n.push(g));$scope.data.document=n;for(var S,l=[],a=0;a<$scope.activityList.length;a++)$scope.activityList[a].isselect&&(S={id:0,suggestion:{sugId:$scope.suggestionDet.sugId},activity:$scope.activityList[a]},l.push(S));$scope.data.suggActivity=l;o=[];if(null!=$scope.particulars&&0<$scope.particulars.length)for(a=0;a<$scope.particulars.length;a++){if(1<$filter("filter")($scope.particulars,{isChecked:!0}).length)return $scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,void C.create($filter("translate")("Please_select_only_one_benefit"),5e3,"error");if($scope.particulars[a].isChecked&&$scope.particulars[a].tangible){if(!$scope.particulars[a].hasOwnProperty("newUnit")&&!$scope.particulars[a].hasOwnProperty("newValue"))return $scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,void C.create($filter("translate")("Please_enter_value_and_unit_for_tangible_benefit"),5e3,"error");if($scope.particulars[a].hasOwnProperty("newUnit")&&$scope.particulars[a].hasOwnProperty("newValue")&&(null==$scope.particulars[a].newUnit||""==$scope.particulars[a].newUnit||$scope.isEmpty($scope.particulars[a].newUnit)||null==$scope.particulars[a].newValue||""==$scope.particulars[a].newValue))return $scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,void C.create($filter("translate")("Please_enter_value_and_unit_for_tangible_benefit"),5e3,"error")}r=$scope.particulars[a],g={};if(0==$scope.particulars[a].selectedId&&$scope.particulars[a].isChecked){if(g={id:0,particular:{id:r.id},suggestion:{sugId:$scope.selectedSuggId},createdById:$scope.loggedInEmpId,isActive:"Y",tangible:r.tangible,recommendedBy:$scope.loggedInEmpId,action:"ADD",roleId:8,catId:parseInt($scope.suggestionDet.selectedEvalCatId)},r.tangible&&(g.unit=r.newUnit.unit,g.masterUnit={id:r.newUnit.id},r.newValue&&0<r.newValue&&(g.value=r.newValue),g.frequency=r.evalFrequency?r.evalFrequency.value:r.frequency,r.evalExistingValue)&&0<r.evalExistingValue&&(g.existingValue=r.evalExistingValue),null!=$scope.suggestionDet.emp_details&&null!=$scope.suggestionDet.emp_details&&(g.sugCreatedByEmpId=$scope.suggestionDet.emp_details.empId),null!=$scope.suggestionDet.customEvaluationParticularsList&&0<$scope.suggestionDet.customEvaluationParticularsList.length)for(u=0;u<$scope.suggestionDet.customEvaluationParticularsList.length;u++){d={id:$scope.suggestionDet.customEvaluationParticularsList[u].id,action:"DELETE"};o.push(d)}o.push(g)}else 0<$scope.particulars[a].selectedId&&($scope.particulars[a].isChecked&&(r.tangible?$scope.particulars[a].hasOwnProperty("newUnit")&&$scope.particulars[a].hasOwnProperty("newValue")&&($scope.particulars[a].unit=$scope.particulars[a].newUnit,$scope.particulars[a].value=$scope.particulars[a].newValue,$scope.particulars[a].frequency=$scope.particulars[a].evalFrequency?$scope.particulars[a].evalFrequency.value:$scope.particulars[a].frequency,$scope.particulars[a].existingValue=$scope.particulars[a].evalExistingValue,$scope.checkBenefitsValue($scope.particulars[a]))&&(g={id:r.selectedId,particular:{id:r.id},suggestion:{sugId:$scope.selectedSuggId},createdById:$scope.loggedInEmpId,isActive:"Y",tangible:r.tangible,recommendedBy:$scope.loggedInEmpId,action:"UPDATE",roleId:8},r.tangible)&&(g.unit=r.unit.unit,g.masterUnit={id:r.unit.id},g.value=r.value,g.unit=r.unit.unit,g.frequency=r.frequency,r.existingValue)&&0<r.existingValue&&(g.existingValue=r.existingValue):g={id:r.selectedId,particular:{id:r.id},suggestion:{sugId:$scope.selectedSuggId},createdById:$scope.loggedInEmpId,isActive:"Y",tangible:r.tangible,recommendedBy:$scope.loggedInEmpId,action:"UPDATE",roleId:8}),null!=$scope.suggestionDet.emp_details&&null!=$scope.suggestionDet.emp_details&&(g.sugCreatedByEmpId=$scope.suggestionDet.emp_details.empId),o.push(g))}$scope.data.suggParticulars=o;for(c=[],a=0;a<$scope.SavingTypeLists.length;a++){g={id:0,setPointsForSaving:{id:parseInt($scope.SavingTypeLists[a].amt.id)},suggestion:{sugId:$scope.selectedSuggId},sugCreatedByEmpId:$scope.suggestionDet.emp_details.empId,points:$scope.SavingTypeLists[a].points,createdById:$scope.loggedInEmpId};c.push(g)}null!=c&&0<c.length&&($scope.data.evalPoints=c);p=[];if(null!=$scope.suggestionDet.dept&&"HD"!=$scope.suggestionDet.sourceType){p=[];if(null!=$scope.departmentList&&0<$scope.departmentList.length){for(a=0;a<$scope.departmentList.length;a++){m=$scope.departmentList[a];if($scope.departmentList[a].isEvalselect)if($scope.departmentList[a].lineFound)for(D=0;D<$scope.departmentList[a].lineList.length;D++){f=$scope.departmentList[a].lineList[D];$scope.departmentList[a].lineList[D].isEvalselect&&"All"!=m.deptName&&"All"!=f.name&&p.push({deptId:m.deptId,suggestionDet:{sugId:$scope.selectedSuggId},lineId:f.id})}else p.push({deptId:m.deptId,suggestionDet:{sugId:$scope.selectedSuggId}})}null!=p&&0<p.length&&($scope.data.suggestionHorizontalDept=p)}}if(null!=$scope.suggestionDet.circle&&"HD"!=$scope.suggestionDet.sourceType){if($scope.pillarList=[],null!=$scope.machineHDList&&0<$scope.machineHDList.length)for(a=0;a<$scope.machineHDList.length;a++)L={circleId:$scope.machineHDList[a].circle.id,stageId:$scope.machineHDList[a].stage.id,productId:$scope.machineHDList[a].product.id,machineId:0,operationId:$scope.machineHDList[a].operation.id,productNoId:$scope.machineHDList[a].productNo.id,suggestionDet:{sugId:$scope.selectedSuggId}},null!=$scope.machineHDList[a].machine&&null!=$scope.machineHDList[a].machine&&(L.machineId=$scope.machineHDList[a].machine.id),$scope.pillarList.push(L);null!=$scope.pillarList&&0<$scope.pillarList.length&&($scope.data.suggestionHorizontalDept=$scope.pillarList)}if(null!=$scope.parentSuggType){if(0!=$scope.parentSuggType.deptId&&"HD"==$scope.suggestionDet.sourceType){p=[];if(null!=$scope.departmentList&&0<$scope.departmentList.length){for(a=0;a<$scope.departmentList.length;a++){m=$scope.departmentList[a];if($scope.departmentList[a].isEvalselect)if($scope.departmentList[a].lineFound)for(D=0;D<$scope.departmentList[a].lineList.length;D++){f=$scope.departmentList[a].lineList[D];!$scope.departmentList[a].lineList[D].isEvalselect||"All"==m.deptName&&"All"==f.name||p.push({deptId:m.deptId,suggestionDet:{sugId:$scope.selectedSuggId},lineId:f.id})}else p.push({deptId:m.deptId,suggestionDet:{sugId:$scope.selectedSuggId}})}null!=p&&0<p.length&&($scope.data.suggestionHorizontalDept=p)}}if(0!=$scope.parentSuggType.circleId&&"HD"==$scope.suggestionDet.sourceType){if($scope.pillarList=[],null!=$scope.machineHDList&&0<$scope.machineHDList.length)for(var L,a=0;a<$scope.machineHDList.length;a++)L={circleId:$scope.machineHDList[a].circle.id,stageId:$scope.machineHDList[a].stage.id,productId:$scope.machineHDList[a].product.id,machineId:$scope.machineHDList[a].machine.id,suggestionDet:{sugId:$scope.selectedSuggId}},$scope.pillarList.push(L);null!=$scope.pillarList&&0<$scope.pillarList.length&&($scope.data.suggestionHorizontalDept=$scope.pillarList)}}if("OPT_FOR_OTH_PLANTS"==$scope.hdConfigData.hdOptions){null!=$scope.data.suggestionHorizontalDept&&null!=$scope.data.suggestionHorizontalDept||($scope.data.suggestionHorizontalDept=[]),$scope.data.branchIds=[];for(let e=0;e<$scope.hDBranchList.length;e++)$scope.hDBranchList[e].isEvalPlantselect&&$scope.data.suggestionHorizontalDept.push({branchId:$scope.hDBranchList[e].branchId,suggestionDet:{sugId:$scope.selectedSuggId}})}if($scope.isEmpty($scope.suggestionDet.hdCatId)||null==$scope.suggestionDet.hdCatId||null==$scope.suggestionDet.hdCatId||""==$scope.suggestionDet.hdCatId)return C.create($filter("translate")("Please_select_category"),6e3,"error"),$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,$scope.flagSelectTeamMem=!0,void($scope.flagTeamDetPopupSpinner=!1);if("Y"==$scope.suggFlowConfig.isEvalSapCodeEnbld){if(1==E.empDetails.productOrgConfigDet.isSapCodeMandatory)for(let e=0;e<$scope.catbranchwise.length;e++)if($scope.catbranchwise[e].catId==$scope.suggestionDet.hdCatId.catId&&"Y"==$scope.catbranchwise[e].isSapCodeRequired&&(""==$scope.suggestionDet.sapCode||null==$scope.suggestionDet.sapCode||null==$scope.suggestionDet.sapCode))return $scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,void C.create($filter("translate")("Plese_enter_SAPCode"),6e3,"error");""!=$scope.suggestionDet.sapCode&&null!=$scope.suggestionDet.sapCode&&null!=$scope.suggestionDet.sapCode&&($scope.data.sapCode=$scope.suggestionDet.sapCode)}1!=$scope.suggestionDet.isHDRequire||null!=$scope.data.suggestionHorizontalDept&&0!=$scope.data.suggestionHorizontalDept.length?$scope.data.isHorizDeployReq="Y":$scope.data.isHorizDeployReq="NA",1!=$scope.suggestionDet.tmpIsDocumentChangeRequire||null!=$scope.data.document&&0!=$scope.data.document.length?$scope.data.isDocumentChangeRequire="Y":$scope.data.isDocumentChangeRequire="NA";h=E.empDetails.productOrgConfigDet;if("Y"==$scope.suggFlowConfig.isHorizDplymntsEnbld&&"Y"==$scope.suggFlowConfig.isEvalEnbld&&"Y"==$scope.isHorizDeployReq&&null==$scope.data.suggestionHorizontalDept)return $scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,void C.create($filter("translate")("Evaluation_horizontal_deployment_mandatory"),6e3,"error");if(null!=$scope.suggestionDet.dept)for(a=0;a<$scope.departmentList.length;a++)if($scope.departmentList[a].isEvalselect&&$scope.departmentList[a].lineFound)for(D=0;D<$scope.departmentList[a].lineList.length;D++)if(0==$filter("filter")($scope.departmentList[a].lineList,{isEvalselect:!0}).length)return $scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,void C.create($filter("translate")("Please_select_line_horizontal_deployment"),6e3,"error");if("Y"==$scope.suggFlowConfig.isKaizenActEnbld&&"Y"==$scope.suggFlowConfig.isEvalEnbld&&1==h.isActivityOn&&(null==$scope.data.suggActivity||0==$scope.data.suggActivity.length))return C.create($filter("translate")("Kaizen_activities_are_mandatory"),6e3,"error"),$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,$scope.flagSelectTeamMem=!0,void($scope.flagTeamDetPopupSpinner=!1);if("Y"==$scope.suggFlowConfig.isEvalEnbld&&"Y"==$scope.suggFlowConfig.isParticularsEnbld&&1==h.isPraticularsMandatory&&(null==$scope.data.suggParticulars||0==$scope.data.suggParticulars.length))return C.create($filter("translate")("Other_benefits_are_mandatory"),6e3,"error"),$scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if(null!=$scope.suggestionDet.whyWhyAnalysis&&null!=$scope.suggestionDet.whyWhyAnalysis&&""!=$scope.suggestionDet.whyWhyAnalysis&&($scope.data.whyWhyAnalysis=$scope.suggestionDet.whyWhyAnalysis),null!=$scope.suggestionDet.whatToDo&&null!=$scope.suggestionDet.whatToDo&&""!=$scope.suggestionDet.whatToDo&&($scope.data.whatToDo=$scope.suggestionDet.whatToDo),null!=$scope.suggestionDet.howToDo&&null!=$scope.suggestionDet.howToDo&&""!=$scope.suggestionDet.howToDo&&($scope.data.howToDo=$scope.suggestionDet.howToDo),null!=$scope.suggestionDet.benefits&&null!=$scope.suggestionDet.benefits&&""!=$scope.suggestionDet.benefits&&($scope.data.benefits=$scope.suggestionDet.benefits),null!=$scope.suggestionDet.results&&null!=$scope.suggestionDet.results&&""!=$scope.suggestionDet.results&&($scope.data.results=$scope.suggestionDet.results),null!=$scope.suggestionDet.kaizenIdea&&null!=$scope.suggestionDet.kaizenIdea&&""!=$scope.suggestionDet.kaizenIdea&&($scope.data.kaizenIdea=$scope.suggestionDet.kaizenIdea),null!=$scope.suggestionDet.frquency&&null!=$scope.suggestionDet.frquency&&""!=$scope.suggestionDet.frquency&&($scope.data.frquency=$scope.suggestionDet.frquency),null!=$scope.suggestionDet.counterMeasures&&null!=$scope.suggestionDet.counterMeasures&&""!=$scope.suggestionDet.counterMeasures&&($scope.data.counterMeasures=$scope.suggestionDet.counterMeasures),null!=$scope.suggestionDet.rootCause&&null!=$scope.suggestionDet.rootCause&&""!=$scope.suggestionDet.rootCause&&($scope.data.rootCause=$scope.suggestionDet.rootCause),null!=$scope.suggestionDet.pcrNumber&&""!=$scope.suggestionDet.pcrNumber&&"Y"==$scope.suggFlowConfig.isPCRNoEnbld&&($scope.data.pcrNo=$scope.suggestionDet.pcrNumber),consoleLog($scope.data),$scope.isEmpty($scope.suggestionDet.hdCatId)||null==$scope.suggestionDet.hdCatId||null==$scope.suggestionDet.hdCatId||""==$scope.suggestionDet.hdCatId)return $scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,void C.create($filter("translate")("Please_select_category"),6e3,"error");if($scope.isEmpty($scope.suggestionDet.hdCatId)||null==$scope.suggestionDet.hdCatId||null==$scope.suggestionDet.hdCatId||""==$scope.suggestionDet.hdCatId||($scope.data.catId=parseInt($scope.suggestionDet.hdCatId.catId)),("Y"==$scope.suggFlowConfig.evalIdeaAward||"Y"==$scope.suggFlowConfig.evalImpleAward)&&null!=$scope.suggestionDet.sugesstionStatusAudit&&0<$scope.suggestionDet.sugesstionStatusAudit.length){for(I=0,y=0;y<$scope.suggestionDet.sugesstionStatusAudit.length;y++)if($scope.suggestionDet.sugesstionStatusAudit[y].status_master.status==$scope.CONST.STATUS.EvaluationRequestAccepted.status){I=$scope.suggestionDet.sugesstionStatusAudit[y].stsadtId;break}0!=I&&($scope.data.statusAuditId=I)}"Y"==$scope.suggFlowConfig.evalIdeaAward&&($scope.data.ideaAwardRecommEval=!!$scope.suggestionDet.recommendationData.ideaAwardRecommEval,$scope.suggestionDet.recommendationData.ideaAwardRecomm)&&null!=$scope.suggestionDet.recommendationData.ideaAwardCommentEval&&null!=$scope.suggestionDet.recommendationData.ideaAwardCommentEval&&0!=$scope.suggestionDet.recommendationData.ideaAwardCommentEval.trim().length&&($scope.data.ideaAwardCommentEval=$scope.suggestionDet.recommendationData.ideaAwardCommentEval),"Y"==$scope.suggFlowConfig.evalImpleAward&&($scope.data.implAwardRecommEval=!!$scope.suggestionDet.recommendationData.implAwardRecommEval,$scope.suggestionDet.recommendationData.implAwardRecommEval)&&null!=$scope.suggestionDet.recommendationData.implAwardCommentEval&&null!=$scope.suggestionDet.recommendationData.implAwardCommentEval&&0!=$scope.suggestionDet.recommendationData.implAwardCommentEval.trim().length&&($scope.data.implAwardCommentEval=$scope.suggestionDet.recommendationData.implAwardCommentEval),e="suggestionAssignToFinanceController"}else if("reassignToFC"==$scope.selectedTeamTypeForAssign){for(var v=0,a=0;a<=$scope.suggestionDet.sugesstionStatusAudit.length;a++)if($scope.suggestionDet.sugesstionStatusAudit[a].status_master.status==$scope.CONST.STATUS.AssignedForFCApproval.status){v=$scope.suggestionDet.sugesstionStatusAudit[a].emp_details.empId;break}if(null==$scope.suggestionDet.eval||null==$scope.suggestionDet.eval.estimatedCost||""==$scope.suggestionDet.eval.estimatedCost||0==$scope.suggestionDet.eval.estimatedCost)return C.create($filter("translate")("Budgetary_Cost_is_mandatory"),6e3,"error"),$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,$scope.flagSelectTeamMem=!0,void($scope.flagTeamDetPopupSpinner=!1);$scope.data={sugId:parseInt($scope.selectedSuggId),statusId:$scope.CONST.STATUS.AssignedForFCApproval.statusId,assignedById:v,amount:$scope.suggestionDet.eval.estimatedCost,branchId:$scope.suggestionDet.branch.branchId,orgId:$scope.loggedInUserOrgId,sugTrackId:$scope.suggestionDet.evaluationTeamList[0].sugTrackId,teamTypeId:1},e="suggestionAssignToFinanceController"}}else{if(e="passtopeer",null==(t=null!=$scope.empInputDet.selectedEmpIds&&0<$scope.empInputDet.selectedEmpIds.length?$scope.empInputDet.selectedEmpIds[0]:"")||""==t||angular.isUndefined(t))return $scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,void angular.element("#errId_team").text("Please select team member.");$scope.data={empId:t,sugId:parseInt($scope.selectedSuggId),assignedById:parseInt($scope.loggedInEmpId),summary:$scope.suggestionDet.passToPeerSummary},"byEval"==$scope.suggestionInputDetails.acceptRejBy&&($scope.data.statusId=$scope.CONST.STATUS.PassToPeerEvaluator.statusId,$scope.data.teamTypeId=1),"bySupervisor"==$scope.suggestionInputDetails.acceptRejBy&&($scope.data.statusId=$scope.CONST.STATUS.PassToPeerController.statusId),"byImpl"==$scope.suggestionInputDetails.acceptRejBy&&($scope.data.statusId=$scope.CONST.STATUS.PassToPeerImplementer.statusId,$scope.data.teamTypeId=2)}b.httpPost($scope.data,e).then(function(e){$scope.flagSelectTeamMem=!0,$scope.flagTeamDetPopupSpinner=!1,$scope.flagTeamDetPopupSpinner=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,"success"==e.status?($scope.machineHDList=[],$scope.suggestionDet={},$("#teamDetModal").modal("hide"),$("#implTeamDetModal").modal("hide"),$scope.flagAccPillerLeavel=!1,$scope.getsuggestionList("onUpdate"),$scope.getStatusWiseCount(),$scope.selectedTeamTypeForAssign==$scope.CONST.TEAM_TYPE.EVALUATION?($("#teamDetModalforEval").modal("hide"),C.create($filter("translate")("Suggestion_assinged_evaluator_successfully"),6e3,"success")):$scope.selectedTeamTypeForAssign==$scope.CONST.TEAM_TYPE.IMPLEMENTATION?1==$scope.suggestionDet.isSelfImplemented?C.create($filter("translate")("Suggestion_assinged_implementer_implementation"),6e3,"success"):(C.create($filter("translate")("Suggestion_implementer_successfully"),6e3,"success"),$scope.lineListNew=[]):"passToPeer"==$scope.selectedTeamTypeForAssign?($("#teamDetModalforEval").modal("hide"),$("#teamDetModalforController").modal("hide"),C.create($filter("translate")("Suggestion_assigned_to_peer_successfully"),6e3,"success")):$scope.selectedTeamTypeForAssign==$scope.CONST.TEAM_TYPE.EVALFC?C.create($filter("translate")("Suggestion_is_assinged_to_FC"),6e3,"success"):$scope.selectedTeamTypeForAssign==$scope.CONST.TEAM_TYPE.APPROVEDBYFC&&C.create($filter("translate")("Suggestion_implementer_successfully"),6e3,"success")):"fail"==e.status&&C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")})},$scope.setClTab=function(e){$scope.clTab=e},$scope.isSetClTab=function(e){return $scope.clTab===e},$scope.setImplClTab=function(e){$scope.implClTab=e},$scope.isSetImplClTab=function(e){return $scope.implClTab===e},$scope.change_flag_evalText=function(e){""==$scope.data||null==$scope.data||null==$scope.data?$scope.flagEvalText=!0:$scope.flagEvalText=!1},$scope.change_flag_implText=function(e){""==$scope.data||null==$scope.data||null==$scope.data?$scope.flagImplText=!0:$scope.flagImplText=!1},$scope.regx=/[^0-9]/g,$scope.change_flag_evalInputs=function(e){null!=e&&""!=e&&$scope.regx.test(e)?$scope.flagevalInputs=!0:$scope.flagevalInputs=!1},$scope.change_flag_implInputs=function(e,t){"actual"==t?null!=e&&""!=e&&null!=e.match($scope.regx)?$scope.flagimplInputs=!0:$scope.flagimplInputs=!1:null!=e&&""!=e&&null!=e.match($scope.regx)?$scope.flageffectiveimplInputs=!0:$scope.flageffectiveimplInputs=!1},$scope.submitInitialInputs=function(e,t,s){if("eval"==e){if($scope.flagEvalText=!1,""==t.evaluationInputs||null==t.evaluationInputs||null==t.evaluationInputs)return $scope.flagEvalText=!0,void angular.element("#errId_evalText").text($filter("translate")("Please_enter_evaluation_details"));if(null!=t.estimatedCost&&""!=t.estimatedCost&&null!=t.estimatedCost.match($scope.regx))return $scope.flagevalInputs=!0,void angular.element("#errId_evalInputs").text($filter("translate")("Please_enter_numbers_only"));$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!0,$scope.data={statusId:parseInt($scope.CONST.STATUS.EvaluationInputSubmitted.statusId),suggtrackId:parseInt(t.sugTrackId),evaluationInputs:t.evaluationInputs,estimatedCost:parseInt(t.estimatedCost),startDate:"2018-11-25",updatedById:parseInt($scope.loggedInEmpId),sugId:parseInt($scope.selectedSuggId),levelId:1,points:10}}else if("impl"==e){if($scope.flagImplText=!1,""==t.implInputs||null==t.implInputs||null==t.implInputs)return $scope.flagImplText=!0,void angular.element("#errId_implText").text($filter("translate")("Please_enter_implementation_details"));if(null!=t.implementedCost&&""!=t.implementedCost&&null!=t.implementedCost.match($scope.regx))return $scope.flagimplInputs=!0,void angular.element("#errId_implInputs").text($filter("translate")("Please_enter_numbers_only"));if(null!=t.costEffective&&""!=t.costEffective&&null!=t.costEffective.match($scope.regx))return $scope.flageffectiveimplInputs=!0,void angular.element("#errId_effectiveimplInputs").text($filter("translate")("Please_enter_numbers_only"));$scope.flagImplInputSubmitSpinner=!0,$scope.data={statusId:parseInt($scope.CONST.STATUS.ImplementationInputSubmitted.statusId),suggtrackId:parseInt(t.sugTrackId),implementedCost:parseInt(t.implementedCost),costEffective:parseInt(t.costEffective),implInputs:t.implInputs,startDate:"2018-11-25",updatedById:parseInt($scope.loggedInEmpId),sugId:parseInt($scope.selectedSuggId),levelId:1,points:10}}b.httpPost($scope.data,"submitEvaluationInitialInputs").then(function(e){$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,$scope.flagImplInputSubmitSpinner=!1,"success"==e.status?($scope.suggestionDet={},$scope.getsuggestionList("onUpdate"),$scope.getStatusWiseCount(),C.create($filter("translate")("Inputs_submitted_successfully"),5e3,"success")):"fail"==e.status&&C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")})},$scope.catFilter={categoryName:"All"},$scope.deptFilter={deptName:"All"},$scope.selectedDept=function(){"All"!=$scope.suggDetailModel.deptFilter.deptName?($scope.suggestionPagination.selectedDeptId=$scope.suggDetailModel.deptFilter.deptId,$scope.suggDetailModel.selectedDeptName=$scope.suggDetailModel.deptFilter.deptName):($scope.suggestionPagination.selectedDeptId=0,$scope.suggDetailModel.selectedDeptName=""),0==$scope.statusCountFilter?$scope.getsuggestionList("allSuggestion"):$scope.getsuggestionList("onLoad"),$scope.getStatusWiseCount()},$scope.selectedCategory=function(){"All"!=$scope.suggDetailModel.catFilter.categoryName?($scope.suggestionPagination.selectedCatId=$scope.suggDetailModel.catFilter.catId,$scope.suggDetailModel.selectedCategoryName=$scope.suggDetailModel.catFilter.categoryName):($scope.suggestionPagination.selectedCatId=0,$scope.suggDetailModel.selectedCategoryName=""),0==$scope.statusCountFilter?$scope.getsuggestionList("allSuggestion"):$scope.getsuggestionList("onLoad"),$scope.getStatusWiseCount()},$scope.selectedStatusSearch=function(){0==$scope.statusCountFilter?$scope.getsuggestionList("allSuggestion"):$scope.getsuggestionList("onLoad"),$scope.getStatusWiseCount()},$scope.selectedStatus=function(){$scope.selectedStatusName=$scope.statusFilter.status},$scope.isSelectedHorizontal=function(e){var t=!1;if(null!=$scope.suggestionDet.suggestionHorizontalDept&&0<$scope.suggestionDet.suggestionHorizontalDept.length)for(var s=0;s<$scope.suggestionDet.suggestionHorizontalDept.length;s++)if($scope.suggestionDet.suggestionHorizontalDept[s].deptId==e){t=!0;break}return t},$scope.getDepartmentList=function(e){$scope.departmentList=[],b.httpGet("getdepartmentlistbybranchid/"+e).then(function(e){$scope.departmentList=[],$scope.departmentList.push({deptName:"All"});for(var t=0;t<e.deptList.length;t++)$scope.departmentList.push(e.deptList[t]);if(0<$scope.departmentList.length)for(var s=0;s<$scope.departmentList.length;s++)$scope.departmentList[s].isselect=!1;if($scope.suggDetailModel.deptFilter=$scope.departmentList[0],null!=$scope.suggestionDet.sugesstionStatusAudit&&0<$scope.suggestionDet.sugesstionStatusAudit.length)for(let e=0;e<$scope.suggestionDet.sugesstionStatusAudit.length;e++)"PENDING"!=$scope.suggestionDet.sugesstionStatusAudit[e].actionStatus&&$scope.suggestionDet.sugesstionStatusAudit[e].status_master.status==$scope.CONST.STATUS.Implemented.status||$scope.suggestionDet.sugesstionStatusAudit[e].status_master.status==$scope.CONST.STATUS.ImplementationRequestAccepted.status||$scope.isHdDeptBeforeCheck()})},$scope.getCategoryList=function(e){b.httpGet("getcategorylistbyorgid/0/"+e).then(function(e){$scope.catagoryList=[],$scope.catagoryList.push({categoryName:"All"}),$scope.catagoryList.push({catId:0,categoryName:"Tier-1",processType:"Tier-1"},{catId:0,categoryName:"Tier-2",processType:"Tier-2"});for(var t=0;t<e.catagoryList.length;t++)$scope.catagoryList.push(e.catagoryList[t]);$scope.suggDetailModel.catFilter=$scope.catagoryList[0],$scope.listFilter.catagoryList=angular.copy($scope.catagoryList)})},$scope.expandCollapse=function(e){angular.element("#collapseContent"+e).hasClass("closeCollapseTab")?($("#collapseContent"+e).removeClass("closeCollapseTab"),$("#btnExpColllapse"+e).removeClass("fa-angle-down"),$("#btnExpColllapse"+e).addClass("fa-angle-up")):($("#collapseContent"+e).addClass("closeCollapseTab"),$("#btnExpColllapse"+e).removeClass("fa-angle-up"),$("#btnExpColllapse"+e).addClass("fa-angle-down"))},$scope.setTab=function(e){$scope.tab=e},$scope.isSet=function(e){return $scope.tab===e},$scope.implTab=1,$scope.setImplTab=function(e){$scope.implTab=e},$scope.isImplSet=function(e){return $scope.implTab===e},$scope.implData={},$scope.changeonhold=function(){""==$scope.implData.onHoldImplSummary?$scope.flaghold=!0:$scope.flaghold=!1},$scope.cancelsugg=function(){""==$scope.implData.rejectionReason?$scope.flagcancelsugg=!0:$scope.flagcancelsugg=!1},$scope.savesuggestionHorizontalDate=function(e){$scope.submitSpinner=!0,null==e.targetDate||""==e.targetDate||null==e.targetDate?(C.create($filter("translate")("Please_enter_target_date"),5e3,"error"),$scope.submitSpinner=!1):b.httpPost({targetDate:e.targetDate,id:e.id},"updateHdTargetDate").then(function(e){$scope.submitSpinner=!1,e.result?($scope.suggestionDet={},$scope.getSuggestionDetails($scope.selectedSuggId),C.create($filter("translate")("Target_date_saved_successfully"),5e3,"success")):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")})},$scope.suggestionHorizontalImpl=function(){for(var e={sugId:$scope.selectedSuggId,suggestionHorizontalDept:[],statusId:$scope.CONST.STATUS.AssignedToImplementorForHorizantalDeployement.statusId,branchId:$scope.suggestionDet.branch.branchId,orgId:E.empDetails.organization.orgId},t=0;t<$scope.suggestionDet.suggestionHorizontalDept.length;t++)if($scope.suggestionDet.suggestionHorizontalDept[t].isselect&&"PENDING"==$scope.suggestionDet.suggestionHorizontalDept[t].actionStatus){if(!$scope.suggestionDet.suggestionHorizontalDept[t].istarget)return void C.create($filter("translate")("Please_capture_target_date"),5e3,"error");e.suggestionHorizontalDept.push({id:$scope.suggestionDet.suggestionHorizontalDept[t].id})}if(0==e.suggestionHorizontalDept.length)return $scope.checkForHdConfig()?void C.create($filter("translate")("Please_select_implemented_department_cell"),5e3,"error"):void C.create($filter("translate")("Please_select_implemented_circle"),5e3,"error");null!=e.suggestionHorizontalDept&&0<e.suggestionHorizontalDept.length&&($scope.uploadAttachmentModalSpinner=!0,b.httpPost(e,"implementHorizantalDeploymentProcess").then(function(e){$scope.uploadAttachmentModalSpinner=!1,e.result?($scope.suggestionDet={},e.statusId==$scope.CONST.STATUS.AssignedToImplementorForHorizantalDeployement.statusId?$scope.getSuggestionDetails($scope.selectedSuggId):(e.statusId==$scope.CONST.STATUS.Implemented.statusId?($("#assignedHDImplModal").modal("hide"),$scope.suggestionDetInput={},$scope.getsuggestionList("onUpdate")):($("#assignedHDImplModal").modal("hide"),$scope.suggestionDetInput={},$scope.getsuggestionList("onLoad")),$scope.getStatusWiseCount()),e.statusId==$scope.CONST.STATUS.AssignedForSustainanceCheck.statusId?C.create($filter("translate")("Suggestion_assigned_for_sustainance_check_successfully"),3e3,"success"):C.create($filter("translate")("Suggestion_implemented_successfully"),3e3,"success")):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")}))},$scope.suggestionImplemented=function(t){for(var s=new FormData($("#upload-file-form")[0]),i=0,a=0;a<$scope.suggestionDet.implTeamList.length;a++)$scope.suggestionDet.implTeamList[a].statusAuditId==$scope.implAssignedStatusAdtId&&(i=$scope.suggestionDet.implTeamList[a].sugTrackId);let e;if(e=Array.isArray($scope.implData)?$scope.implData[$scope.implData.length-1]:$scope.implData,!$scope.suggestionDet.implfinanceflow||$scope.CONST.STATUS.Implemented.statusId!=t||null!=e.implementedCost&&0!=e.implementedCost||null!=e.costEffective&&0!=e.costEffective){let e;if(e=Array.isArray($scope.suggestionDet.implTeamList)?$scope.suggestionDet.implTeamList[$scope.suggestionDet.implTeamList.length-1]:$scope.suggestionDet.implTeamList,$scope.CONST.STATUS.AssignedForFCVerification.statusId!=t||null!=e.implementedCost&&0!=e.implementedCost||null!=e.costEffective&&0!=e.costEffective)if($scope.CONST.STATUS.Implemented.statusId!=t||!$scope.suggestionDet.implfinanceflow||null!=$scope.suggestionDet.implfc&&null!=$scope.suggestionDet.implfc)if(1==$scope.implTab&&"Y"==$scope.suggFlowConfig.isImplParticularsEnbld&&$scope.CONST.STATUS.Implemented.statusId==t&&1==E.empDetails.productOrgConfigDet.isPraticularsMandatory&&0==$filter("filter")($scope.particulars,{isChecked:!0}).length)C.create($filter("translate")("Other_bebefits_is_mandatory"),5e3,"error");else{var n=[];if(null!=$scope.benefitList&&0<$scope.benefitList.length)for(var l=0;l<$scope.benefitList.length;l++)$scope.benefitList[l].hasOwnProperty("isBenefitChecked")&&$scope.benefitList[l].isBenefitChecked&&n.push($scope.benefitList[l].benfitId);if(1!=$scope.implTab||1!=E.empDetails.productOrgConfigDet.isBenefitsMandatory||$scope.CONST.STATUS.Implemented.statusId!=t||"Y"!=$scope.suggFlowConfig.isBenefitsEnbld||null!=n&&0!=n.length){if(null!=n&&0<n.length){var o=0;for(a in n)s.append("benefitIds["+o+"]",n[a]),o++}if(1!=$scope.implTab||"Y"!=$scope.suggFlowConfig.isImplParticularsEnbld||"Y"!=$scope.suggFlowConfig.kaizenCheckReqImpl||1!=E.empDetails.productOrgConfigDet.isSusAuditRequired||$scope.CONST.STATUS.Implemented.statusId!=t||"Y"!=$scope.suggestionDet.category.isSusAuditRequired||null!=$scope.suggestionDet.implSustenanceflow&&null!=$scope.suggestionDet.implSustenanceflow&&$scope.suggestionDet.implSustenanceflow){$scope.uploadAttachmentModalSpinner=!0,s.append("branchId",$scope.suggestionDet.branch.branchId),s.append("statusId",t),s.append("teamTypeId",$scope.CONST.TEAM_TYPE.IMPLEMENTATION),s.append("sugId",$scope.selectedSuggId),"HD"!=$scope.suggestionDet.sourceType&&"GUEST_SUGGESTION"!=$scope.suggestionDet.sourceType&&s.append("empId",$scope.suggestionDet.emp_details.empId),s.append("docUpdateStatus",!1);var r=[];if($scope.suggestionDet.implfinanceflow&&(r.push(parseInt($scope.suggestionDet.implfc.empId)),s.append("fcIds",r)),$scope.CONST.STATUS.AssignedForFCVerification.statusId==t){for(var g=0,a=0;a<$scope.suggestionDet.sugesstionStatusAudit.length;a++)if($scope.suggestionDet.sugesstionStatusAudit[a].status_master.status==$scope.CONST.STATUS.ImplementationRequestAccepted.status){g=$scope.suggestionDet.sugesstionStatusAudit[a].emp_details.empId;break}s.append("implementedbyId",g),s.append("updatedBy",g),null!=$scope.suggestionInputDetails.fcvarifycomment&&null!=$scope.suggestionInputDetails.fcvarifycomment&&""!=$scope.suggestionInputDetails.fcvarifycomment&&s.append("fvComment",$scope.suggestionInputDetails.fcvarifycomment);for(a=0;a<$scope.suggestionDet.sugesstionStatusAudit.length;a++)$scope.suggestionDet.sugesstionStatusAudit[a].status_master.status==$scope.CONST.STATUS.UnderFinanceVerification.status&&"PENDING"==$scope.suggestionDet.sugesstionStatusAudit[a].actionStatus&&s.append("stsAuditId",$scope.suggestionDet.sugesstionStatusAudit[a].stsadtId);s.append("implementedCost",$scope.suggestionDet.implTeamList[0].implementedCost),s.append("costEffective",$scope.suggestionDet.implTeamList[0].costEffective),s.append("suggtrackId",parseInt(i))}else{for(g=0,a=0;a<$scope.suggestionDet.sugesstionStatusAudit.length;a++)if($scope.suggestionDet.sugesstionStatusAudit[a].status_master.status==$scope.CONST.STATUS.ImplementationRequestAccepted.status){g=$scope.suggestionDet.sugesstionStatusAudit[a].emp_details.empId;break}s.append("implementedbyId",g),s.append("updatedBy",g)}for(a in $scope.implFiles)s.append("sugImg",$scope.implFiles[a]);if(1==$scope.implTab&&$scope.CONST.STATUS.AssignedForFCVerification.statusId!=t){if($scope.suggestionDet.ehsbenefit){if(null==$scope.implData.safetImplactionSummary&&null==$scope.implData.safetImplactionSummary)return C.create($filter("translate")("EHS Benefit comment is mandatory"),5e3,"error"),void($scope.uploadAttachmentModalSpinner=!1);s.append("safetyImplemention",$scope.implData.safetImplactionSummary),s.append("EHSBenefit","Yes")}else s.append("EHSBenefit","No");s.append("summary",$scope.implData.implSummary),"Y"==$scope.suggFlowConfig.isImplActionEnbld&&s.append("implementationAction",$scope.implData.implactionSummary),s.append("implementedCost",$scope.implData.implementedCost),s.append("costEffective",$scope.implData.costEffective),s.append("suggtrackId",parseInt(i));var u=[];if(null!=$scope.selectedEmpList&&0<$scope.selectedEmpList.length)for(a=0;a<$scope.selectedEmpList.length;a++)1==$scope.selectedEmpList[a].isSelected&&u.push($scope.selectedEmpList[a].empId);if(null!=u&&0<u.length)for(var a in u)s.append("empIds["+a+"]",u[a]);var d=0;if(null!=$scope.suggestionDet.dept&&"HD"!=$scope.suggestionDet.sourceType){for(var c=0;c<$scope.departmentList.length;c++)if(null!=$scope.departmentList[c].lineFound&&null!=$scope.departmentList[c].lineList&&0<$scope.departmentList[c].lineList.length)for(var p=0;p<$scope.departmentList[c].lineList.length;p++){var m=!1;if(null!=$scope.suggestionDet.suggestionHorizontalDept)for(var D=0;D<$scope.suggestionDet.suggestionHorizontalDept.length;D++)$scope.departmentList[c].deptId==$scope.suggestionDet.suggestionHorizontalDept[D].deptId&&$scope.departmentList[c].lineList[p].lineId==$scope.suggestionDet.suggestionHorizontalDept[D].lineId&&(m=!0);!m&&$scope.departmentList[c].lineList[p].isImplselect&&"All"!=$scope.departmentList[c].lineList[p].name&&(s.append("suggestionHorizontalDept["+d+"].lineId",$scope.departmentList[c].lineList[p].lineId),s.append("suggestionHorizontalDept["+d+"].deptId",$scope.departmentList[c].deptId),s.append("suggestionHorizontalDept["+d+"].suggestionDet.sugId",$scope.suggestionDet.sugId),s.append("suggestionHorizontalDept["+d+"].isAdd",1),s.append("suggestionHorizontalDept["+d+"].isDelete",0),d++)}else{var f=!1;if(null!=$scope.suggestionDet.suggestionHorizontalDept)for(D=0;D<$scope.suggestionDet.suggestionHorizontalDept.length;D++)$scope.departmentList[c].deptId==$scope.suggestionDet.suggestionHorizontalDept[D].deptId&&0==$scope.suggestionDet.suggestionHorizontalDept[D].lineId&&(f=!0);!f&&$scope.departmentList[c].isImplselect&&"All"!=$scope.departmentList[c].deptName&&(s.append("suggestionHorizontalDept["+d+"].deptId",$scope.departmentList[c].deptId),s.append("suggestionHorizontalDept["+d+"].suggestionDet.sugId",$scope.suggestionDet.sugId),s.append("suggestionHorizontalDept["+d+"].isAdd",1),s.append("suggestionHorizontalDept["+d+"].isDelete",0),d++)}if(null!=$scope.suggestionDet.suggestionHorizontalDept)for(var h=0;h<$scope.departmentList.length;h++)if(0==$scope.departmentList[h].isImplselect)for(D=0;D<$scope.suggestionDet.suggestionHorizontalDept.length;D++)$scope.suggestionDet.suggestionHorizontalDept[D].deptId==$scope.departmentList[h].deptId&&0<$scope.suggestionDet.suggestionHorizontalDept[D].deptId&&0<$scope.suggestionDet.suggestionHorizontalDept[D].lineId&&0<$scope.suggestionDet.suggestionHorizontalDept[D].id&&(s.append("suggestionHorizontalDept["+d+"].id",$scope.suggestionDet.suggestionHorizontalDept[D].id),s.append("suggestionHorizontalDept["+d+"].lineId",$scope.suggestionDet.suggestionHorizontalDept[D].lineId),s.append("suggestionHorizontalDept["+d+"].deptId",$scope.suggestionDet.suggestionHorizontalDept[D].deptId),s.append("suggestionHorizontalDept["+d+"].suggestionDet.sugId",$scope.suggestionDet.sugId),s.append("suggestionHorizontalDept["+d+"].isAdd",0),s.append("suggestionHorizontalDept["+d+"].isDelete",1),d++);if(null!=$scope.suggestionDet.suggestionHorizontalDept)for(D=0;D<$scope.suggestionDet.suggestionHorizontalDept.length;D++){if(0<$scope.suggestionDet.suggestionHorizontalDept[D].lineId){for(var I=!1,c=0;c<$scope.departmentList.length;c++)if(null!=$scope.departmentList[c].lineFound&&null!=$scope.departmentList[c].lineList)for(p=0;p<$scope.departmentList[c].lineList.length;p++)$scope.departmentList[c].deptId!=$scope.suggestionDet.suggestionHorizontalDept[D].deptId||$scope.departmentList[c].lineList[p].lineId!=$scope.suggestionDet.suggestionHorizontalDept[D].lineId||$scope.departmentList[c].lineList[p].isImplselect||(I=!0)}else for(I=!1,c=0;c<$scope.departmentList.length;c++)$scope.departmentList[c].deptId!=$scope.suggestionDet.suggestionHorizontalDept[D].deptId||0!=$scope.suggestionDet.suggestionHorizontalDept[D].lineId||$scope.departmentList[c].isImplselect||(I=!0);I&&(s.append("suggestionHorizontalDept["+d+"].id",$scope.suggestionDet.suggestionHorizontalDept[D].id),s.append("suggestionHorizontalDept["+d+"].deptId",$scope.suggestionDet.suggestionHorizontalDept[D].deptId),s.append("suggestionHorizontalDept["+d+"].suggestionDet.sugId",$scope.suggestionDet.sugId),s.append("suggestionHorizontalDept["+d+"].isAdd",0),s.append("suggestionHorizontalDept["+d+"].isDelete",1),d++)}for(a=0;a<$scope.departmentList.length;a++)if($scope.departmentList[a].isImplselect&&$scope.departmentList[a].lineFound)for(h=0;h<$scope.departmentList[a].lineList.length;h++)if(0==$filter("filter")($scope.departmentList[a].lineList,{isImplselect:!0}).length)return $scope.uploadAttachmentModalSpinner=!1,$scope.onHoldImplementationSpinner=!0,$scope.cancleImplementationSpinner=!1,void C.create($filter("translate")("Please_select_line_horizontal_deployment"),6e3,"error")}if(null!=$scope.suggestionDet.circle&&"HD"!=$scope.suggestionDet.sourceType&&null!=$scope.implMachineHDList&&0<$scope.implMachineHDList.length)for(p=0;p<$scope.implMachineHDList.length;p++){$scope.implMachineHDList[p].machineFound=!1;for(let e=0;e<$scope.suggestionDet.suggestionHorizontalDept.length;e++)$scope.suggestionDet.suggestionHorizontalDept[e].operationId==$scope.implMachineHDList[p].operation.id&&($scope.implMachineHDList[p].machineFound=!0);$scope.implMachineHDList[p].machineFound||(null!=$scope.implMachineHDList[p].machine&&null!=$scope.implMachineHDList[p].machine?s.append("suggestionHorizontalDept["+d+"].machineId",$scope.implMachineHDList[p].machine.id):s.append("suggestionHorizontalDept["+d+"].machineId",0),s.append("suggestionHorizontalDept["+d+"].circleId",$scope.implMachineHDList[p].circle.id),s.append("suggestionHorizontalDept["+d+"].productId",$scope.implMachineHDList[p].product.id),s.append("suggestionHorizontalDept["+d+"].stageId",$scope.implMachineHDList[p].stage.id),s.append("suggestionHorizontalDept["+d+"].productNoId",$scope.implMachineHDList[p].productNo.id),s.append("suggestionHorizontalDept["+d+"].operationId",$scope.implMachineHDList[p].operation.id),s.append("suggestionHorizontalDept["+d+"].suggestionDet.sugId",$scope.suggestionDet.sugId),s.append("suggestionHorizontalDept["+d+"].isAdd",1),s.append("suggestionHorizontalDept["+d+"].isDelete",0),d++)}if(null!=$scope.suggestionDet.circle&&"HD"!=$scope.suggestionDet.sourceType&&null!=$scope.implMachineHDList&&0<$scope.implMachineHDList.length)for(let e=0;e<$scope.suggestionDet.suggestionHorizontalDept.length;e++){$scope.suggestionDet.suggestionHorizontalDept[e].isMachineDelete=!1;for(p=0;p<$scope.implMachineHDList.length;p++)$scope.suggestionDet.suggestionHorizontalDept[e].operationId==$scope.implMachineHDList[p].operation.id&&($scope.suggestionDet.suggestionHorizontalDept[e].isMachineDelete=!0);!$scope.suggestionDet.suggestionHorizontalDept[e].isMachineDelete&&0<$scope.suggestionDet.suggestionHorizontalDept[e].operationId&&(s.append("suggestionHorizontalDept["+d+"].id",$scope.suggestionDet.suggestionHorizontalDept[e].id),s.append("suggestionHorizontalDept["+d+"].machineId",$scope.suggestionDet.suggestionHorizontalDept[e].machineId),s.append("suggestionHorizontalDept["+d+"].circleId",$scope.suggestionDet.suggestionHorizontalDept[e].circleId),s.append("suggestionHorizontalDept["+d+"].productId",$scope.suggestionDet.suggestionHorizontalDept[e].productId),s.append("suggestionHorizontalDept["+d+"].productNoId",$scope.suggestionDet.suggestionHorizontalDept[e].productNoId),s.append("suggestionHorizontalDept["+d+"].operationId",$scope.suggestionDet.suggestionHorizontalDept[e].operationId),s.append("suggestionHorizontalDept["+d+"].stageId",$scope.suggestionDet.suggestionHorizontalDept[e].stageId),s.append("suggestionHorizontalDept["+d+"].suggestionDet.sugId",$scope.suggestionDet.sugId),s.append("suggestionHorizontalDept["+d+"].isAdd",0),s.append("suggestionHorizontalDept["+d+"].isDelete",1),d++)}if(null!=$scope.parentSuggType){if(0!=$scope.parentSuggType.deptId&&"HD"==$scope.suggestionDet.sourceType){for(c=0;c<$scope.departmentList.length;c++)if(null!=$scope.departmentList[c].lineFound&&null!=$scope.departmentList[c].lineList&&0<$scope.departmentList[c].lineList.length)for(p=0;p<$scope.departmentList[c].lineList.length;p++){m=!1;if(null!=$scope.suggestionDet.suggestionHorizontalDept)for(D=0;D<$scope.suggestionDet.suggestionHorizontalDept.length;D++)$scope.departmentList[c].deptId==$scope.suggestionDet.suggestionHorizontalDept[D].deptId&&$scope.departmentList[c].lineList[p].lineId==$scope.suggestionDet.suggestionHorizontalDept[D].lineId&&(m=!0);!m&&$scope.departmentList[c].lineList[p].isImplselect&&"All"!=$scope.departmentList[c].lineList[p].name&&(s.append("suggestionHorizontalDept["+d+"].lineId",$scope.departmentList[c].lineList[p].lineId),s.append("suggestionHorizontalDept["+d+"].deptId",$scope.departmentList[c].deptId),s.append("suggestionHorizontalDept["+d+"].suggestionDet.sugId",$scope.suggestionDet.sugId),s.append("suggestionHorizontalDept["+d+"].isAdd",1),s.append("suggestionHorizontalDept["+d+"].isDelete",0),d++)}else{f=!1;if(null!=$scope.suggestionDet.suggestionHorizontalDept)for(D=0;D<$scope.suggestionDet.suggestionHorizontalDept.length;D++)$scope.departmentList[c].deptId==$scope.suggestionDet.suggestionHorizontalDept[D].deptId&&0==$scope.suggestionDet.suggestionHorizontalDept[D].lineId&&(f=!0);!f&&$scope.departmentList[c].isImplselect&&"All"!=$scope.departmentList[c].deptName&&(s.append("suggestionHorizontalDept["+d+"].deptId",$scope.departmentList[c].deptId),s.append("suggestionHorizontalDept["+d+"].suggestionDet.sugId",$scope.suggestionDet.sugId),s.append("suggestionHorizontalDept["+d+"].isAdd",1),s.append("suggestionHorizontalDept["+d+"].isDelete",0),d++)}if(null!=$scope.suggestionDet.suggestionHorizontalDept)for(h=0;h<$scope.departmentList.length;h++)if(0==$scope.departmentList[h].isImplselect)for(D=0;D<$scope.suggestionDet.suggestionHorizontalDept.length;D++)$scope.suggestionDet.suggestionHorizontalDept[D].deptId==$scope.departmentList[h].deptId&&0<$scope.suggestionDet.suggestionHorizontalDept[D].deptId&&0<$scope.suggestionDet.suggestionHorizontalDept[D].lineId&&0<$scope.suggestionDet.suggestionHorizontalDept[D].id&&(s.append("suggestionHorizontalDept["+d+"].id",$scope.suggestionDet.suggestionHorizontalDept[D].id),s.append("suggestionHorizontalDept["+d+"].lineId",$scope.suggestionDet.suggestionHorizontalDept[D].lineId),s.append("suggestionHorizontalDept["+d+"].deptId",$scope.suggestionDet.suggestionHorizontalDept[D].deptId),s.append("suggestionHorizontalDept["+d+"].suggestionDet.sugId",$scope.suggestionDet.sugId),s.append("suggestionHorizontalDept["+d+"].isAdd",0),s.append("suggestionHorizontalDept["+d+"].isDelete",1),d++);if(null!=$scope.suggestionDet.suggestionHorizontalDept)for(D=0;D<$scope.suggestionDet.suggestionHorizontalDept.length;D++){if(0<$scope.suggestionDet.suggestionHorizontalDept[D].lineId){for(I=!1,c=0;c<$scope.departmentList.length;c++)if(null!=$scope.departmentList[c].lineFound&&null!=$scope.departmentList[c].lineList)for(p=0;p<$scope.departmentList[c].lineList.length;p++)$scope.departmentList[c].deptId!=$scope.suggestionDet.suggestionHorizontalDept[D].deptId||$scope.departmentList[c].lineList[p].lineId!=$scope.suggestionDet.suggestionHorizontalDept[D].lineId||$scope.departmentList[c].lineList[p].isImplselect||(I=!0)}else for(I=!1,c=0;c<$scope.departmentList.length;c++)$scope.departmentList[c].deptId!=$scope.suggestionDet.suggestionHorizontalDept[D].deptId||0!=$scope.suggestionDet.suggestionHorizontalDept[D].lineId||$scope.departmentList[c].isImplselect||(I=!0);I&&(s.append("suggestionHorizontalDept["+d+"].id",$scope.suggestionDet.suggestionHorizontalDept[D].id),s.append("suggestionHorizontalDept["+d+"].deptId",$scope.suggestionDet.suggestionHorizontalDept[D].deptId),s.append("suggestionHorizontalDept["+d+"].suggestionDet.sugId",$scope.suggestionDet.sugId),s.append("suggestionHorizontalDept["+d+"].isAdd",0),s.append("suggestionHorizontalDept["+d+"].isDelete",1),d++)}for(a=0;a<$scope.departmentList.length;a++)if($scope.departmentList[a].isImplselect&&$scope.departmentList[a].lineFound)for(h=0;h<$scope.departmentList[a].lineList.length;h++)if(0==$filter("filter")($scope.departmentList[a].lineList,{isImplselect:!0}).length)return $scope.uploadAttachmentModalSpinner=!1,$scope.onHoldImplementationSpinner=!0,$scope.cancleImplementationSpinner=!1,void C.create($filter("translate")("Please_select_line_horizontal_deployment"),6e3,"error")}if(0!=$scope.parentSuggType.circleId&&"HD"==$scope.suggestionDet.sourceType&&null!=$scope.implMachineHDList&&0<$scope.implMachineHDList.length)for(p=0;p<$scope.implMachineHDList.length;p++){$scope.implMachineHDList[p].machineFound=!1;for(let e=0;e<$scope.suggestionDet.suggestionHorizontalDept.length;e++)$scope.suggestionDet.suggestionHorizontalDept[e].operationId==$scope.implMachineHDList[p].operation.id&&($scope.implMachineHDList[p].machineFound=!0);$scope.implMachineHDList[p].machineFound||(null!=$scope.implMachineHDList[p].machine&&null!=$scope.implMachineHDList[p].machine?s.append("suggestionHorizontalDept["+d+"].machineId",$scope.implMachineHDList[p].machine.id):s.append("suggestionHorizontalDept["+d+"].machineId",0),s.append("suggestionHorizontalDept["+d+"].circleId",$scope.implMachineHDList[p].circle.id),s.append("suggestionHorizontalDept["+d+"].productId",$scope.implMachineHDList[p].product.id),s.append("suggestionHorizontalDept["+d+"].stageId",$scope.implMachineHDList[p].stage.id),s.append("suggestionHorizontalDept["+d+"].productNoId",$scope.implMachineHDList[p].productNo.id),s.append("suggestionHorizontalDept["+d+"].operationId",$scope.implMachineHDList[p].operation.id),s.append("suggestionHorizontalDept["+d+"].suggestionDet.sugId",$scope.suggestionDet.sugId),s.append("suggestionHorizontalDept["+d+"].isAdd",1),s.append("suggestionHorizontalDept["+d+"].isDelete",0),d++)}if(0!=$scope.parentSuggType.circleId&&"HD"==$scope.suggestionDet.sourceType&&null!=$scope.implMachineHDList&&0<$scope.implMachineHDList.length)for(let e=0;e<$scope.suggestionDet.suggestionHorizontalDept.length;e++){$scope.suggestionDet.suggestionHorizontalDept[e].isMachineDelete=!1;for(p=0;p<$scope.implMachineHDList.length;p++)$scope.suggestionDet.suggestionHorizontalDept[e].operationId==$scope.implMachineHDList[p].operation.id&&($scope.suggestionDet.suggestionHorizontalDept[e].isMachineDelete=!0);!$scope.suggestionDet.suggestionHorizontalDept[e].isMachineDelete&&0<$scope.suggestionDet.suggestionHorizontalDept[e].operationId&&(s.append("suggestionHorizontalDept["+d+"].id",$scope.suggestionDet.suggestionHorizontalDept[e].id),s.append("suggestionHorizontalDept["+d+"].machineId",$scope.suggestionDet.suggestionHorizontalDept[e].machineId),s.append("suggestionHorizontalDept["+d+"].circleId",$scope.suggestionDet.suggestionHorizontalDept[e].circleId),s.append("suggestionHorizontalDept["+d+"].productId",$scope.suggestionDet.suggestionHorizontalDept[e].productId),s.append("suggestionHorizontalDept["+d+"].productNoId",$scope.suggestionDet.suggestionHorizontalDept[e].productNoId),s.append("suggestionHorizontalDept["+d+"].operationId",$scope.suggestionDet.suggestionHorizontalDept[e].operationId),s.append("suggestionHorizontalDept["+d+"].stageId",$scope.suggestionDet.suggestionHorizontalDept[e].stageId),s.append("suggestionHorizontalDept["+d+"].suggestionDet.sugId",$scope.suggestionDet.sugId),s.append("suggestionHorizontalDept["+d+"].isAdd",0),s.append("suggestionHorizontalDept["+d+"].isDelete",1),d++)}}if(null!=$scope.particulars&&0<$scope.particulars.length){var y=[],S=$filter("filter")($scope.particulars,{isChecked:!0});if(1<S.length)return C.create($filter("translate")("implementer_Can_select_only_one_benefit"),5e3,"error"),$scope.uploadAttachmentModalSpinner=!1,$scope.onHoldImplementationSpinner=!0,void($scope.cancleImplementationSpinner=!1);for(let e=0;e<S.length;e++)if(S[e].tangible){var L=S[e];if(L.hasOwnProperty("newUnit")&&L.hasOwnProperty("newValue")&&(null==L.newUnit||""==L.newUnit||$scope.isEmpty(L.newUnit)||null==L.newValue||""==L.newValue))return C.create($filter("translate")("Please_enter_value_and_unit_for_tangible_benefit"),5e3,"error"),$scope.uploadAttachmentModalSpinner=!1,$scope.onHoldImplementationSpinner=!0,void($scope.cancleImplementationSpinner=!1)}for(var v,a=0;a<S.length;a++)null!=$scope.suggestionDet.customEvaluationParticularsList&&0<$scope.suggestionDet.customEvaluationParticularsList.length?0==$filter("filter")($scope.suggestionDet.customEvaluationParticularsList,{particular:{id:S[a].id}}).length?(v={id:0,createdById:$scope.loggedInEmpId,updatedById:0,points:S[a].points,particular:S[a].id,suggestion:$scope.suggestionDet.sugId,stsId:$scope.CONST.STATUS.ImplementationRequestAccepted.statusId,isActive:"Y",action:"ADD",recommendedBy:$scope.loggedInEmpId,roleId:9,catId:$scope.suggestionDet.selectedEvalCatId,tangible:S[a].tangible},S[a].tangible&&(v.unit=S[a].newUnit.unit,v.masterUnit={id:S[a].newUnit.id},v.value=S[a].newValue,v.frequency=S[a].implFrequency?S[a].implFrequency.value:S[a].frequency,v.existingValue=S[a].implExistingValue),y.push(v)):0<$filter("filter")($scope.suggestionDet.customEvaluationParticularsList,{particular:{id:S[a].id}}).length&&(S[a].tangible?S[a].hasOwnProperty("newUnit")&&S[a].hasOwnProperty("newValue")&&(S[a].unit=S[a].newUnit,S[a].value=S[a].newValue,S[a].frequency=S[a].implFrequency?S[a].implFrequency.value:S[a].frequency,S[a].existingValue=S[a].implExistingValue,$scope.checkBenefitsValue(S[a]))&&(v={id:S[a].selectedId,createdById:$scope.loggedInEmpId,updatedById:$scope.loggedInEmpId,points:S[a].points,particular:S[a].id,suggestion:$scope.suggestionDet.sugId,stsId:$scope.CONST.STATUS.ImplementationRequestAccepted.statusId,isActive:"Y",action:"UPDATE",recommendedBy:$scope.loggedInEmpId,roleId:9,tangible:S[a].tangible,unit:S[a].unit.unit,masterUnit:{id:S[a].unit.id},value:S[a].value,frequency:S[a].frequency,existingValue:S[a].existingValue},y.push(v)):(v={id:S[a].selectedId,createdById:$scope.loggedInEmpId,updatedById:$scope.loggedInEmpId,points:S[a].points,particular:S[a].id,suggestion:$scope.suggestionDet.sugId,stsId:$scope.CONST.STATUS.ImplementationRequestAccepted.statusId,isActive:"Y",action:"UPDATE",recommendedBy:$scope.loggedInEmpId,roleId:9,tangible:S[a].tangible},y.push(v))):(v={id:0,createdById:$scope.loggedInEmpId,updatedById:0,points:S[a].points,particular:S[a].id,suggestion:$scope.suggestionDet.sugId,stsId:$scope.CONST.STATUS.ImplementationRequestAccepted.statusId,isActive:"Y",action:"ADD",catId:$scope.suggestionDet.selectedEvalCatId,recommendedBy:$scope.loggedInEmpId,roleId:9,tangible:S[a].tangible},S[a].tangible&&(v.unit=S[a].newUnit.unit,v.masterUnit={id:S[a].newUnit.id},v.value=S[a].newValue,v.frequency=S[a].frequency,v.existingValue=S[a].implExistingValue),y.push(v));if(null!=$scope.suggestionDet.customEvaluationParticularsList&&0<$scope.suggestionDet.customEvaluationParticularsList.length)for(h=0;h<$scope.suggestionDet.customEvaluationParticularsList.length;h++){var T=$scope.suggestionDet.customEvaluationParticularsList[h].particular;0==$filter("filter")(S,{id:T.id}).length&&y.push({id:$scope.suggestionDet.customEvaluationParticularsList[h].id,updatedById:$scope.loggedInEmpId,isActive:"N",action:"DELETE",recommendedBy:$scope.loggedInEmpId,roleId:9})}for(c=0;c<y.length;c++)s.append("suggParticulars["+c+"].id",y[c].id),s.append("suggParticulars["+c+"].action",y[c].action),s.append("suggParticulars["+c+"].recommendedBy",y[c].recommendedBy),"ADD"==y[c].action&&s.append("suggParticulars["+c+"].catId",y[c].catId),s.append("suggParticulars["+c+"].roleId",y[c].roleId),"Y"==y[c].isActive&&(s.append("suggParticulars["+c+"].createdById",y[c].createdById),s.append("suggParticulars["+c+"].updatedById",y[c].updatedById),s.append("suggParticulars["+c+"].particular.id",y[c].particular),s.append("suggParticulars["+c+"].suggestion.sugId",y[c].suggestion),s.append("suggParticulars["+c+"].stsId",y[c].stsId),s.append("suggParticulars["+c+"].tangible",y[c].tangible),y[c].tangible)&&(s.append("suggParticulars["+c+"].unit",y[c].unit),s.append("suggParticulars["+c+"].masterUnit.id",y[c].masterUnit.id),s.append("suggParticulars["+c+"].value",y[c].value),s.append("suggParticulars["+c+"].masterUnit.id",y[c].masterUnit.id),s.append("suggParticulars["+c+"].frequency",y[c].frequency),y[c].existingValue)&&0<y[c].existingValue&&s.append("suggParticulars["+c+"].existingValue",y[c].existingValue),s.append("suggParticulars["+c+"].isActive",y[c].isActive)}if("HD"!=$scope.suggestionDet.sourceType&&"GUEST_SUGGESTION"!=$scope.suggestionDet.sourceType&&"Y"===$scope.suggFlowConfig.isFinVerifEnbld&&1==E.empDetails.productOrgConfigDet.isThemeCostMandate&&"Y"==$scope.suggestionDet.category.isFCVRequired&&(null==$scope.suggestionDet.implfc||null==$scope.suggestionDet.implfc||!$scope.suggestionDet.implfinanceflow))return C.create($filter("translate")("Finance_verification_is_require"),6e3,"error"),$scope.uploadAttachmentModalSpinner=!1,$scope.onHoldImplementationSpinner=!0,void($scope.cancleImplementationSpinner=!1);if(""==$scope.implFiles&&1==E.empDetails.productOrgConfigDet.isBeforeUploadImageOn&&""==$scope.implBeforFiles)return C.create($filter("translate")("Please_select_image"),3e3,"error"),$scope.uploadAttachmentModalSpinner=!1,$scope.onHoldImplementationSpinner=!0,void($scope.cancleImplementationSpinner=!1);if($scope.checkForHdConfig()&&(null==$scope.implData.implSummary||null==$scope.implData.implSummary||""==$scope.implData.implSummary))return C.create($filter("translate")("Please_enter_result"),6e3,"error"),$scope.uploadAttachmentModalSpinner=!1,$scope.onHoldImplementationSpinner=!0,void($scope.cancleImplementationSpinner=!1);if((null==$scope.implData.implactionSummary||null==$scope.implData.implactionSummary||""==$scope.implData.implactionSummary)&&"Y"==$scope.suggFlowConfig.isImplActionEnbld)return C.create($filter("translate")("Please_enter_implementation_action"),6e3,"error"),$scope.uploadAttachmentModalSpinner=!1,$scope.onHoldImplementationSpinner=!0,void($scope.cancleImplementationSpinner=!1);if(null==u||""==u)return C.create($filter("translate")("Please_select_team_members"),6e3,"error"),$scope.uploadAttachmentModalSpinner=!1,$scope.onHoldImplementationSpinner=!0,void($scope.cancleImplementationSpinner=!1);if(null!=$scope.whyWhyAnalysisforImpl){for(c=0;c<$scope.whyWhyAnalysisforImpl.length;c++)if(""!=$scope.whyWhyAnalysisforImpl[c].whyWhyAnalysis)if(null!=$scope.suggestionDet.suggestionWhyWhyAnalysis&&0<$scope.suggestionDet.suggestionWhyWhyAnalysis.length)for(let e=0;e<$scope.suggestionDet.suggestionWhyWhyAnalysis.length;e++)$scope.suggestionDet.suggestionWhyWhyAnalysis[e].id==$scope.whyWhyAnalysisforImpl[c].id?(s.append("suggestionWhyWhyAnalysis["+c+"].suggestionWhyWhy.sugId",$scope.suggestionDet.sugId),s.append("suggestionWhyWhyAnalysis["+c+"].createdById",$scope.loggedInEmpId),s.append("suggestionWhyWhyAnalysis["+c+"].stsId",$scope.CONST.STATUS.Implemented.statusId),s.append("suggestionWhyWhyAnalysis["+c+"].name",$scope.whyWhyAnalysisforImpl[c].whyWhyAnalysis),s.append("suggestionWhyWhyAnalysis["+c+"].id",$scope.whyWhyAnalysisforImpl[c].id)):(s.append("suggestionWhyWhyAnalysis["+c+"].suggestionWhyWhy.sugId",$scope.suggestionDet.sugId),s.append("suggestionWhyWhyAnalysis["+c+"].createdById",$scope.loggedInEmpId),s.append("suggestionWhyWhyAnalysis["+c+"].stsId",$scope.CONST.STATUS.Implemented.statusId),s.append("suggestionWhyWhyAnalysis["+c+"].name",$scope.whyWhyAnalysisforImpl[c].whyWhyAnalysis)),s.append("suggestionWhyWhyAnalysis["+c+"].isActived","Y");else s.append("suggestionWhyWhyAnalysis["+c+"].suggestionWhyWhy.sugId",$scope.suggestionDet.sugId),s.append("suggestionWhyWhyAnalysis["+c+"].createdById",$scope.loggedInEmpId),s.append("suggestionWhyWhyAnalysis["+c+"].stsId",$scope.CONST.STATUS.Implemented.statusId),s.append("suggestionWhyWhyAnalysis["+c+"].name",$scope.whyWhyAnalysisforImpl[c].whyWhyAnalysis),s.append("suggestionWhyWhyAnalysis["+c+"].isActived","Y");if($scope.suggestionDet.suggestionWhyWhyAnalysis&&0<$scope.suggestionDet.suggestionWhyWhyAnalysis.length)for(let t=0;t<$scope.suggestionDet.suggestionWhyWhyAnalysis.length;t++)$scope.whyWhyAnalysisforImpl&&$scope.whyWhyAnalysisforImpl.some(e=>e.id===$scope.suggestionDet.suggestionWhyWhyAnalysis[t].id)||(s.append("suggestionWhyWhyAnalysis["+t+"].suggestionWhyWhy.sugId",$scope.suggestionDet.sugId),s.append("suggestionWhyWhyAnalysis["+t+"].createdById",$scope.loggedInEmpId),s.append("suggestionWhyWhyAnalysis["+t+"].stsId",$scope.CONST.STATUS.Implemented.statusId),s.append("suggestionWhyWhyAnalysis["+t+"].name",$scope.suggestionDet.suggestionWhyWhyAnalysis[t].name),s.append("suggestionWhyWhyAnalysis["+t+"].id",$scope.suggestionDet.suggestionWhyWhyAnalysis[t].id),s.append("suggestionWhyWhyAnalysis["+t+"].isActived","N"))}if(null!=$scope.suggestionDet.whatToDo&&null!=$scope.suggestionDet.whatToDo&&""!=$scope.suggestionDet.whatToDo&&s.append("whatToDo",$scope.suggestionDet.whatToDo),null!=$scope.suggestionDet.howToDo&&null!=$scope.suggestionDet.howToDo&&""!=$scope.suggestionDet.howToDo&&s.append("howToDo",$scope.suggestionDet.howToDo),null!=$scope.suggestionDet.benefits&&null!=$scope.suggestionDet.benefits&&""!=$scope.suggestionDet.benefits&&s.append("benefits",$scope.suggestionDet.benefits),null!=$scope.suggestionDet.results&&null!=$scope.suggestionDet.results&&""!=$scope.suggestionDet.results&&s.append("results",$scope.suggestionDet.results),null!=$scope.suggestionDet.kaizenIdea&&null!=$scope.suggestionDet.kaizenIdea&&""!=$scope.suggestionDet.kaizenIdea&&s.append("kaizenIdea",$scope.suggestionDet.kaizenIdea),null!=$scope.suggestionDet.frquency&&null!=$scope.suggestionDet.frquency&&""!=$scope.suggestionDet.frquency&&s.append("frquency",$scope.suggestionDet.frquency),null!=$scope.suggestionDet.counterMeasures&&null!=$scope.suggestionDet.counterMeasures&&""!=$scope.suggestionDet.counterMeasures&&s.append("counterMeasures",$scope.suggestionDet.counterMeasures),null!=$scope.suggestionDet.rootCause&&null!=$scope.suggestionDet.rootCause&&""!=$scope.suggestionDet.rootCause&&s.append("rootCause",$scope.suggestionDet.rootCause),$scope.suggestionDet.pcnNumber&&"Y"==$scope.suggFlowConfig.isPCNNoEnbld&&s.append("pcnNo",$scope.suggestionDet.pcnNumber),0<$scope.resultImageFiles.length)for(var a in $scope.resultImageFiles)s.append("resultDoc",$scope.resultImageFiles[a]);var r=$("#resultImageGraph").get(0);if(null!=r&&""!=r&&(r=r.toDataURL(),s.append("resultImageBase64",r)),"Y"==$scope.suggFlowConfig.kaizenCheckReqImpl&&null!=$scope.suggestionDet.implSustenanceflow&&null!=$scope.suggestionDet.implSustenanceflow&&$scope.suggestionDet.implSustenanceflow){if(null==$scope.suggestionDet.sustenanceAuditorId||null==$scope.suggestionDet.sustenanceAuditorId||""==$scope.suggestionDet.sustenanceAuditorId)return C.create($filter("translate")("Please_select_sustenance_auditor"),6e3,"error"),$scope.flagTeamDetPopupSpinner=!1,void($scope.uploadAttachmentModalSpinner=!1);s.append("kaizenSusReqByImplementer",$scope.suggestionDet.implSustenanceflow),s.append("sustenanceAuditorId",$scope.suggestionDet.sustenanceAuditorId)}}else if(2==$scope.implTab){if($scope.flaghold=!1,""==$scope.implData.onHoldImplSummary||null==$scope.implData.onHoldImplSummary||null==$scope.implData.onHoldImplSummary)return $scope.flaghold=!0,void angular.element("#holdId").text($filter("translate")("Please_enter_on_hold_comment"));$scope.onHoldImplementationSpinner=!0,s.append("summary",$scope.implData.onHoldImplSummary)}else if(3==$scope.implTab){if($scope.flagcancelsugg=!1,""==$scope.implData.rejectionReason||null==$scope.implData.rejectionReason||null==$scope.implData.rejectionReason)return $scope.flagcancelsugg=!0,void angular.element("#cancelId").text($filter("translate")("Please_enter_reject_suggestion_comment"));$scope.cancleImplementationSpinner=!0,s.append("rejectionReason",$scope.implData.rejectionReason)}$scope.isBeforeUploadImageOn=E.empDetails.productOrgConfigDet.isBeforeUploadImageOn,$scope.CONST.STATUS.Implemented.statusId==t&&""==$scope.implFiles&&""==$scope.implBeforFiles&&1==E.empDetails.productOrgConfigDet.isBeforeUploadImageOn?(C.create($filter("translate")("Please_select_image"),3e3,"error"),$scope.uploadAttachmentModalSpinner=!1):(s.append("stsAuditId",$scope.suggestionDet.sugesstionStatusAudit[$scope.suggestionDet.sugesstionStatusAudit.length-1].stsadtId),s.append("orgId",E.empDetails.organization.orgId),$scope.implUrl="",$scope.suggestionDet.sugesstionStatusAudit[$scope.suggestionDet.sugesstionStatusAudit.length-1].status_master.status==$scope.CONST.STATUS.ReassignedToImplPostVerification.status?$scope.implUrl="reassignImplSubmission":$scope.implUrl="implement",b.uploadFileToUrl(s,$scope.implUrl).then(function(e){if($scope.implMachineHDList=[],$scope.implData.safetImplactionSummary=null,$scope.uploadAttachmentModalSpinner=!1,$scope.onHoldImplementationSpinner=!0,$scope.cancleImplementationSpinner=!1,e.data.result){if($("#implementedModal").modal("hide"),$(".modal-backdrop").remove(),$scope.whyWhyAnalysisforImpl=[{whyWhyAnalysis:""}],$scope.resultImageFiles=[],$scope.implFiles=[],1==$scope.implTab){e.data.statusId==$scope.CONST.STATUS.PendingDocumentUpdate.statusId?C.create($filter("translate")("Suggestion_implemented_document_update"),5e3,"success"):e.data.statusId==$scope.CONST.STATUS.AssignedForFCVerification.statusId?C.create($filter("translate")("Suggestion_assigned_to_Finance_Controller_successfully"),5e3,"success"):e.data.statusId==$scope.CONST.STATUS.AssignedToImplementorForHorizantalDeployement.statusId?C.create($filter("translate")("Suggestion_successfully_assigned_deployment"),5e3,"success"):e.data.statusId==$scope.CONST.STATUS.AssignedForSustainanceCheck.statusId?C.create($filter("translate")("Suggestion_assigned_for_sustainance_check"),5e3,"success"):"Y"==$scope.suggFlowConfig.isImplVerifEnbld?C.create($filter("translate")("Suggestion_assigned_for_implementation_verification_successfully"),5e3,"success"):C.create($filter("translate")("Suggestion_implemented_successfully"),5e3,"success"),$scope.implFiles=[],$scope.selectedEmpList=[];for(var t=0;t<$scope.employeeList.length;t++)$scope.employeeList[t].isSelected=!1}if(2==$scope.implTab&&C.create($filter("translate")("Suggestion_is_on_hold"),5e3,"success"),3==$scope.implTab&&C.create($filter("translate")("Suggestion_cancelled_successfully"),5e3,"success"),$scope.dashboardData={},$scope.dashboardData.selectedTypeId=$scope.graphTypeList[0],null!=$scope.departmentList&&0<$scope.departmentList.length)for(let e=0;e<$scope.departmentList.length;e++)$scope.departmentList[e].isImplselect=!1;$scope.getsuggestionList("onUpdate"),$scope.getStatusWiseCount()}else"Implementation Verifier Setup Not Found"==e.data.reason?C.create($filter("translate")("Implementation Verifier setup not found for this department. Please add implementation verifier (Go to Setup & config -> Suggestions -> Implementation Verification)"),5e3,"error"):100==e.data.statusCode?C.create(e.data.reason,5e3,"error"):C.create("Error occured while submitting data. Please try again.",5e3,"error")}))}else C.create($filter("translate")("Sustenance_audit_is_mandatory"),5e3,"error")}else C.create($filter("translate")("Benefit_is_mandatory"),5e3,"error")}else C.create($filter("translate")("Please_Select_FC"),6e3,"error");else C.create($filter("translate")("Actual_Implementation_mandatory"),6e3,"error")}else C.create($filter("translate")("Actual_Implementation_mandatory"),6e3,"error")},$scope.change_flagonhlodreject=function(){""==$scope.implData.onHoldImplSummary?$scope.flagcancelholdsugg=!0:$scope.flagcancelholdsugg=!1},$scope.change_flagonhlodresume=function(){""==$scope.implData.onHoldImplSummary?$scope.flagcancelresumesugg=!0:$scope.flagcancelresumesugg=!1},$scope.changefurtheronhold=function(){var e=new Date,t=new Date(e);t.setDate(e.getDate()+1),angular.element(".toDate_datepicker").datepicker({format:"yyyy-mm-dd",startDate:t,autoclose:!0}),angular.element(".toDate_datepicker").datepicker("setStartDate",t)},$scope.suggestionhold=function(t){if(2==$scope.implTab){if($scope.flaghold=!1,""==$scope.implData.onHoldImplSummary||null==$scope.implData.onHoldImplSummary||null==$scope.implData.onHoldImplSummary)return void($scope.flaghold=!0);if($scope.flagonhold=!1,""==$scope.implData.onholdDate||null==$scope.implData.onholdDate||null==$scope.implData.onholdDate)return void($scope.flagonhold=!0)}if($scope.flagrejectonhold&&($scope.flagcancelholdsugg=!1,""==$scope.implData.onHoldImplSummary||null==$scope.implData.onHoldImplSummary||null==$scope.implData.onHoldImplSummary))$scope.flagcancelholdsugg=!0;else{var e="";if($scope.flagresumeonhold){if($scope.flagcancelresumesugg=!1,""==$scope.implData.onHoldImplSummary||null==$scope.implData.onHoldImplSummary||null==$scope.implData.onHoldImplSummary)return void($scope.flagcancelresumesugg=!0);if(""==(e=null!=$scope.empInputDet.selectedEmpIds&&0<$scope.empInputDet.selectedEmpIds.length?$scope.empInputDet.selectedEmpIds[0]:""))return void($scope.flagSelectTeamMem=!0)}else e=parseInt($scope.loggedInEmpId);if($scope.flagFurtherhold){if($scope.flagfurtherhold=!1,""==$scope.implData.onHoldImplSummary||null==$scope.implData.onHoldImplSummary||null==$scope.implData.onHoldImplSummary)return void($scope.flagfurtherhold=!0);if($scope.flagfurtherholddate=!1,""==$scope.implData.onholdDate||null==$scope.implData.onholdDate||null==$scope.implData.onholdDate)return void($scope.flagfurtherholddate=!0)}$scope.data={branchId:$scope.suggestionDet.branch.branchId,statusId:t,sugId:$scope.selectedSuggId,onHoldDateString:$filter("date")(new Date($scope.implData.onholdDate),"yyyy-MM-dd"),empId:E.empDetails.empId,assignedById:e,summary:$scope.implData.onHoldImplSummary},$scope.onHoldImplSpinner=!0,b.httpPost($scope.data,"onHoldSuggestionFlow").then(function(e){$scope.onHoldImplSpinner=!1,$scope.flagFurtherhold=!1,e.result?(110==t?C.create($filter("translate")("Suggestion_accepted_for_on_hold"),5e3,"success"):113==t?C.create($filter("translate")("On_hold_suggestion_rejected_successfully"),5e3,"success"):111==t?(C.create($filter("translate")("On_hold_suggestion_resume_successfully"),5e3,"success"),$("#onHoldImplModal").modal("hide")):21==t&&C.create($filter("translate")("Suggestion_kept_on_hold_successfully"),5e3,"success"),$("#onHoldModal").modal("hide"),$scope.getsuggestionList("onUpdate"),$scope.getStatusWiseCount()):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")})}},$scope.getonholdsetuplist=function(){$scope.flagEmployeeListSpinner=!0,b.httpGet("getSugOnHoldSetupList/"+E.empDetails.branch.branchId).then(function(e){if($scope.flagEmployeeListSpinner=!1,$scope.flagTblemployee=!0,e.result){$scope.onholdList=e.list;for(var t=0;t<$scope.onholdList.length;t++)$scope.onholdList[t].empId==$scope.loggedInEmpId&&($scope.onholdflag=!0)}else $scope.onholdList=[]})},$scope.change_flag_changeDoc=function(e){$scope.flagChangeDocText=""==e||null==e},$scope.change_flag_fileName=function(e){$scope.flagChangeDocName=""==e||null==e},$scope.documentChanged=function(e){var t=new FormData,s=0;if(""==e.document.fileName||null==e.document.fileName||null==e.document.fileName)C.create($filter("translate")("Please_enter_file_name"),5e3,"error");else if($scope.flagChangeDocName=!1,""==e.document.summary||null==e.document.summary||null==e.document.summary)C.create($filter("translate")("Please_enter_document_details"),5e3,"error");else{$scope.flagChangeDocText=!1;for(var i=0;i<$scope.suggestionDet.implTeamList.length;i++)$scope.suggestionDet.implTeamList[i].statusAuditId==$scope.implAssignedStatusAdtId&&(s=$scope.suggestionDet.implTeamList[i].sugTrackId);for(var a=0,i=0;i<$scope.suggestionDet.sugesstionStatusAudit.length;i++)if($scope.suggestionDet.sugesstionStatusAudit[i].status_master.status==$scope.CONST.STATUS.ImplementationRequestAccepted.status){a=$scope.suggestionDet.sugesstionStatusAudit[i].emp_details.empId;break}t.append("statusId",$scope.CONST.STATUS.PendingDocumentUpdate.statusId),t.append("teamTypeId",$scope.CONST.TEAM_TYPE.IMPLEMENTATION),t.append("sugId",$scope.selectedSuggId),t.append("implementedbyId",a),t.append("updatedBy",a),t.append("empId",$scope.suggestionDet.emp_details.empId),t.append("suggtrackId",s),t.append("docUpdateStatus",!0),t.append("branchId",$scope.suggestionDet.branch.branchId),t.append("fileName",e.document.fileName),t.append("summary",e.document.summary),t.append("auditId",e.audit.stsadtId),t.append("documentId",e.document.id),$scope.changesCompleted=!0,b.uploadFileToUrl(t,"implement").then(function(e){$scope.changesCompleted=!1,e.data.result?($scope.CONST.STATUS.PendingDocumentUpdate.statusId==e.data.statusId?C.create($filter("translate")("Document_updated_successfully"),5e3,"success"):e.data.statusId==$scope.CONST.STATUS.AssignedForFCVerification.statusId?C.create($filter("translate")("Suggestion_assigned_to_Finance_Controller_successfully"),5e3,"success"):C.create($filter("translate")("Suggestion_implemented_successfully_document_change"),5e3,"success"),$scope.implFiles=[],$scope.getsuggestionList("onUpdate"),$scope.getStatusWiseCount()):100==e.data.statusCode?C.create(e.reason,5e3,"error"):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")})}},$scope.rejectSugg=function(){""==$scope.suggestionDet.closesummery?$scope.flagreject=!0:$scope.flagreject=!1},$scope.suggestionRequestClosed=function(){if($scope.flagcancleImplementationSpinner=!0,$scope.data={statusId:$scope.CONST.STATUS.ImplementationRequestRejected.statusId,sugId:$scope.selectedSuggId,assignedById:parseInt($scope.loggedInEmpId)},1==$scope.isImplementerRej){if(""==$scope.suggestionDet.closesummery||null==$scope.suggestionDet.closesummery||null==$scope.suggestionDet.closesummery)return $scope.flagreject=!0,void angular.element("#cancelIddata").text("Please enter rejection reason.");$scope.data.summary=$scope.suggestionDet.closesummery}else if(0==$scope.isImplementerRej){if(0==$scope.count)return void C.create("Please select rejection reason from list",3e3,"error");$scope.data.suggReasonIds=$scope.selectRejArray}b.httpPost($scope.data,"closedSuggestion").then(function(e){$scope.flagcancleImplementationSpinner=!1,$scope.flagreject=!1,e.result?($("#implRejectedModal").modal("hide"),$(".modal-backdrop").remove(),C.create($filter("translate")("Suggestion_closed_successfully"),5e3,"success"),$scope.suggestionDet={},$scope.getsuggestionList("onUpdate"),$scope.getStatusWiseCount()):100==e.statusCode?C.create(e.reason,5e3,"error"):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")})},$scope.exportDatePicker={fromDt:moment().subtract(6,"months"),toDt:moment(),currentDate:moment()},$scope.exportDatePickerOpt={fromOpt:{singleDatePicker:!0,maxDate:moment(),locale:{format:"YYYY-MM-DD"},eventHandlers:{"hide.daterangepicker":function(e,t){$scope.exportDatePicker.fromDt&&moment($scope.exportDatePicker.fromDt)}}},toOpt:{singleDatePicker:!0,maxDate:moment(),locale:{format:"YYYY-MM-DD"},eventHandlers:{"hide.daterangepicker":function(e,t){}}}},$scope.openExportSuggModal=function(){var e;$scope.exportModalSpinner=!1,$scope.suggDetailModel.fromDt&&$scope.suggDetailModel.toDt&&(e=moment($scope.suggDetailModel.fromDt),(e=moment($scope.suggDetailModel.toDt).diff(e,"months"))<6||6==e)?($scope.exportDatePicker.fromDt=$scope.suggDetailModel.fromDt,$scope.exportDatePicker.toDt=$scope.suggDetailModel.toDt):($scope.setFromDate(),$scope.setToDate()),$("#exportSuggModal").modal({backdrop:"static",keyboard:!1})},$scope.setFromDate=function(){$("#fromDate").datepicker({format:"yyyy-mm-dd",autoclose:!0}).on("changeDate",function(e){var t=new Date($("#fromDate").datepicker("getDate"));$scope.exportDatePicker.fromDt=moment(t).format("YYYY-MM-DD")});var e=moment().subtract(6,"months").format("YYYY-MM-DD");$("#fromDate").val(e)},$scope.setToDate=function(){$("#toDate").datepicker({format:"yyyy-mm-dd",autoclose:!0}).on("changeDate",function(e){var t=new Date($("#toDate").datepicker("getDate"));$scope.exportDatePicker.toDt=moment(t).format("YYYY-MM-DD")});var e=moment().format("YYYY-MM-DD");$("#toDate").val(e)},$scope.exportData=function(){if($scope.exportDatePicker.fromDt&&$scope.exportDatePicker.toDt){var e=moment($scope.exportDatePicker.fromDt),e=moment($scope.exportDatePicker.toDt).diff(e,"months");if(e<6||6==e){var e=new Date,l=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+(e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()),o=[],t={orgId:$scope.loggedInUserOrgId,typeId:$scope.statusCountFilter,assignedToId:$scope.loggedInEmpId,catId:0,deptId:0,branchIds:[]},e=($scope.exportDatePicker.fromDt&&$scope.exportDatePicker.toDt&&(t.fromDt=moment($scope.exportDatePicker.fromDt).format("YYYY-MM-DD")+" 00:00:00",t.toDt=moment($scope.exportDatePicker.toDt).format("YYYY-MM-DD")+" 23:59:59"),2!=$scope.statusCountFilter&&4!=$scope.statusCountFilter||(t.type="EXCEL_EXPORT"),""),e=0<$scope.statusCountFilter?"getsuggestionlistnew":"getallsuggestion";if(0<$scope.suggestionPagination.selectedCatId?t.catId=$scope.suggestionPagination.selectedCatId:(delete t.catId,t.processType=" ",t.processType=$scope.suggDetailModel.selectedCategoryName),""!=t.processType&&null!=t.processType&&null!=t.processType||delete t.processType,0<$scope.suggestionPagination.selectedDeptId?t.deptId=$scope.suggestionPagination.selectedDeptId:delete t.deptId,9==$scope.statusCountFilter)null!=$scope.suggestionPagination.selectedStatus&&""!=$scope.suggestionPagination.selectedStatus&&null!=$scope.suggestionPagination.selectedStatus.statusId?(t=[$scope.suggestionPagination.selectedStatus.statusId],$scope.data.statusIds=t):delete $scope.data.statusIds;else{var s=[];if(null!=$scope.suggDetailModel.statusList&&0<$filter("filter")($scope.suggDetailModel.statusList,{isSelected:!0},!0).length){for(let e=0;e<$scope.suggDetailModel.statusList.length;e++)$scope.suggDetailModel.statusList[e].isSelected&&"All"!=$scope.suggDetailModel.statusList[e].label&&s.push($scope.suggDetailModel.statusList[e].statusId);$scope.data.statusIds=s}}if(null!=$scope.accessBranchList)for(var i=0;i<$scope.accessBranchList.length;i++)$scope.accessBranchList[i].isSelected&&t.branchIds.push($scope.accessBranchList[i].branchId);else t.branchIds.push($scope.loggedInUserBranchId);null!=$scope.suggDetailModel.selectedLevel&&null!=$scope.suggDetailModel.selectedLevel&&""!=$scope.suggDetailModel.selectedLevel&&(t.suggestionLevel=$scope.suggDetailModel.selectedLevel.level),$scope.suggDetailModel.hasOwnProperty("searchBy")&&!$scope.isEmpty($scope.suggDetailModel.searchBy)&&(""!=$scope.suggDetailModel.searchBy&&2==$scope.suggDetailModel.searchBy.id?(t.srchKey="SRCH_BY_EMP_ID",t.typeId=$scope.selectedFilter.filterId):""!=$scope.suggDetailModel.searchBy&&1==$scope.suggDetailModel.searchBy.id&&null!=$scope.suggDetailModel.suggestionNumber&&""!=$scope.suggDetailModel.suggestionNumber?(t.srchKey="SRCH_BY_SUGG_NUMBER",$scope.suggDetailModel.searchById&&(t.suggNum=$scope.suggDetailModel.suggestionNumber,t.typeId=$scope.selectedFilter.filterId)):""!=$scope.suggDetailModel.searchBy&&3==$scope.suggDetailModel.searchBy.id&&null!=$scope.suggDetailModel.suggestionNumber&&""!=$scope.suggDetailModel.suggestionNumber?(t.srchKey="SRCH_BY_COMPANY_EMP_ID",$scope.suggDetailModel.searchById&&(t.companyEmpNum=$scope.suggDetailModel.suggestionNumber,t.typeId=$scope.selectedFilter.filterId)):""!=$scope.suggDetailModel.searchBy&&4==$scope.suggDetailModel.searchBy.id&&null!=$scope.suggDetailModel.suggestionNumber&&""!=$scope.suggDetailModel.suggestionNumber?(t.srchKey="SRCH_BY_EMP_NAME",$scope.suggDetailModel.searchById&&(t.empName=$scope.suggDetailModel.suggestionNumber,t.typeId=$scope.selectedFilter.filterId)):""!=$scope.suggDetailModel.searchBy&&5==$scope.suggDetailModel.searchBy.id&&null!=$scope.suggDetailModel.suggestionNumber&&""!=$scope.suggDetailModel.suggestionNumber&&(t.srchKey="SRCH_BY_SUGG_TITLE",$scope.suggDetailModel.searchById)&&(t.suggestionTitle=$scope.suggDetailModel.suggestionNumber,t.typeId=$scope.selectedFilter.filterId));var r=[];$scope.exportModalSpinner=!0,b.httpPost(t,e).then(function(e){if(e.result){if(r=e.sugessionsByEmpIdList,9==$scope.selectedFilter.filterId)for(var t=0;t<r.length;t++){null!=r[t].kaizenVerificationDate&&null!=r[t].kaizenVerificationDate?r[t].kaizenVerificationDate=$filter("date")(new Date(r[t].kaizenVerificationDate),"dd/MM/yyyy"):r[t].kaizenVerificationDate="",null!=r[t].iskaizenExist&&null!=r[t].iskaizenExist&&"Y"==r[t].iskaizenExist?r[t].iskaizenExist="Live":r[t].iskaizenExist="Doesn't Exist",null!=r[t].lastConfirmationDate&&null!=r[t].lastConfirmationDate&&""!=r[t].lastConfirmationDate?r[t].lastConfirmationDate=$filter("date")(new Date(r[t].lastConfirmationDate),"dd-MM-yyyy"):r[t].lastConfirmationDate="-";var s=r[t].susAuditorName;s&&" "!=s||(s=" -"),o.push({"Plant Name":r[t].branchName||" -","Suggestion For Department":r[t].deptName||" -","Suggestion For Cell/Line":r[t].lineName||" -","Suggestion ID":r[t].suggestionNumber||" -","Suggestion Desc":r[t].suggestion||" -",Existence:r[t].iskaizenExist||" -",Status:r[t].label||" -","Verification Due Date":r[t].kaizenVerificationDate||" -","Auditor Name":s,"Category / Result Area":r[t].catName||" -",Benefit:r[t].particulars||" -",Unit:r[t].unitName||" -","Claim By Initiator":r[t].claimByInit||" -","Claim By Evaluator":r[t].claimByEval||" -","Claim By Implementor":r[t].claimByImpl||" -","Value Confirmed By Auditor":r[t].claimByAuditor||" -","Last Confirmation Date":r[t].lastConfirmationDate||" -"})}else for(t=0;t<r.length;t++){null!=r[t].createdDate&&null!=r[t].createdDate&&""!=r[t].createdDate?r[t].createdDate=$filter("date")(new Date(r[t].createdDate),"dd/MM/yyyy"):r[t].createdDate="",null!=r[t].updatedDate&&null!=r[t].updatedDate&&""!=r[t].updatedDate?r[t].updatedDate=$filter("date")(new Date(r[t].updatedDate),"dd/MM/yyyy"):r[t].updatedDate="",null!=r[t].assignedDate&&null!=r[t].assignedDate&&""!=r[t].assignedDate?r[t].assignedDate=$filter("date")(new Date(r[t].assignedDate),"dd/MM/yyyy"):r[t].assignedDate="-",null!=r[t].deptName&&"null"!=r[t].deptName||(r.deptName="Executive Suggestion"),1==r[t].isSelfImplemented?r[t].isSelfImplemented="Yes":r[t].isSelfImplemented=" No",null!=r[t].createdBy&&null!=r[t].createdBy.firstName?r[t].createdByFirstName=r[t].createdBy.firstName:r[t].createdByFirstName="",null!=r[t].createdBy&&null!=r[t].createdBy.lastName?r[t].createdByLastName=r[t].createdBy.lastName:r[t].createdByLastName="";var i="",i=r[t].createdBy&&r[t].createdBy.cmpyEmpId?(i=r[t].createdByFirstName?r[t].createdByFirstName+" ":"",(i+=r[t].createdByLastName?r[t].createdByLastName+"("+r[t].createdBy.cmpyEmpId+")":"").trim()):" -",a=(a=r[t].assignToEmpName)&&null!=a&&" "!==a?r[t].assignToEmpName:" -",n=(n=r[t].asignToEmpDept||" -")&&null!=n&&""!==n&&"N/A"!==n?r[t].asignToEmpDept:" -";o.push({"Suggestion ID":r[t].suggestionNumber||" -","Branch Name":r[t].branchName||" -","Suggestion For Department":r[t].deptName||" -","Suggestion For Cell/Line":r[t].lineName||" -","Category / Result Area":r[t].catName||" -","Employee Type":r[t].empType||" -","Employee ID":r[t].cmpyEmpId||" -","Employee Name":r[t].empName||" -","Employee Department":r[t].empDeptName||" -","Suggestion Title / Theme":r[t].suggestionTitle||" -","Suggestion Source":r[t].suggestionSource||" -",Suggestion:r[t].suggestion||" -","Present Problem":r[t].problemAnalysis||" -","Brownie Points":r[t].points||" -","Created Date":r[t].createdDate||" -","Assigned Date":r[t].assignedDate||" -","Assigned To":a,"Assignee Department":n,"Time Taken":r[t].meanTime||" -",Status:r[t].label||" -","Implementation Date":r[t].implementationDate?$filter("date")(new Date(r[t].implementationDate),"dd-MM-yyyy h:mm a"):"-",Result:r[t].result||"-","Implementation Action":r[t].implementationAction||" -","Self Implemented":r[t].isSelfImplemented||" -","EHS Benefit":null!==r[t].isEHSBenefit?r[t].isEHSBenefit:"No","EHS Benefit Details":r[t].ehsBenefitDetails||"-",OnBehalf:"Y"===r[t].isSuggOnBehalf?"Yes":"N"===r[t].isSuggOnBehalf?"No":"-","Created By(Emp ID)":i,"Implementation Team":r[t].implTeam||"-"})}m.exportDataToExcel(o,"Suggestion_List-"+l,"Suggestion_List-"+l),$("#exportSuggModal").modal("hide")}else 100==e.statusCode?C.create(e.reason,3e3,"error"):C.create("Data not found",3e3,"error")})}else C.create("At a time you may export data only for 6 months.",3e3,"error")}},$scope.ClearExportDate=function(){$scope.exportDatePicker.fromDt="",$scope.exportDatePicker.toDt=""},$scope.exportCertificate=function(a){var e,t,n;if(""!=a)return e=new FormData,t=angular.element("#expCertDetails").val(),e.append("content",t),E.flagpageloadindicator=!0,n=$q.defer(),$http.post($scope.kaizenExportUrl,e,{transformRequest:angular.identity,responseType:"arraybuffer",headers:{"Content-Type":void 0,Authorization:r.getToken()}}).then(function(e){E.flagpageloadindicator=!1;var t=document.createElement("a"),s=(document.body.appendChild(t),t.style="display: none",a+$scope.suggestionDet.suggestionNumber+".pdf"),i=new Blob([e.data],{type:"application/pdf"}),i=URL.createObjectURL(i);t.href=i,t.download=s,t.click(),window.URL.revokeObjectURL(i),n.resolve(e),$scope.suggestionDet.exportCer=""}).catch(function(e){E.flagpageloadindicator=!1,n.resolve(e.data)}),n.promise},$scope.setExportCertificate=function(e){$scope.suggestionDet.exportCer=e,$timeout(function(){$scope.exportCertificate(e)},1e3)},$scope.downloadKaizenCert=function(e,t){var s=document.createElement("canvas"),i="",a=new Image,n=(s=document.createElement("canvas")).getContext("2d");null!=E.empDetails.organization.logo?(i=E.empDetails.organization.logo,a.src=i,a.crossOrigin="Anonymous"):$scope.PrintKaizenCert(null,e,t),a.onload=function(){s.width=a.width,s.height=a.height,n.drawImage(a,0,0),$scope.PrintKaizenCert(s.toDataURL("image/png"),e,t)},!a.complete&&void 0!==a.complete||(a.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",a.src=i)},$scope.PrintKaizenCert=function(e,t,s){var i=new jsPDF;i.setDrawColor(118,161,252),i.setFontType("bold"),i.setFontSize(22),i.setFont("roboto"),i.setTextColor(45,179,220),i.text("Certificate of Appreciation",105,30,"center"),null==e?((e=new Image).src="dist/icons/app_logo.png",i.addImage(e,"png",90,40,28,0)):i.addImage(e,"png",80,40,50,0),i.setFontSize(14),i.setFontType("normal"),i.setTextColor(0,0,0),i.text("Presented to",107,80,"center"),i.setFontSize(18),i.text(""+t,107,95,"center"),i.setFontSize(14),i.text(40,120,"For the valuable suggestion and successful implementation of Kaizen"),i.text(32,125,"at deptartment -"+s),i.text(32,132,"We look forward to many such innovative inputs from you."),i.text(150,205,"Plant Head"),i.text(32,205,"Kaizen Team"),i.rect(10,10,190,280),i.save(t+" certificate.pdf")},$scope.newSug={},$scope.suggImages=[],$scope.setEditSuggData=function(){$scope.isEditSugg&&($scope.newSug.circleId=$scope.suggestionDet.circle,$scope.newSug.stageId=$scope.suggestionDet.stage,$scope.newSug.productId=$scope.suggestionDet.productFamily,$scope.newSug.productNoId=$scope.suggestionDet.masterProductNo,$scope.newSug.machineId=$scope.suggestionDet.machine,$scope.newSug.opertionId=$scope.suggestionDet.operation)},$scope.editSuggestion=function(){var e;if($("#createNewSugg").modal({backdrop:"static",keyboard:!1}),$scope.getAllBranchList(),$scope.getCWAgencyList(),$scope.files=[],$scope.docFiles=[],$scope.suggImages=[],$scope.createNewSuggTitle="Modify Suggestion - Suggestion ID : "+$scope.suggestionDet.suggestionNumber,$scope.showDeptExesec("department"),$scope.isEditSugg=!0,$scope.newSug.deptId=$scope.suggestionDet.dept,null!=$scope.newSug.deptId&&$scope.getLineNameList($scope.suggestionDet.dept.deptId),$scope.newSug.catId=$scope.suggestionDet.category,null!=$scope.suggestionDet.pillar&&($scope.newSug.activityId=$scope.suggestionDet.pillar),null!=$scope.suggestionDet.circle&&($scope.newSug.circleId=$scope.suggestionDet.circle),null!=$scope.suggestionDet.stage&&($scope.newSug.stageId=$scope.suggestionDet.stage),null!=$scope.suggestionDet.productFamily&&($scope.newSug.productId=$scope.suggestionDet.productFamily),null!=$scope.suggestionDet.machine&&($scope.newSug.machineId=$scope.suggestionDet.machine),null!=$scope.suggestionDet.operation&&($scope.newSug.opertionId=$scope.suggestionDet.operation),null!=$scope.suggestionDet.masterProductNo&&($scope.newSug.productNoId=$scope.suggestionDet.masterProductNo),$scope.suggestionDet.circle,$scope.newSug.benchmark=$scope.suggestionDet.benchmark,$scope.newSug.target=$scope.suggestionDet.target,$scope.newSug.suggestionTitle=$scope.suggestionDet.suggestionTitle,$scope.newSug.problemAnalysis=$scope.suggestionDet.problemAnalysis,$scope.newSug.sugession=$scope.suggestionDet.sugession,$scope.suggImages=$scope.suggestionDet.sugEmpDocDetails,$scope.suggestionSource.id=$scope.suggestionDet.suggestionSource,$scope.suggestionDet.branch.branchName=$scope.suggestionDet.branch.name,$scope.newSug.branchId=$scope.suggestionDet.branch,$scope.isSelfImplemented=1==$scope.suggestionDet.isSelfImplemented,$scope.newSug.isOnBehalf="Y"==$scope.suggestionDet.isSuggOnBehalf,$scope.newSug.isOnBehalf&&($scope.newSug.isOnBehalfType="CW"==$scope.suggestionDet.emp_details.empType?"cw":"emp",e="",$scope.suggestionDet.emp_details.firstName&&(e+=$scope.suggestionDet.emp_details.firstName),$scope.suggestionDet.emp_details.lastName&&($scope.suggestionDet.emp_details.firstName&&(e+=" "),e+=$scope.suggestionDet.emp_details.lastName),"CW"==$scope.suggestionDet.emp_details.empType?($scope.getCwEmpList($scope.suggestionDet.emp_details.cwAgency),$scope.newSug.selectedCwEmp={empName:e,cmpyEmpId:$scope.suggestionDet.emp_details.cmpyEmpId,contactNo:$scope.suggestionDet.emp_details.contactNo,agencyName:$scope.suggestionDet.emp_details.cwAgency.name,agencyId:$scope.suggestionDet.emp_details.cwAgency.id,empId:$scope.suggestionDet.emp_details.empId},$scope.newSug.selectedAgency=$scope.suggestionDet.emp_details.cwAgency):($scope.suggestionDet.emp_details.cmpyEmpId&&(e+=" ("+$scope.suggestionDet.emp_details.cmpyEmpId+")"),$scope.suggestionDet.status_master.status,$scope.CONST.STATUS.ReassignedByEvaluator.status,$scope.newSug.selectedEmp={empName:e,empId:$scope.suggestionDet.emp_details.empId})),$scope.suggestionDet.status_master.status==$scope.CONST.STATUS.ReassignedByEvaluator.status){var t=[];for(let e=0;e<$scope.catbranchwise.length;e++)(!$scope.catbranchwise[e].hasOwnProperty("processType")||"Tier-1"!==$scope.catbranchwise[e].processType)&&t.push($scope.catbranchwise[e]);$scope.catbranchwise=t}},$scope.removeImgOfCreatedSugg=function(s){b.httpGet("removesugesstiondoc/"+s).then(function(e){if(e.result){$scope.getSuggestionDetails($scope.selectedSuggId);for(var t=0;t<$scope.suggImages.length;t++)$scope.suggImages[t].sugEmpDocId==s&&$scope.suggImages.splice(t,1);C.create("Document remove successfully.",3e3,"success")}else 100==e.statusCode?C.create(e.reason,3e3,"error"):C.create("Error occurred while removing document. Please try again",3e3,"error")})},$scope.selfImplementmodel=function(e,t){if($scope.suggestionDet.closeGuest=!1,$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!0,$scope.selectedAudit=t,$scope.evaluationDet=e,$scope.selectedTeamTypeForAssign=$scope.CONST.TEAM_TYPE.IMPLEMENTATION,t.status_master.status==$scope.CONST.STATUS.ApprovedByFC.status)$scope.assignSuggestion();else if(null==$scope.evaluationDet||null==$scope.evaluationDet||null!=$scope.evaluationDet.evaluationInputs&&""!=$scope.evaluationDet.evaluationInputs){if("Y"==$scope.suggFlowConfig.isParticularsEnbld&&1==E.empDetails.productOrgConfigDet.isPraticularsMandatory){if(0==$filter("filter")($scope.particulars,{isChecked:!0}).length)return C.create($filter("translate")("Particulars_Other_Benefits_is_mandatory"),5e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if(null!=$scope.particulars&&0<$scope.particulars.length)for(let e=0;e<$scope.particulars.length;e++)if(0<$scope.particulars[e].selectedId&&$scope.particulars[e].isChecked&&$scope.particulars[e].tangible&&!$scope.particulars[e].hasOwnProperty("newUnit")&&!$scope.particulars[e].hasOwnProperty("newValue"))return C.create($filter("translate")("Please_enter_value_and_unit_for_tangible_benefit"),5e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1)}if($scope.isEmpty($scope.suggestionDet.hdCatId)||null==$scope.suggestionDet.hdCatId||null==$scope.suggestionDet.hdCatId||""==$scope.suggestionDet.hdCatId)$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1,C.create($filter("translate")("Please_select_category"),6e3,"error");else{if("Y"==$scope.suggFlowConfig.isParticularsEnbld){if("Y"==$scope.suggFlowConfig.kaizenCheckReqEval&&1==E.empDetails.productOrgConfigDet.isSusAuditRequired&&"Y"==$scope.suggestionDet.hdCatId.isSusAuditRequired&&(null==$scope.suggestionDet.evalSustenanceflow||null==$scope.suggestionDet.evalSustenanceflow||!$scope.suggestionDet.evalSustenanceflow))return C.create($filter("translate")("Sustenance_audit_is_mandatory"),5e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if("Y"==$scope.suggFlowConfig.kaizenCheckReqEval&&null!=$scope.suggestionDet.evalSustenanceflow&&null!=$scope.suggestionDet.evalSustenanceflow&&$scope.suggestionDet.evalSustenanceflow){if(null==$scope.suggestionDet.sustenanceAuditorList||0==$scope.suggestionDet.sustenanceAuditorList.length)return C.create($filter("translate")("Auditor_setup_not_found_for_this_category_Please_add_Auditor"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1);if(null==$scope.suggestionDet.sustenanceAuditorId||null==$scope.suggestionDet.sustenanceAuditorId||""==$scope.suggestionDet.sustenanceAuditorId)return C.create($filter("translate")("Please_select_sustenance_auditor"),6e3,"error"),void($scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1)}}1!=E.empDetails.productOrgConfigDet.isDocChangeOn||"Y"!=$scope.suggFlowConfig.isChgDocEnbld||$scope.suggestionDet.tmpIsDocumentChangeRequire||0!=$filter("filter")($scope.documentLists,{isChecked:!0}).length?"Y"==$scope.suggFlowConfig.isHorizDplymntsEnbld&&!$scope.suggestionDet.isHDRequire&&$scope.suggestionDet.hdSelected?(C.create($filter("translate")("Evaluation_horizontal_deployment_mandatory"),6e3,"error"),$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1):$scope.suggestionDet.status_master.status!=$scope.CONST.STATUS.EvaluationRequestAccepted.status&&$scope.suggestionDet.status_master.status!=$scope.CONST.STATUS.ReassignedToEvaluationTeam.status||1!=$scope.productOrgConfigList.isPriorityMadatory||null!=$scope.suggestionDet.suggPriority||"Y"!=$scope.suggFlowConfig.isImplPriority?$scope.assignSuggestion():(C.create($filter("translate")("Implementation_Priority_is_mandatory"),6e3,"error"),$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1):(C.create($filter("translate")("Its_mandatory_to_assign_documents_for_update"),6e3,"error"),$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1)}}else C.create($filter("translate")("Evaluation_details_are_mandatory"),6e3,"error"),$scope.suggestionInputDetails.flagEvalInputSubmitSpinner=!1},$scope.files=[],$scope.getFileDetails=function(i){$scope.$apply(function(){if(0<$scope.files.length)C.create($filter("translate")("Only_one_image_upload"),5e3,"error");else for(var e=0;e<i.files.length;e++){var t=i.files[e].type,s=i.files[e].name.replace(/\.[^/.]+$/,""),t=t.split("/")[1];if("jpg"!=angular.lowercase(t)&&"jpeg"!=angular.lowercase(t)&&"png"!=angular.lowercase(t))return void C.create($filter("translate")("Invalid_file"),5e3,"error");if(10485760<i.files[e].size)return C.create($filter("translate")("Image_size_exceeds_limit"),5e3,"error"),void(document.getElementById("file").value="");i.files[e].fileName=s,i.files[e].ext=t,$scope.files.push(i.files[e])}})},$scope.docFiles=[],$scope.getFileDetailsDoc=function(s){$scope.$apply(function(){for(var e=0;e<s.files.length;e++){var t=s.files[e].name.match(/\.(.+)$/)[1];s.files[e].ext=t,$scope.docFiles.push(s.files[e])}})},$scope.fileReader=function(t){var e=new FileReader;e.onload=function(e){$scope.$apply(function(){t.imgsrc=e.target.result,t.src=e.target.result,t.imgsrcImpl=e.target.result})},e.readAsDataURL(t)},$scope.getDeptBranchWise=function(){b.httpGet("getDepartmentListForSuggestion/"+$scope.loggedInUserBranchId).then(function(e){$scope.deptbranchwise=e.deptList})},$scope.suggestionSource={id:null},$scope.getSuggestionSource=function(){b.httpGet("getSuggestionSourceList").then(function(e){e.result&&("magna"==D&&34==$scope.loggedInUserOrgId&&150==$scope.loggedInUserBranchId?$scope.suggestionSourceList=e.suggestionSourceList.filter(function(e){return 17===e.id||18===e.id}):$scope.suggestionSourceList=e.suggestionSourceList,$scope.listFilter.suggestionSourceList=angular.copy($scope.suggestionSourceList))})},$scope.getSuggestionSource(),$scope.getLineNameList=function(e){e&&b.httpGet("getLineNameList/"+e).then(function(e){if($scope.linefocus=!0,e.result)if(null!=e.lineList&&0<e.lineList.length){var t=[],s=$filter("filter")(e.lineList,{isActive:"!N"},!0);for(let e=0;e<s.length;e++)"N"!=s[e].isActive&&(t.push(s[e]),$scope.isEditSugg)&&$scope.suggestionDet.lineId==s[e].id&&($scope.newSug.line=s[e]);$scope.lineNameList=t}else $scope.lineNameList=[];else $scope.lineNameList=[]})},$scope.deptLineList=[],$scope.checkAndSetDeptLineList=function(i){i&&b.httpGet("getLineNameList/"+i.deptId).then(function(e){if(e.result)for(var s=0;s<$scope.departmentList.length;s++)if($scope.departmentList[s].deptId==i.deptId){var t=$filter("filter")(e.lineList,{isActive:"!N"},!0);$scope.departmentList[s].lineList=t;for(let t=0;t<$scope.departmentList[s].lineList.length;t++){if(null!=$scope.suggestionDet.suggestionHorizontalDept&&0<$scope.suggestionDet.suggestionHorizontalDept.length)for(let e=0;e<$scope.suggestionDet.suggestionHorizontalDept.length;e++)$scope.departmentList[s].lineList[t].id==$scope.suggestionDet.suggestionHorizontalDept[e].lineId&&($scope.departmentList[s].lineList[t].isEvalselect=!0,$scope.departmentList[s].lineList[t].isImplselect=!0,$scope.departmentList[s].isEvalselect=!0,$scope.departmentList[s].isImplselect=!0);$scope.departmentList[s].lineList[t].lineId=$scope.departmentList[s].lineList[t].id}$scope.departmentList[s].lineList.push({name:"All",id:0}),$scope.departmentList[s].lineFound=!0}})},$scope.checkCircleforPillarList=function(i){b.httpGet("getCircleList/"+$scope.loggedInUserBranchId).then(function(e){if(1==e.result){$scope.circleList=e.circleList;for(var t=0;t<$scope.circleList.length;t++)if($scope.circleList[t].piller.id==i)for(var s=0;s<$scope.activityList.length;s++)$scope.activityList[s].id==i&&($scope.activityList[s].circleFound=!0)}else $scope.circleList=[]})},$scope.checkCircleforPillarListAtImpl=function(a){b.httpGet("getCircleList/"+$scope.loggedInUserBranchId).then(function(e){if(1==e.result){$scope.circleList=e.circleList;for(var t=0;t<$scope.circleList.length;t++){if($scope.circleList[t].piller.id==a)for(var s=0;s<$scope.activityList.length;s++)$scope.activityList[s].id==a&&($scope.activityList[s].circleFound=!0);for(var i=0;i<$scope.suggestionDet.suggestionHorizontalDept.length;i++)$scope.suggestionDet.suggestionHorizontalDept[i].circleId==$scope.circleList[t].id&&($scope.circleList[t].isEvalCircleselect=!0,$scope.circleList[t].isImplCircleselect=!0)}}else $scope.circleList=[]})},$scope.checkAndSetDeptLineListforLateral=function(i){i&&b.httpGet("getLineNameList/"+i).then(function(e){if(e.result)for(var t,s=0;s<$scope.departmentList.length;s++)$scope.departmentList[s].deptId==i&&(t=$filter("filter")(e.lineList,{isActive:"!N"},!0),$scope.departmentList[s].lineList=t,$scope.departmentList[s].lineList.push({name:"All",id:0}),$scope.departmentList[s].lineFound=!0)})},$scope.getDeptLineList=function(t){t&&b.httpGet("getLineNameList/"+t.deptId).then(function(e){e.result?(e=$filter("filter")(e.lineList,{isActive:"!N"},!0),t.lineList=e,t.lineList.push({name:"All",id:0}),t.lineFound=!0):t.lineFound=!1})},$scope.getImplDeptLineList=function(n,e){n&&b.httpGet("getLineNameList/"+n.deptId).then(function(e){if(n.isImplselect)if(n.lineFound||(n.lineList=[],n.lineList.push({lineId:0,name:"All",isImplselect:!1})),n.getMore=!1,e.result){for(var t=$filter("filter")(e.lineList,{isActive:"!N"},!0),s=0;s<t.length;s++){var i=!1;if(null!=n.lineList)for(var a=0;a<n.lineList.length;a++)n.lineList[a].lineId==t[s].id&&(i=!0);i||n.lineList.push({lineId:t[s].id,name:t[s].name,isImplselect:!1})}if(n.lineFound=!0,null!=$scope.suggestionDet.suggestionHorizontalDept&&0<$scope.suggestionDet.suggestionHorizontalDept.length&&null!=n.lineList&&0<n.lineList.length)for(let t=0;t<n.lineList.length;t++)for(let e=0;e<$scope.suggestionDet.suggestionHorizontalDept.length;e++)n.lineList[t].lineId!=$scope.suggestionDet.suggestionHorizontalDept[e].lineId||0==$scope.suggestionDet.suggestionHorizontalDept[e].lineId||1==n.lineList[t].isImplselect&&1==n.lineList[t].isEvalselect||(n.lineList[t].isImplselect=!0,n.lineList[t].isEvalselect=!0)}else n.lineFound=!1})},$scope.showDeptExesec=function(e){"department"==($scope.status=e)?($scope.departmentSection=!0,$scope.managementSection=!1,$scope.departmentLabel="Department",$scope.categoryLabel="Category",$scope.suggTitleLabel="Suggestion Title",$scope.suggDescLabel="Current Problem",$scope.suggestionLabel="Suggestion",$scope.DocumentLabel="Documents and images",$scope.categoryLabelVal="Please Select Category"):"management"==e&&($scope.managementSection=!0,$scope.departmentSection=!1,$scope.exeLabel="Executive",$scope.categoryLabel="Concern/Suggestion Category",$scope.suggTitleLabel="Concern/Suggestion Title",$scope.suggestionLabel="Concern/Suggestion Description",$scope.DocumentLabel="Documents and images",$scope.categoryLabelVal="Please Select Concern/Suggestion Category")},$scope.showDeptExesec("department"),$scope.getMasterUnitsList=function(){b.httpGet("getMasterUnits").then(function(e){e.result&&null!=e.unitList&&0<e.unitList.length?$scope.unitlistForparticular=e.unitList:$scope.unitlistForparticular=[]})},$scope.getMasterUnitsList(),$scope.getUnitDet=function(e){var t={};return t=null!=$scope.unitlistForparticular&&0<$scope.unitlistForparticular.length&&(e=parseInt(e),null!=(e=$filter("filter")($scope.unitlistForparticular,{id:e},!0)))&&0<e.length?e[0]:t},$scope.selectNewAllParticulars=function(){var e=!$scope.selectAllparticulars;$scope.selectAllparticulars=e;for(var t=0;t<$scope.particulars.length;t++)$scope.particulars[t].isSelected=$scope.selectAllparticulars},$scope.getImpactPer=function(e,t,s){var i=0;return s=s&&null!=s?s:"POSITIVE",(i=(i=null!=e&&""!=e&&null!=t&&""!=t&&0<e&&0<t?"NEGATIVE"==s?(t-e)/e*100:(e-t)/e*100:i)||0).toFixed(2)},$scope.form={},$scope.createNewSuggPopup=function(){if($scope.createNewSuggTitle="Create new suggestion",$scope.selectedEmp="",$scope.suggestionTitle="",$scope.sugession="",$scope.execId="",$scope.isAnonymous="",$scope.deptId="",$scope.suggestionSource.id=$scope.suggestionSourceList[0],$scope.problemAnalysis="",$scope.lineNameList=[],$scope.isEditSugg=!1,$scope.lineNameList=[],$scope.files=[],$scope.docFiles=[],$scope.suggImages=[],$scope.flagErrDept=!1,$scope.flagErrCat=!1,$scope.flagErrExec=!1,$scope.flagErrSource=!1,$scope.newSug={},$scope.particularsnew=[],$scope.form.createnewSuggForm.$setPristine(),$scope.form.createnewSuggForm.$setUntouched(),$scope.checkForHdConfig()||($scope.pillarfocus=!0),$scope.linefocus=!1,$scope.prodfocus=!1,$scope.machfocus=!1,$scope.prodfocus=!1,$("#createNewSugg").modal({backdrop:"static",keyboard:!1}),$scope.getAllBranchList(),$scope.newSug.addMachineFlagnew=!0,$scope.newSug.addMachineFlag=!1,$scope.newSug.addOperationFlagnew=!0,$scope.newSug.addOperationFlag=!1,E.empDetails.branch.branchName=E.empDetails.branch.name,$scope.newSug.branchId=E.empDetails.branch,null!=$scope.catbranchwise&&0<$scope.catbranchwise.length)for(let e=0;e<$scope.catbranchwise.length;e++)$scope.catbranchwise[e].catClass="";$scope.getCWAgencyList(),$scope.getNewParticular($scope.newSug.branchId.branchId),E.getOrgByAlies("dcmsugar")&&$scope.getSuggAccessList($scope.newSug.branchId.branchId)},$scope.newSug={},$scope.cwAgencyList=[],$scope.getCWAgencyList=function(){null!=$scope.cwAgencyList&&0<$scope.cwAgencyList.length||b.httpGet("getCWAgencyList/"+E.empDetails.organization.orgId).then(function(e){e.result&&null!=e.cwAgencyList&&0<e.cwAgencyList.length?$scope.cwAgencyList=e.cwAgencyList:$scope.cwAgencyList=[]})},$scope.addnewMachineATCreate=function(){null==$scope.newSug.machineNameNew||null==$scope.newSug.machineNameNew||""==$scope.newSug.machineNameNew?C.create($filter("translate")("Please_enter_machine_no"),4e3,"error"):($scope.data={machineName:$scope.newSug.machineNameNew,branchId:$scope.loggedInUserBranchId,isActive:"Y",productFamilyId:parseInt($scope.newSug.productId.id),stageId:parseInt($scope.newSug.stageId.id),productNo:{id:parseInt($scope.newSug.productNoId.id)}},b.httpPost($scope.data,"addMasterMachine").then(function(e){$scope.globalLoadingIndicator=!1,1==e.result?($scope.getmachineListByproductNoId($scope.newSug.productNoId.id),$scope.newSug.addMachineFlag=!1,C.create($filter("translate")("Machine_added_successfully"),4e3,"success")):100==e.statusCode?C.create(e.reason,4e3,"error"):C.create($filter("translate")("Something_went_wrong_Please_try_again"),4e3,"error")}))},$scope.setAddNewOperation=function(){consoleLog("In set Add Operation"),0==$scope.newSug.opertionId.id?$scope.newSug.addOperationFlag=!0:$scope.newSug.addOperationFlag=!1},$scope.addnewOperationATCreate=function(){null==$scope.newSug.newOperationType||null==$scope.newSug.newOperationType||""==$scope.newSug.newOperationType?C.create($filter("translate")("Please_enter_operation"),4e3,"error"):($scope.data={operationType:$scope.newSug.newOperationType,branchId:$scope.loggedInUserBranchId,isActive:"Y",masterProductNo:{id:parseInt($scope.newSug.productNoId.id)}},$scope.newSug.machineId&&($scope.data.machine={id:0},$scope.data.machine.id=parseInt($scope.newSug.machineId.id)),$scope.globalLoadingIndicator=!0,b.httpPost($scope.data,"addMasterOperation").then(function(e){$scope.globalLoadingIndicator=!1,1==e.result?($scope.newSug.machineId?($scope.data.machine={id:0},$scope.data.machine.id=parseInt($scope.newSug.machineId.id)):$scope.data.machine={id:0},$scope.getMasterOperationList($scope.newSug.productNoId.id,$scope.data.machine.id),$scope.newSug.addOperationFlag=!1,C.create($filter("translate")("operation_type_added_successfully"),4e3,"success")):100==e.statusCode?C.create(e.reason,4e3,"error"):C.create($filter("translate")("Something_went_wrong_Please_try_again"),4e3,"error")}))},$scope.frequncyList=[{id:1,name:"Monthly",value:"MONTHLY"},{id:1,name:"Once Off",value:"ONCEOFF"}],$scope.resetSelectedParticular=function(e){if(consoleLog(e),null!=$scope.particulars)for(var t=0;t<$scope.particulars.length;t++)null!=e&&e.id==$scope.particulars[t].id||($scope.particulars[t].isInitiatorSelected=!1)},$scope.isSuggPassOtherOrg=function(){var e=!1;return e=!$scope.isEmpty(E.empDetails)&&E.empDetails.hasOwnProperty("organization")&&-1<[1,28].indexOf(E.empDetails.organization.orgId)?!0:e},$scope.getDeptBranchWise=function(e){e=e||E.empDetails.branch.branchId,b.httpGet("getDepartmentListForSuggestion/"+e).then(function(e){null!=e.deptList&&0<e.deptList.length?$scope.deptbranchwise=e.deptList:$scope.deptbranchwise=[]})},$scope.getAllBranchList=function(){null!=$scope.allBranchList&&0<$scope.allBranchList.length||b.httpGet("getbranchlistbyorgid/"+E.empDetails.organization.orgId).then(function(t){if(t.result)if(null!=t.branchList&&0<t.branchList.length){var s=[];for(let e=0;e<t.branchList.length;e++)t.branchList[e].branchName=t.branchList[e].name,"Y"==t.branchList[e].isActive&&s.push(t.branchList[e]);$scope.allBranchList=s}else $scope.allBranchList=[];else $scope.allBranchList=[]})},$scope.getNewParticular=function(e){if(null!=$scope.particulars&&0<$filter("filter")($scope.particulars,{branch:{branchId:e}},!0).length){if(null!=$scope.particulars&&0!=$scope.particulars.length)for(let e=0;e<$scope.particulars.length;e++)$scope.particulars[e].isChecked=!1,$scope.particulars[e].selectedId=0,$scope.particulars[e].isInitiatorSelected=!1,$scope.particulars[e].selectedInitiatorData={},$scope.particulars[e].selectedEvalData={},$scope.particulars[e].selectedImplData={},$scope.particulars[e].existingValue="",$scope.particulars[e].value="",$scope.particulars[e].newValue="",$scope.particulars[e].evalExistingValue="",$scope.particulars[e].implExistingValue="",$scope.particulars[e].newInitImpactValue="",$scope.particulars[e].newImpactValue="",$scope.particulars[e].impactValue="",$scope.particulars[e].evalFrequency="",$scope.particulars[e].implFrequency=""}else b.httpGet("getCategoryListByBranchId/"+e).then(function(e){if(null!=e.catagoryList&&0<e.catagoryList.length){$scope.particulars=[],$scope.catbranchwise=e.catagoryList;for(var t=0;t<e.catagoryList.length;t++)if(null!=e.catagoryList[t].particulersList&&0<e.catagoryList[t].particulersList.length)for(var s=0;s<e.catagoryList[t].particulersList.length;s++)"Y"==e.catagoryList[t].particulersList[s].isActive&&(e.catagoryList[t].particulersList[s].branch=e.catagoryList[t].branch,e.catagoryList[t].particulersList[s].category=e.catagoryList[t],$scope.particulars.push(e.catagoryList[t].particulersList[s]));if(null!=$scope.particulars&&0!=$scope.particulars.length)for(let e=0;e<$scope.particulars.length;e++)$scope.particulars[e].isChecked=!1,$scope.particulars[e].selectedId=0,$scope.particulars[e].isInitiatorSelected=!1,$scope.particulars[e].selectedInitiatorData={},$scope.particulars[e].selectedEvalData={},$scope.particulars[e].selectedImplData={},$scope.particulars[e].existingValue="",$scope.particulars[e].value="",$scope.particulars[e].newValue="",$scope.particulars[e].evalExistingValue="",$scope.particulars[e].implExistingValue="",$scope.particulars[e].newInitImpactValue="",$scope.particulars[e].newImpactValue="",$scope.particulars[e].impactValue="",$scope.particulars[e].evalFrequency="",$scope.particulars[e].implFrequency=""}else $scope.particulars=[]})},$scope.changeCreateSuggBranch=function(e){$scope.newSug.deptId=void 0,$scope.newSug.line=void 0,$scope.newSug.catId=void 0,$scope.newSug.initiatorPart=void 0;var t=E.empDetails.branch;e&&!$scope.isEmpty(e)?(E.getOrgByAlies("dcmsugar")&&$scope.getSuggAccessList(e.branchId),$scope.getDeptBranchWise(e.branchId),$scope.getNewParticular(e.branchId)):(E.getOrgByAlies("dcmsugar")&&$scope.getSuggAccessList(t.branchId),$scope.getDeptBranchWise(t.branchId),$scope.getNewParticular(t.branchId))},$scope.newSugg={},$scope.createNewSuggestion=function(e,t){if(t){var s=new FormData,t="";if("department"==$scope.status){var s=new FormData($("#create-suggestion-form")[0]);if("Y"==$scope.suggFlowConfig.isSuggSrcEnbld&&null!=$scope.suggestionSourceList&&0<$scope.suggestionSourceList.length&&null!=$scope.suggestionSource.id.id&&null!=$scope.suggestionSource.id.id&&""!=$scope.suggestionSource.id.id&&s.append("suggestionSource.id",$scope.suggestionSource.id.id),s.append("orgId",E.empDetails.organization.orgId),"Y"==$scope.suggFlowConfig.isPlantEnbld){if($scope.isEmpty($scope.newSug.branchId))return void C.create("Please select plant",5e3,"error");s.append("branchId",$scope.newSug.branchId.branchId)}else s.append("branchId ",$scope.loggedInUserBranchId);1==$scope.newSug.isSelfImplemented?$scope.isSelfImplemented=1:$scope.isSelfImplemented=0,s.append("sourceType","portal"),s.append("isCntrlEnabled",$scope.suggFlowConfig.isCntrlEnbld),null!=$scope.newSug.line&&""!=$scope.newSug.line&&null!=$scope.newSug.line&&s.append("lineId",$scope.newSug.line.id);var i,a=$scope.loggedInEmpId;if($scope.newSug.isOnBehalf){if(!$scope.newSug.isOnBehalfType)return void C.create($filter("translate")("Please_select_on_behalf_of_someone"),3e3,"error");if("emp"==$scope.newSug.isOnBehalfType)s.append("isSuggOnBehalf","Y"),s.append("createdBy.empId",$scope.loggedInEmpId),s.append("empId",$scope.newSug.selectedEmp.empId),a=$scope.newSug.selectedEmp.empId;else{if(s.append("isSuggOnBehalf","Y"),s.append("cwId",$scope.newSug.cwId),s.append("cwName",$scope.newSug.cwName),s.append("cwAgencyId",$scope.newSug.cwAgency.id),s.append("cwEmpId",$scope.newSug.selectedCwEmp.empId),null==$scope.newSug.cwMobile||null==$scope.newSug.cwMobile||10!=$scope.newSug.cwMobile.length)return void C.create("Please enter valid mobile number",5e3,"error");s.append("contactNo",$scope.newSug.cwMobile),s.append("createdBy.empId",$scope.loggedInEmpId),s.append("cwSuggestion",!0),$scope.isSelfImplemented=a=0}}else s.append("isSuggOnBehalf","N"),s.append("createdBy.empId",$scope.loggedInEmpId),s.append("empId",$scope.loggedInEmpId);if("Y"==$scope.suggFlowConfig.isSelfImplementedEnbld&&s.append("isSelfImplemented",$scope.isSelfImplemented),t="createSugesstion",1==$scope.isEditSugg&&(s.append("sugId",$scope.suggestionDet.sugId),0<=(i=$scope.suggestionDet.sugesstionStatusAudit.length-1)&&s.append("statusId",$scope.suggestionDet.sugesstionStatusAudit[i].status_master.statusId),t="updateSugesstion"),null!=$scope.files&&0<$scope.files.length)for(var n in $scope.files)s.append("sugImg",$scope.files[n]);if(null!=$scope.docFiles&&0<$scope.docFiles.length)for(var n in $scope.docFiles)s.append("drawingDoc",$scope.docFiles[n]);if(null!=$scope.newSug.activityId&&null!=$scope.newSug.activityId&&""!=$scope.newSug.activityId&&s.append("pillar.id",$scope.newSug.activityId.id),null!=$scope.newSug.circleId&&null!=$scope.newSug.circleId&&""!=$scope.newSug.circleId&&(0<$scope.newSug.circleId.id&&null!=$scope.newSug.circleId&&null!=$scope.newSug.circleId&&""!=$scope.newSug.circleId&&s.append("circle.id",$scope.newSug.circleId.id),0<$scope.newSug.circleId.id&&null!=$scope.newSug.stageId&&null!=$scope.newSug.stageId&&""!=$scope.newSug.stageId&&s.append("stage.id",$scope.newSug.stageId.id),0<$scope.newSug.circleId.id&&null!=$scope.newSug.machineId&&null!=$scope.newSug.machineId&&""!=$scope.newSug.machineId&&s.append("machine.id",$scope.newSug.machineId.id),0<$scope.newSug.circleId.id&&null!=$scope.newSug.machinePartId&&null!=$scope.newSug.machinePartId&&""!=$scope.newSug.machinePartId&&s.append("machinePart.id",$scope.newSug.machinePartId.id),0<$scope.newSug.circleId.id&&null!=$scope.newSug.opertionId&&null!=$scope.newSug.opertionId&&""!=$scope.newSug.opertionId&&s.append("operation.id",$scope.newSug.opertionId.id),0<$scope.newSug.circleId.id&&null!=$scope.newSug.productId&&null!=$scope.newSug.productId&&""!=$scope.newSug.productId&&s.append("productFamily.id",$scope.newSug.productId.id),0<$scope.newSug.circleId.id)&&null!=$scope.newSug.productNoId&&null!=$scope.newSug.productNoId&&""!=$scope.newSug.productNoId&&s.append("masterProductNo.id",$scope.newSug.productNoId.id),null!=$scope.newSug.target&&null!=$scope.newSug.target&&""!=$scope.newSug.target&&"Y"==$scope.suggFlowConfig.isTargetEnbld?s.append("target",$scope.newSug.target):s.delete("target"),null!=$scope.newSug.benchmark&&null!=$scope.newSug.benchmark&&""!=$scope.newSug.benchmark&&"Y"==$scope.suggFlowConfig.isBenchmarkEnbld?s.append("benchmark",$scope.newSug.benchmark):s.delete("benchmark"),null!=$scope.newSug.catId&&null!=$scope.newSug.catId.catId&&null!=$scope.newSug.catId.catId&&""!=$scope.newSug.catId.catId&&s.append("catId",$scope.newSug.catId.catId),null!=$scope.newSug.deptId&&null!=$scope.newSug.deptId&&""!=$scope.newSug.deptId&&s.append("deptId",$scope.newSug.deptId.deptId),s.delete("activityId"),s.delete("firstName"),s.delete("circleId"),s.delete("stageId"),s.delete("machineId"),s.delete("machinePartId"),s.delete("opertionId"),s.delete("line"),s.delete("productId"),s.delete("newdeptId"),s.delete("newCatId"),s.delete("productNoId"),s.delete("newSuggCWId"),s.delete("newSuggCWName"),s.delete("newSuggCWMobNo"),s.delete("newSuggCWAgency"),"Y"==$scope.suggFlowConfig.parEnbledForInitiator&&null!=$scope.particulars&&0<$scope.particulars.length){var l=$filter("filter")($scope.particulars,{isInitiatorSelected:!0});if(1<l.length)return void C.create($filter("translate")("Please_select_only_one_benefit"),5e3,"error");if(null!=l&&0<l.length)for(let e=0;e<l.length;e++)if(l[e].tangible){var o=l[e];if(null==o.unit||""==o.unit||$scope.isEmpty(o.unit)||null==o.value||""==o.value||null==o.value)return void C.create($filter("translate")("Please_enter_value_and_unit_for_tangible_benefit"),5e3,"error")}var r=0;for(let e=0;e<$scope.particulars.length;e++)0==$scope.particulars[e].selectedId&&$scope.particulars[e].isInitiatorSelected?(s.append("customEvaluationParticularsList["+r+"].particular.id",$scope.particulars[e].id),s.append("customEvaluationParticularsList["+r+"].isActive","Y"),s.append("customEvaluationParticularsList["+r+"].roleId",4),s.append("customEvaluationParticularsList["+r+"].recommendedBy",a),s.append("customEvaluationParticularsList["+r+"].action","ADD"),$scope.particulars[e].tangible?(s.append("customEvaluationParticularsList["+r+"].unit",$scope.particulars[e].unit.unit),s.append("customEvaluationParticularsList["+r+"].masterUnit.id",$scope.particulars[e].unit.id),s.append("customEvaluationParticularsList["+r+"].frequency",$scope.particulars[e].frequency),s.append("customEvaluationParticularsList["+r+"].value",$scope.particulars[e].value),s.append("customEvaluationParticularsList["+r+"].existingValue",$scope.particulars[e].existingValue),s.append("customEvaluationParticularsList["+r+"].tangible",!0)):s.append("customEvaluationParticularsList["+r+"].tangible",!1),r++):0<$scope.particulars[e].selectedId&&($scope.particulars[e].isInitiatorSelected?$scope.checkBenefitsValue($scope.particulars[e])&&(s.append("customEvaluationParticularsList["+r+"].id",$scope.particulars[e].selectedId),s.append("customEvaluationParticularsList["+r+"].roleId",4),s.append("customEvaluationParticularsList["+r+"].recommendedBy",a),s.append("customEvaluationParticularsList["+r+"].particular.id",$scope.particulars[e].id),s.append("customEvaluationParticularsList["+r+"].action","UPDATE"),s.append("customEvaluationParticularsList["+r+"].isActive","Y"),$scope.particulars[e].tangible?(s.append("customEvaluationParticularsList["+r+"].unit",$scope.particulars[e].unit.unit),s.append("customEvaluationParticularsList["+r+"].masterUnit.id",$scope.particulars[e].unit.id),s.append("customEvaluationParticularsList["+r+"].value",$scope.particulars[e].value),s.append("customEvaluationParticularsList["+r+"].existingValue",$scope.particulars[e].existingValue),s.append("customEvaluationParticularsList["+r+"].frequency",$scope.particulars[e].frequency),s.append("customEvaluationParticularsList["+r+"].tangible",!0)):s.append("customEvaluationParticularsList["+r+"].tangible",!1)):(s.append("customEvaluationParticularsList["+r+"].id",$scope.particulars[e].selectedId),s.append("customEvaluationParticularsList["+r+"].roleId",4),s.append("customEvaluationParticularsList["+r+"].recommendedBy",a),s.append("customEvaluationParticularsList["+r+"].action","DELETE")),r++)}}else{if((s=new FormData($("#create-suggestion-form")[0])).delete("isAnonymous"),s.delete("problemAnalysis"),s.delete("deptId"),s.append("sourceType","portal"),1==$scope.isAnonymous?$scope.isAnonymous=1:$scope.isAnonymous=0,s.append("empId",$scope.loggedInEmpId),s.append("orgId",$scope.loggedInUserOrgId),"Y"==$scope.suggFlowConfig.isPlantEnbld){if($scope.isEmpty($scope.newSug.branchId))return void C.create("Please select plant",5e3,"error");s.append("branchId",$scope.newSug.branchId.branchId)}else s.append("branchId ",$scope.loggedInUserBranchId);if(s.append("isExecutive",1),s.append("isAnonymous",$scope.isAnonymous),null!=$scope.files&&0<$scope.files.length)for(var n in $scope.files)s.append("sugImg",$scope.files[n]);t="createSugesstion"}$scope.isBeforeUploadImageOn=E.empDetails.productOrgConfigDet.isBeforeUploadImageOn,""!=$scope.files||1!=E.empDetails.productOrgConfigDet.isBeforeUploadImageOn||$scope.isEditSugg?!$scope.isEditSugg||1!=E.empDetails.productOrgConfigDet.isBeforeUploadImageOn||null!=$scope.suggImages&&0!=$filter("filter")($scope.suggImages,{docType:"beforeDoc"},!0).length||""!=$scope.files?null==$scope.suggFlowConfig.isSuggFlowSetupcmpltd||"N"==$scope.suggFlowConfig.isSuggFlowSetupcmpltd||null==$scope.suggFlowConfig.isSuggFlowSetupcmpltd?C.create($filter("translate")("Suggestion_flow_setup_admin_department"),3e3,"error"):($scope.flagCreateSuggSpinner=!0,b.uploadFileToUrl(s,t).then(function(e){$scope.flagCreateSuggSpinner=!1,"department"==$scope.status?e.data.result?($("#createNewSugg").modal("hide"),localStorage.removeItem("recognitionObj"),T&&T.stop(),$scope.isRecognizing={},1==$scope.isEditSugg?(C.create($filter("translate")("Suggestion_modified_successfully"),5e3,"success"),$scope.getSuggestionDetails($scope.selectedSuggId),$scope.getsuggestionList("onLoad"),$scope.getStatusWiseCount()):($scope.newSugg.SuggId=e.data.suggestionNumber,$scope.suggCreatedTitle=$filter("translate")("Awesome"),$scope.suggCreatedMsg=$filter("translate")("Thank_you_for_submitting_your_suggestion_We_will_keep_you_updated_on_progress"),$scope.newSugg.SuggIdText="Created Suggestion Id: ",$("#successMsgCreateSugg").modal({backdrop:"static",keyboard:!1}))):100==e.data.statusCode?C.create(e.data.reason,5e3,"error"):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error"):($scope.suggCreatedTitle="",$scope.suggCreatedMsg=$filter("translate")("Your_concern_has_been_shared_We_will_keep_you_updating_about_the_progress"),e.data.result?($("#createNewSugg").modal("hide"),$("#successMsgCreateSugg").modal({backdrop:"static",keyboard:!1}),localStorage.removeItem("recognitionObj"),T&&T.stop(),$scope.isRecognizing={}):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error"))})):C.create($filter("translate")("Please_upload_the_Before_Image"),3e3,"error"):C.create($filter("translate")("Please_upload_the_Before_Image"),3e3,"error")}else angular.forEach(e.$error.required,function(e){e.$setDirty()})},$scope.resetLang=function(){localStorage.removeItem("recognitionObj"),T&&T.stop(),$scope.isRecognizing={}},$scope.clearImage=function(e,t){$scope.files.splice(e,1)},$scope.clearDocImage=function(e,t){$scope.docFiles.splice(e,1)},$scope.validateDropdown=function(e){if("suggestion"==e)return e=1,"department"!=$scope.status||$scope.deptId||0!=$scope.newSug.circleId||($scope.flagErrDept=!0,e=0),$scope.newSug.catId||($scope.flagErrCat=!0,e=0),"management"!=$scope.status||$scope.execId||($scope.flagErrExec=!0,e=0),0!=e},$scope.previewImageForCreateSugg=function(e){$scope.preiwImg=e},$scope.showPreviewImg=function(e,t){$scope.selectedDocIndex=e,$scope.viewerImages=t,$("#previewImg").modal({backdrop:"static",keyboard:!1});for(var s=0;s<$scope.viewerImages.length;s++)s==e?($scope.viewerImages[s].selected=!0,$("#previewImg .img-holder").attr("src",$scope.viewerImages[s].src)):$scope.viewerImages[s].selected=!1;$scope.previewImageForCreateSugg(t[e].src)},$scope.showPreviewImgForImpl=function(e,t){$scope.selectedDocIndex=e,$scope.viewerImages=t,$("#previewImg").modal({backdrop:"static",keyboard:!1});for(var s=0;s<$scope.viewerImages.length;s++)s==e?($scope.viewerImages[s].selected=!0,$("#previewImg .img-holder").attr("src",$scope.viewerImages[s].src)):$scope.viewerImages[s].selected=!1;$scope.previewImageForCreateSugg(t[e].imgsrcImpl)},$scope.getHelpText=function(e){return e==$scope.CONST.COUNT_FILTERS.PENDING?$scope.CONST.HELP_TEXT.PENDING_ACTION:e==$scope.CONST.COUNT_FILTERS.MY_SUGG?$scope.CONST.HELP_TEXT.MY_SUGGESTION:"all_sugg"==e?$scope.CONST.HELP_TEXT.ALL_SUGGESTION:void 0},$scope.evalSavingType={type:"",typeName:"cost",amt:"",points:0,role:""},$scope.getSavingType=function(){b.httpGet("getSavingOptionByBranchId/"+$scope.loggedInUserBranchId).then(function(e){if(e.result){$scope.savingTypes=e.savingOption,$scope.evalSavingType.typeName=$scope.savingTypes[0].name.toLowerCase();for(var t=0;t<$scope.savingTypes.length;t++)$scope.savingTypes[t].typeName=$scope.savingTypes[t].name.toLowerCase()}else $scope.savingTypes=[]})},$scope.savingOptionRoles=[],$scope.getSavingOption=function(e){if($scope.evalSavingType.option="",$scope.evalSavingType.amt="",$scope.evalSavingType.points=0,$scope.savingOptionRoles=[],$scope.savingCost=[],e){for(var t=0;t<$scope.savingTypes.length;t++)e==$scope.savingTypes[t].id&&($scope.evalSavingType.typeName=$scope.savingTypes[t].name.toLowerCase());b.httpGet("getSavingOptionRole/"+e).then(function(e){e.result?$scope.savingOptionRoles=e.savingOptionRole:$scope.savingOptionRoles=[]})}else $scope.savingOptionRoles=[]},$scope.savingCost=[],$scope.getSavingCost=function(e){e?b.httpGet("getPointsForSavingBySavingOptionsRoleId/"+e+"/"+$scope.evalSavingType.type.id+"/0").then(function(t){if(t.result){if(null!=t.setPointsForSavingList&&0<t.setPointsForSavingList.length)for(let e=0;e<t.setPointsForSavingList.length;e++)null!=t.setPointsForSavingList[e].role?t.setPointsForSavingList[e].amountRole=t.setPointsForSavingList[e].amountUpto+" ("+t.setPointsForSavingList[e].role.name+")":t.setPointsForSavingList[e].amountRole=t.setPointsForSavingList[e].amountUpto;$scope.savingCost=t.setPointsForSavingList}else $scope.savingCost=[]}):$scope.savingCost=[]},$scope.savingTypePoints=0,$scope.setPoint=function(e){for(var t=0;t<$scope.savingCost.length;t++)$scope.savingCost[t].id==e&&($scope.evalSavingType.points=$scope.savingCost[t].points)},$scope.SavingTypeLists=[],$scope.savingTypeBtn=!0,$scope.flagSavingTypeSubmitSpinner=!1,$scope.addSavingType=function(e){for(var t=angular.copy(e),s=-1,i=0;i<$scope.SavingTypeLists.length;i++)if($scope.SavingTypeLists[i].amt.id==t.amt.id){s=i;break}-1!=s?C.create($filter("translate")("Saving_type_already_added"),5e3,"error"):($scope.savingTypeBtn=!1,$scope.SavingTypeLists.push(t),$scope.evalSavingType={type:$scope.savingTypes[0],typeName:$scope.savingTypes[0].name.toLowerCase(),amt:"",points:0,role:""})},$scope.savingsMainTab=1,$scope.setSavingsTab=function(e){$scope.savingsMainTab=e},$scope.isSetSavingsTab=function(e){return $scope.savingsMainTab===e},$scope.resetSavingType=function(){$scope.evalSavingType={type:$scope.savingTypes[0].id.toString(),typeName:$scope.savingTypes[0].typename,amt:"",points:0},$scope.getSavingOption($scope.savingTypes[0].id),$scope.savingCost=[]},$scope.getValueFromList=function(e,t){for(var s=0;s<e.length;s++)if(e[s].id==t)return e[s]},$scope.removeSavingType=function(e){$scope.SavingTypeLists.splice(e,1)},$scope.DeleteSavingType=function(e){$scope.flagdeleteSpinner=!0,b.httpPost(e,"createEvaluationSuggestionPoints").then(function(e){$scope.flagdeleteSpinner=!1,$("#confirmRemModal").modal("hide"),e.result?(C.create($filter("translate")("Saving_type_deleted_successfully"),5e3,"success"),$scope.getSuggestionDetails($scope.selectedSuggId)):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")})},$scope.getBenefitPointsData=function(e,t){var s={dataFound:!1};return null!=$scope.suggestionDet.benefitPointsAudit&&0<$scope.suggestionDet.benefitPointsAudit.length&&null!=(e=$filter("filter")($scope.suggestionDet.benefitPointsAudit,{particularPoints:{id:e},roleId:t},!0))&&0<e.length&&(e[0].frequency=e[0].particularPoints.frequency,(s=e[0]).dataFound=!0),s},$scope.suggCatbranchwise={},$scope.getParticular=function(e){b.httpGet("getCategoryListByBranchId/"+e).then(function(e){if(null!=e.catagoryList&&0<e.catagoryList.length){$scope.particulars=[],$scope.categoryList=[],$scope.catbranchwise=[],$scope.catbranchwise=e.catagoryList,$scope.suggCatbranchwise.categorylistData=[],$scope.getCatagoryList=e.catagoryList;for(var t=0;t<$scope.getCatagoryList.length;t++)$scope.categoryList.push($scope.getCatagoryList[t]);for(t=0;t<e.catagoryList.length;t++)if(null!=e.catagoryList[t].particulersList&&0<e.catagoryList[t].particulersList.length)for(var s=0;s<e.catagoryList[t].particulersList.length;s++)"Y"==e.catagoryList[t].particulersList[s].isActive&&(e.catagoryList[t].particulersList[s].category=e.catagoryList[t],$scope.particulars.push(e.catagoryList[t].particulersList[s]));if($scope.suggCatbranchwise=e.catagoryList,null!=$scope.particulars&&0!=$scope.particulars.length)for(let t=0;t<$scope.particulars.length;t++)if($scope.particulars[t].isChecked=!1,$scope.particulars[t].selectedId=0,$scope.particulars[t].isInitiatorSelected=!1,$scope.particulars[t].selectedInitiatorData={},$scope.particulars[t].selectedEvalData={},$scope.particulars[t].selectedImplData={},$scope.particulars[t].existingValue="",$scope.particulars[t].value="",$scope.particulars[t].newValue="",$scope.particulars[t].evalExistingValue="",$scope.particulars[t].implExistingValue="",$scope.particulars[t].newInitImpactValue="",$scope.particulars[t].newImpactValue="",$scope.particulars[t].impactValue="",$scope.particulars[t].evalFrequency="",$scope.particulars[t].implFrequency="",!$scope.isEmpty($scope.suggestionDet)&&null!=$scope.suggestionDet.customEvaluationParticularsList&&0!=$scope.suggestionDet.customEvaluationParticularsList.length)for(let e=0;e<$scope.suggestionDet.customEvaluationParticularsList.length;e++)if($scope.suggestionDet.customEvaluationParticularsList[e].particular.id==$scope.particulars[t].id){var i=1;if("Y"==$scope.suggestionDet.customEvaluationParticularsList[e].isActive){if($scope.particulars[t].isChecked=!0,$scope.particulars[t].selectedInitiatorData=$scope.getBenefitPointsData($scope.suggestionDet.customEvaluationParticularsList[e].id,4),$scope.particulars[t].selectedInitiatorData.dataFound&&(i+=1,null!=$scope.suggestionDet.sugesstionStatusAudit)&&0<$scope.suggestionDet.sugesstionStatusAudit.length)for(let e=0;e<$scope.suggestionDet.sugesstionStatusAudit.length;e++)if($scope.suggestionDet.sugesstionStatusAudit[e].status_master.status==$scope.CONST.STATUS.AssignedForEdit.status&&"PENDING"==$scope.suggestionDet.sugesstionStatusAudit[e].actionStatus&&($scope.groupingParticular($scope.suggestionDet.category),null!=$scope.suggestionDet.customEvaluationParticularsList)&&0<$scope.suggestionDet.customEvaluationParticularsList.length)for(let t=0;t<$scope.suggestionDet.customEvaluationParticularsList.length;t++)if($scope.suggestionDet.customEvaluationParticularsList[t].catId==$scope.suggestionDet.category.catId)for(let e=0;e<$scope.particulars.length;e++)$scope.particulars[e].id==$scope.suggestionDet.customEvaluationParticularsList[t].particular.id&&($scope.particulars[e].isInitiatorSelected=!0,$scope.particulars[e].isSelected=!0,$scope.newSug.initiatorPart=$scope.particulars[e]);else for(let e=0;e<$scope.particulars.length;e++)$scope.particulars[e].id==$scope.suggestionDet.customEvaluationParticularsList[t].particular.id&&($scope.newSug.initiatorPart={id:0,particulars:"Other Benefits"},$scope.particulars[e].isInitiatorSelected=!0,$scope.particulars[e].isSelected=!0,$scope.resetPerticularsList($scope.newSug.initiatorPart));$scope.particulars[t].selectedEvalData=$scope.getBenefitPointsData($scope.suggestionDet.customEvaluationParticularsList[e].id,8),$scope.particulars[t].selectedEvalData.dataFound&&(i+=1),$scope.particulars[t].selectedImplData=$scope.getBenefitPointsData($scope.suggestionDet.customEvaluationParticularsList[e].id,9),$scope.particulars[t].selectedImplData.dataFound&&(i+=1)}$scope.particulars[t].selectedId=$scope.suggestionDet.customEvaluationParticularsList[e].id,$scope.particulars[t].roleId=$scope.suggestionDet.customEvaluationParticularsList[e].roleId||"",$scope.particulars[t].unit=$scope.suggestionDet.customEvaluationParticularsList[e].tangible?$scope.suggestionDet.customEvaluationParticularsList[e].masterUnit:"",$scope.particulars[t].value=$scope.suggestionDet.customEvaluationParticularsList[e].value||"",$scope.particulars[t].existingValue=$scope.suggestionDet.customEvaluationParticularsList[e].existingValue||"",$scope.particulars[t].newImpactValue=$scope.suggestionDet.customEvaluationParticularsList[e].existingValue||"",$scope.particulars[t].impactValue=$scope.getImpactPer($scope.particulars[t].existingValue,$scope.particulars[t].value,$scope.particulars[t].category.impactType),$scope.particulars[t].newInitImpactValue=$scope.getImpactPer($scope.particulars[t].existingValue,$scope.particulars[t].value,$scope.particulars[t].category.impactType);var a=[];null!=(a=$scope.suggestionDet.customEvaluationParticularsList[e].tangible?$filter("filter")($scope.frequncyList,{value:$scope.suggestionDet.customEvaluationParticularsList[e].frequency},!0):a)&&0<a.length&&($scope.particulars[t].evalFrequency=a[0],$scope.particulars[t].implFrequency=a[0]),$scope.particulars[t].frequency=$scope.suggestionDet.customEvaluationParticularsList[e].tangible&&$scope.suggestionDet.customEvaluationParticularsList[e].frequency?$scope.suggestionDet.customEvaluationParticularsList[e].frequency.toString():"",$scope.particulars[t].isActive=$scope.suggestionDet.customEvaluationParticularsList[e].isActive,$scope.particulars[t].rowSpan=i}if(!$scope.isEmpty($scope.suggestionDet)&&null!=$scope.suggestionDet.sugesstionStatusAudit&&0<$scope.suggestionDet.sugesstionStatusAudit.length)for(let e=0;e<$scope.suggestionDet.sugesstionStatusAudit.length;e++)"PENDING"!=$scope.suggestionDet.sugesstionStatusAudit[e].actionStatus||$scope.suggestionDet.sugesstionStatusAudit[e].status_master.status!=$scope.CONST.STATUS.ReassignedToEvaluationTeam.status&&$scope.suggestionDet.sugesstionStatusAudit[e].status_master.status!=$scope.CONST.STATUS.ReassignedToImplPostVerification.status||$scope.isCheckEvalImplAction()}else $scope.suggCatbranchwise=[],$scope.particulars=[]})},$scope.isCheckEvalImplAction=function(){if(null!=$scope.particulars&&0!=$scope.particulars.length)for(let t=0;t<$scope.particulars.length;t++)if($scope.particulars[t].isChecked=!1,null!=$scope.suggestionDet.customEvaluationParticularsList&&0!=$scope.suggestionDet.customEvaluationParticularsList.length)for(let e=0;e<$scope.suggestionDet.customEvaluationParticularsList.length;e++)$scope.suggestionDet.customEvaluationParticularsList[e].particular.id==$scope.particulars[t].id&&("Y"==$scope.suggestionDet.customEvaluationParticularsList[e].isActive&&($scope.particulars[t].isChecked=!0),$scope.particulars[t].selectedId=$scope.suggestionDet.customEvaluationParticularsList[e].id,$scope.particulars[t].isInitiatorSelected=!0,$scope.newSug.initiatorPart=$scope.particulars[t],$scope.particulars[t].newUnit=$scope.suggestionDet.customEvaluationParticularsList[e].masterUnit,$scope.particulars[t].newValue=$scope.suggestionDet.customEvaluationParticularsList[e].value||"",$scope.particulars[t].evalExistingValue=$scope.suggestionDet.customEvaluationParticularsList[e].existingValue||"",$scope.particulars[t].implExistingValue=$scope.suggestionDet.customEvaluationParticularsList[e].existingValue,$scope.particulars[t].newImpactValue=$scope.getImpactPer($scope.particulars[t].implExistingValue,$scope.particulars[t].newValue,$scope.particulars[t].category.impactType))},$scope.getParticular(E.empDetails.branch.branchId),$scope.selectParticular=function(e){1==angular.element(e).prop("checked")?angular.element(e).prop("checked",!1):angular.element(e).prop("checked",!0)},$scope.addParticulars=function(){var i=!1,a=($scope.flagParticularSubmitSpinner=!0,[]);$.each($("input[name='particularChk']:checked"),function(){for(var e,t=$(this).val(),s=0;s<$scope.particulars.length;s++)$scope.particulars[s].id==t&&(e=$scope.particulars[s],$scope.particulars[s].isChecked||(e={id:0,particular:{id:e.id},suggestion:{sugId:$scope.selectedSuggId},createdById:$scope.loggedInEmpId,sugCreatedByEmpId:$scope.suggestionDet.emp_details.empId,points:e.points},a.push(e)))}),$("input:checkbox:not(:checked)"),$.each($("input[name='particularChk']:not(:checked)"),function(){for(var e,t=$(this).val(),s=0;s<$scope.particulars.length;s++)$scope.particulars[s].id==t&&(e=$scope.particulars[s],$scope.particulars[s].isChecked)&&(e={id:e.selectedId,particular:{id:e.id},suggestion:{sugId:$scope.selectedSuggId},createdById:$scope.loggedInEmpId,sugCreatedByEmpId:$scope.suggestionDet.emp_details.empId,points:e.points},a.push(e),i=!0)}),null!=a&&0!=a.length&&b.httpPost(a,"createSuggestionParticulars").then(function(e){$scope.flagParticularSubmitSpinner=!1,e.result?(i?C.create($filter("translate")("Particular_deleted_successfully"),5e3,"success"):C.create(e.reason,5e3,"success"),$scope.getSuggestionDetails($scope.selectedSuggId)):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")})},$scope.flagDocBoxIndicator=!1,$scope.getSuggestionDocList=function(){$scope.flagDocBoxIndicator=!0,b.httpPost({sugId:$scope.selectedSuggId},"getSuggestionDocList").then(function(e){if($scope.flagDocBoxIndicator=!1,e.result){if($scope.SugDocumentLists=e.docList,null!=$scope.SugDocumentLists&&0!=$scope.SugDocumentLists.length){$scope.changeDocument=!0;for(var t=0;t<$scope.SugDocumentLists.length;t++)for(var s=0;s<$scope.documentLists.length;s++)$scope.SugDocumentLists[t].document_id==$scope.documentLists[s].id&&($scope.SugDocumentLists[t]=Object.assign({},$scope.SugDocumentLists[t],$scope.documentLists[s]))}}else $scope.SugDocumentLists=[]})},$scope.setSuggestionActivity=function(){for(var e,t=[],s=0;s<$scope.activityList.length;s++)$scope.activityList[s].isselect&&(e={id:0,suggestion:{sugId:$scope.selectedSuggId},activity:$scope.activityList[s]},t.push(e));for(var i=[],a=0;a<$scope.suggestionDet.suggestionActivityList.length;a++){for(var n=-1,l=-1,s=0;s<t.length;s++)if(t[s].activity.id==$scope.suggestionDet.suggestionActivityList[a].activity.id){n=a,l=s;break}-1!=n?t.splice(l,1):i.push($scope.suggestionDet.suggestionActivityList[a])}for(var o=0;o<t.length;o++)i.push(t[o]);0!=i.length&&b.httpPost(i,"createSuggestionActivity").then(function(e){e.result?(C.create($filter("translate")("Kaizen_activity_added_successfully"),4e3,"success"),$scope.getSuggestionDetails($scope.suggestionDet.sugId)):(100==e.statusCode?C.create(e.reason,4e3,"error"):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error"),$scope.activityList=[])})},$scope.selectDocument=function(e){1==angular.element(e).prop("checked")?angular.element(e).prop("checked",!1):angular.element(e).prop("checked",!0)},$scope.addDocuments=function(){$scope.flagDocSubmitSpinner=!0;var i=[];$.each($("input[name='docChk']:checked"),function(){for(var e,t=$(this).val(),s=0;s<$scope.documentLists.length;s++)$scope.documentLists[s].id==t&&($scope.documentLists[s],$scope.documentLists[s].isChecked||(e={suggestion:{sugId:$scope.selectedSuggId},branch:{branchId:$scope.suggestionDet.branch.branchId},document:{id:parseInt(t)}},i.push(e)))}),$("input:checkbox:not(:checked)"),$.each($("input[name='docChk']:not(:checked)"),function(){for(var e,t=$(this).val(),s=0;s<$scope.documentLists.length;s++)$scope.documentLists[s].id==t&&($scope.documentLists[s],$scope.documentLists[s].isChecked)&&(e={suggestion:{sugId:$scope.selectedSuggId},branch:{branchId:$scope.suggestionDet.branch.branchId},document:{id:parseInt(t)}},i.push(e),removeFlag=!0)}),null!=i&&0!=i.length&&b.httpPost(i,"documentassignedbyeval").then(function(e){e.result?($scope.flagDocSubmitSpinner=!1,$scope.getSuggestionDetails($scope.selectedSuggId),$scope.getSuggestionDocList(),C.create($filter("translate")("Documents_Suggestion_will_once_implemented_implementer"),5e3,"success")):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")})},$scope.SuggestionTemplate={},$scope.hdConfigData={},$scope.getSuggestionConfigId=function(e){for(var t=-1,s=0;s<$scope.suggHDConfigList.length;s++)if($scope.suggHDConfigList[s].configMaster.id==e){t=$scope.suggHDConfigList[s];break}return t},$scope.initMasterDataForSugg=function(){var e={branchId:$scope.loggedInUserBranchId,orgId:$scope.loggedInUserOrgId,roleIds:[4,6,8,9]};b.httpPost(e,"initmasterdataforsugg").then(function(t){if(t.result){if(null!=t.savingOption&&0<t.savingOption.length?($scope.savingTypes=t.savingOption,$scope.getSavingOption($scope.savingTypes[0].id)):$scope.savingTypes=[],$scope.documentLists=null!=t.document?t.document:[],$scope.deptbranchwise=t.deptListForSugg,null!=t.benefitAnalysisList){for(let e=0;e<t.benefitAnalysisList.length;e++)t.benefitAnalysisList[e].isselect=!1,t.benefitAnalysisList[e].isBenefitChecked=!1;$scope.benefitList=t.benefitAnalysisList}else $scope.benefitList=[];if($scope.orgLevelBenefitMasterList=null!=t.orgLevelBenefitMasterList?t.orgLevelBenefitMasterList:[],$scope.catagoryList=[],$scope.catbranchwise=[],null!=t.catagoryList){$scope.catagoryList.push({categoryName:"All"});for(var e=0;e<t.catagoryList.length;e++)$scope.catagoryList.push(t.catagoryList[e]);$scope.suggDetailModel.catFilter=$scope.catagoryList[0],$scope.listFilter.catagoryList=angular.copy($scope.catagoryList)}if($scope.departmentList=[],null!=t.deptList&&0<t.deptList.length){$scope.departmentList.push({deptName:"All"});for(e=0;e<t.deptList.length;e++)$scope.departmentList.push(t.deptList[e]);$scope.suggDetailModel.deptFilter=$scope.departmentList[0],$scope.listFilter.departmentList=angular.copy($scope.departmentList)}if($scope.activityList=[],null!=t.activityList&&($scope.activityList=t.activityList),$scope.suggDetailModel.deptFilter=$scope.departmentList[0],$scope.activityList=[],null!=t.activityList&&($scope.activityList=t.activityList,$scope.listFilter.activityList=angular.copy($scope.activityList)),null!=t.statusList&&0<t.statusList.length){for(var s=[{label:"All"}],e=0;e<t.statusList.length;e++)t.statusList[e].isSelected=!1,s.push(t.statusList[e]);$scope.suggDetailModel.statusList=s,$scope.listFilter.statusList=angular.copy($scope.suggDetailModel.statusList),$scope.suggestionPagination.selectedStatus=null}if(null!=t.suggestionTemplate&&0<t.suggestionTemplate.length?$scope.SuggestionTemplate=t.suggestionTemplate[0]:$scope.SuggestionTemplate=null,null!=t.suggestionEvalMstrNomination&&0<t.suggestionEvalMstrNomination.length&&($scope.suggestionEvalMstrNomination=t.suggestionEvalMstrNomination[0]),null!=t.branchList){$scope.branchListNew=t.branchList;for(var i=0;i<$scope.branchListNew.length;i++)$scope.branchListNew[i].branchName=$scope.branchListNew[i].name,$scope.branchListNew[i].isSelected=!0,$scope.selectAllBranch=!0;$scope.mySuggBranchlist=angular.copy($scope.branchListNew),$scope.pendingBranchlist=angular.copy($scope.branchListNew),1==$scope.statusCountFilter&&($scope.accessBranchList=$scope.pendingBranchlist)}var a,n;$scope.suggHDConfigList=[],null!=t.suggConfigList&&0<t.suggConfigList.length&&($scope.suggHDConfigList=t.suggConfigList,$scope.suggMasterConfigList=t.suggConfigMasterList,$scope.masterConfigObj=$scope.suggMasterConfigList.reduce((e,t,s)=>(e[t.configCaption]=t,e),{}),a=$scope.getSuggestionConfigId($scope.masterConfigObj.plantEvalType.id),n=$scope.getSuggestionConfigId($scope.masterConfigObj.createHDSugg.id),$scope.hdConfigData.hdLevel=a.configValue,$scope.hdConfigData.hdOptions=n.configValue)}$scope.typeFilter=$scope.defaultFilter,$scope.selectFilterList(),$scope.applyFilter($scope.typeFilter)})},$scope.suggHDConfigList=[],$scope.checkForHdConfig=function(){return null==$scope.hdConfigData.hdLevel||"DEPT"==$scope.hdConfigData.hdLevel||0==$scope.suggHDConfigList.length},$scope.files1=[],$scope.getFileDetails1=function(s){$scope.$apply(function(){if(0<$scope.files1.length)C.create($filter("translate")("Only_one_image_upload"),5e3,"error");else for(var e=0;e<s.files.length;e++){var t=s.files[e].type.split("/")[1];if("jpg"!=angular.lowercase(t)&&"jpeg"!=angular.lowercase(t)&&"png"!=angular.lowercase(t))return void C.create($filter("translate")("Only_image_files_are_allowed_upload"),5e3,"error");$scope.files1.push(s.files[e])}}),0<$scope.files1.length&&$scope.uploadPic($scope.files1)},$scope.uploadPic=function(e){var t,s=new FormData;for(t in e)s.append("sugImg",e[t]);s.append("sugId",$scope.suggestionDet.sugId),b.uploadFileToUrl(s,"saveBeforeSuggestionImageDoc").then(function(e){e.data.result?(C.create($filter("translate")("Document_upload_succesfully"),3e3,"success"),$scope.getSuggestionListOnUpdate(),$scope.files1=[]):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")})},$scope.beforeImgId="",$scope.removeBeforeImg=function(e){$scope.beforeImgId=e,$("#confirmRemImgModal").modal({backdrop:"static",keyboard:!1})},$scope.clearDocument=function(e){$scope.flagdeleteSpinner=!0,b.httpGet("removesugesstiondoc/"+e).then(function(e){$scope.flagdeleteSpinner=!1,e.result?($("#confirmRemImgModal").modal("hide"),C.create($scope.langTranslate.Document_deleted_succesfully,3e3,"success"),$scope.getsuggestionList("onUpdate"),$scope.beforeImgId=""):100==e.statusCode?C.create(e.reason,5e3,"error"):C.create($scope.langTranslate.Oops_Please_try_again,5e3,"error")})},$scope.setAllDept=function(e,t){e.isselect=!e.isselect;for(var s=!1,i=0;i<$scope.departmentList.length;i++)"all"==t?e.isselect?$scope.departmentList[i].isselect=!0:$scope.departmentList[i].isselect=!1:"All"==$scope.departmentList[i].deptName&&($scope.departmentList[i].isselect=!1),$scope.departmentList[i].isselect&&(s=!0);$scope.suggestionDet.hdSelected=!s},$scope.setLine=function(e,t,s){if("single"==t){e.isselect=!e.isselect;for(var i=0;i<s.length;i++)"All"==s[i].name&&(s[i].isselect=!1)}else if("All"==t){e.isselect=!e.isselect;for(i=0;i<s.length;i++)s[i].isselect=e.isselect}},$scope.setEvalAllDept=function(e,t){e.isEvalselect=!e.isEvalselect;for(var s=!1,i=0;i<$scope.departmentList.length;i++)"all"==t?e.isEvalselect?$scope.departmentList[i].isEvalselect=!0:$scope.departmentList[i].isEvalselect=!1:"All"==$scope.departmentList[i].deptName&&($scope.departmentList[i].isEvalselect=!1),$scope.departmentList[i].isEvalselect&&(s=!0);$scope.suggestionDet.hdSelected=!s},$scope.setEvalLine=function(e,t,s){if("single"==t){e.isEvalselect=!e.isEvalselect;for(var i=0;i<s.length;i++)"All"==s[i].name&&(s[i].isEvalselect=!1)}else if("All"==t){e.isEvalselect=!e.isEvalselect;for(i=0;i<s.length;i++)$scope.suggestionDet.lineId!=s[i].id&&(s[i].isEvalselect=e.isEvalselect)}},$scope.setImplLine=function(e,t,s){if("single"==t){e.isImplselect=!e.isImplselect;for(var i=0;i<s.length;i++)"All"==s[i].name&&(s[i].isImplselect=!1)}else if("All"==t){e.isImplselect=!e.isImplselect;for(i=0;i<s.length;i++)$scope.suggestionDet.lineId!=s[i].id&&(s[i].isImplselect=e.isImplselect)}},$scope.getSuggestionListForNomination=function(){$scope.data={branchId:E.empDetails.branch.branchId,empId:$scope.loggedInEmpId},b.httpPost($scope.data,"getSuggestionForNomination").then(function(e){$scope.popupTitle="Suggestions List",$("#mySuggestionListModal").modal({backdrop:"static",keyboard:!1}),e.result?$scope.suggListForNomination=e.list:$scope.suggListForNomination=[]})},$scope.submitSuggestionForNomination=function(){for(var e,t=[],s=0;s<$scope.suggListForNomination.length;s++)null!=$scope.suggListForNomination[s].isSelected&&$scope.suggListForNomination[s].isSelected&&(e={nominationId:$scope.suggestionEvalMstrNomination.id,sugId:$scope.suggListForNomination[s].sugId,empId:$scope.loggedInEmpId,branchId:$scope.loggedInUserBranchId},t.push(e));0==t.length?C.create($filter("translate")("Please_select_suggestion"),8e3,"error"):b.httpPost(t,"nominateSuggestion").then(function(e){e.result?($("#mySuggestionListModal").modal("hide"),C.create($filter("translate")("Suggestion_succesfully_nominated"),3e3,"success"),$scope.getStatusWiseCount(),$scope.getsuggestionList("onUpdate"),$scope.getJuryTopKiazenList(),$scope.getJueryStatusList()):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")})},$scope.setNominateSuggRating=function(e,t){for(var s=0;s<e.length;s++)e[s].isSelected=t==s},$scope.toastPopup=function(){$("#minSuggModal").modal({backdrop:"static",keyboard:!1})},$scope.minSuggPopup=!1,$scope.minSugCount=0,$scope.getPendingSuggestionSubmission=function(){var e=new Date,t=e.getDate(),s=e.getMonth()+1,i=e.getFullYear()+"-"+(s<10?"0":"")+s+"-"+(t<10?"0":"")+t;b.httpGet("getPendingSuggestionSubmissionInfo/"+$scope.loggedInEmpId).then(function(e){e.result?null!=e.list&&0<e.list.length&&(0<(e=(e=e.list[0]).suggLimit-e.suggestionSubmitted)?($scope.minSugCount=e,$scope.minSuggPopup=!0):(localStorage.setItem("toastDate",i),$scope.minSuggPopup=!1)):(localStorage.setItem("toastDate",i),$scope.minSuggPopup=!1)})},$scope.closePopup=function(){var e=new Date,t=e.getDate(),s=e.getMonth()+1,e=e.getFullYear();localStorage.setItem("toastDate",e+"-"+(s<10?"0":"")+s+"-"+(t<10?"0":"")+t),$scope.minSuggPopup=!1},$scope.getSavingType();var g=localStorage.getItem("toastDate"),I=((null==g||""==g||null==g||(a=(u=new Date).getDate(),n=u.getMonth()+1,u.getFullYear()+"-"+(n<10?"0":"")+n+"-"+(a<10?"0":"")+a<g))&&$scope.getPendingSuggestionSubmission(),$scope.showonBehafEmployeeList=function(){$scope.getEmployeeList($scope.loggedInUserBranchId),$("#addonBehafEmployee").modal({backdrop:"static",keyboard:!1})},$scope.setSelectedOnbehalfEmp=function(e){$("#addonBehafEmployee").modal("hide"),$scope.selectedEmp=e},$scope.getEmployeeList=function(e){null!=$scope.employeeList&&0<$filter("filter")($scope.employeeList,{branch:{branchId:e}},!0).length?($scope.flagTeamDetNotAvailMsg=!1,$scope.flagTeamDetPopupLoading=!1,$scope.empListByTeamType=angular.copy($scope.employeeList)):($scope.flagEmployeeListSpinner=!0,b.httpPost({branchIds:[e]},"getAllEmpListByBrannchIds").then(function(t){if($scope.flagTblemployee=!0,$scope.flagTeamDetNotAvailMsg=!1,$scope.flagTeamDetPopupLoading=!1,t.result)if(null!=t.allEmpDetails&&0<t.allEmpDetails.length){for(let e=0;e<t.allEmpDetails.length;e++){var s="";t.allEmpDetails[e].firstName&&(s+=t.allEmpDetails[e].firstName),t.allEmpDetails[e].lastName&&(t.allEmpDetails[e].firstName&&(s+=" "),s+=t.allEmpDetails[e].lastName),t.allEmpDetails[e].cmpyEmpId&&(s+=" ("+t.allEmpDetails[e].cmpyEmpId+")"),t.allEmpDetails[e].empName=s,t.allEmpDetails[e].selectedId=0}$scope.employeeList=t.allEmpDetails,$scope.empListByTeamType=angular.copy(t.allEmpDetails)}else $scope.employeeList=[],$scope.empListByTeamType=[];else $scope.employeeList=[],$scope.empListByTeamType=[]}))},$scope.getEmployeeList($scope.loggedInUserBranchId),$scope.selectedEmpList=[],$scope.setSelectedTeamMember=function(e){if(e.isSelected=!e.isSelected,e.isSelected)$scope.selectedEmpList.push(e);else for(var t=0;t<$scope.selectedEmpList.length;t++)$scope.selectedEmpList[t].empId==e.empId&&$scope.selectedEmpList.splice(t,1)},$scope.removeSelectedTeamMember=function(e,t){$scope.selectedEmpList.splice(t,1);for(var s=0;s<$scope.employeeList.length;s++)$scope.employeeList[s].empId==e.empId&&($scope.employeeList[s].isSelected=!1)},$scope.setLateralTab=function(e){1!=($scope.lateralTab=e)&&2==e&&$scope.isSet(1)},$scope.isSetLateralTab=function(e){return $scope.lateralTab===e},$scope.setLateralTab(1),$scope.currentlateralform={},$scope.initatorClear=function(e){$scope.currentlateralform=e},$scope.closeLateralForm=function(){$scope.currentlateralform.createInitiatorLateralEntryForm.$setPristine(),$scope.currentlateralform.createEvaluatorLateralEntryForm.$setPristine(),$scope.currentlateralform.createNewlateralEntryForm.$setPristine(),$scope.laterlEnteryDet.flagFirstTab=!1,$scope.laterlEnteryDet.flagSecondTab=!1,$scope.newdeptfocus=!1},$scope.setlateralFormDate=function(e){"initiator"!==e&&("evaluator"===e?$scope.laterlEntery.lateralEvalDate=$scope.laterlEntery.lateralInitiatorDate:"implementer"===e&&($scope.laterlEntery.lateralImpleDate=$scope.laterlEntery.lateralEvalDate))},$scope.laterlEvalutionList=function(){b.httpGet("getlistofusersbranchwise/"+$scope.loggedInUserBranchId+"/0/0/8").then(function(e){e.result?$scope.evalulterLateralList=e.deptlvlusersList:$scope.evalulterLateralList=[]})},$scope.laterlimplList=function(){var e={orgId:E.empDetails.organization.orgId,branchId:E.empDetails.branch.branchId,userType:{id:3}};b.httpPost(e,"getSuggestionUserDetails").then(function(e){$scope.flagTeamDetPopupLoading=!1,e.result&&null!=e.list&&0<e.list.length?$scope.implLateralList=e.list:$scope.implLateralList=[]})},$scope.getlateralDeptLineList=function(t){t&&b.httpGet("getLineNameList/"+t.deptId).then(function(e){$scope.linefocus=!0,e.result?(e=$filter("filter")(e.lineList,{isActive:"!N"},!0),t.lineList=e,t.lineList.push({name:"All",id:0}),t.lineFound=!0,$scope.newdeptfocus=!1):t.lineFound=!1})},$scope.setLateralDept=function(e,t){e.isLateralselect=!e.isLateralselect;for(var s=0;s<$scope.departmentList.length;s++)"all"==t?e.isLateralselect?$scope.departmentList[s].isLateralselect=!0:$scope.departmentList[s].isLateralselect=!1:"All"==$scope.departmentList[s].deptName&&($scope.departmentList[s].isLateralselect=!1)},$scope.setLateralLine=function(e,t,s){if("single"==t){e.isLateralselect=!e.isLateralselect;for(var i=0;i<s.length;i++)"All"==s[i].name&&(s[i].isLateralselect=!1)}else if("All"==t){e.isLateralselect=!e.isLateralselect;for(i=0;i<s.length;i++)$scope.laterlEntery.line.id!=s[i].id&&(s[i].isLateralselect=e.isLateralselect)}},$scope.createLateralEntryPopup=function(){$scope.laterlEnteryDet.flagFirstTab=!1,$scope.laterlEnteryDet.flagSecondTab=!1,$scope.setLateralTab(1),$scope.laterlEntery={},$scope.selectedEmpList=[],$scope.laterlEntery={},$scope.evalMachineHDList={},$scope.files=[],$scope.implFiles=[],$scope.resultImageFiles=[],$scope.currentlateralform.createInitiatorLateralEntryForm.$setPristine();for(var t=0;t<$scope.employeeList.length;t++)$scope.employeeList[t].isSelected=!1;for(t=0;t<$scope.documentLists.length;t++)$scope.documentLists[t].isChecked=!1;for(t=0;t<$scope.activityList.length;t++)$scope.activityList[t].isselect=!1;for(t=0;t<$scope.departmentList.length;t++)if($scope.departmentList[t].isLateralselect=!1,null!=$scope.departmentList[t].lineList&&0<$scope.departmentList[t].lineList.length)for(let e=0;e<$scope.departmentList[t].lineList.length;e++)$scope.departmentList[t].lineList[e].isLateralselect=!1;for(t=0;t<$scope.benefitList.length;t++)$scope.benefitList[t].isselect=!1;for(let e=0;e<$scope.hDBranchList.length;e++)$scope.hDBranchList[e].isEvalPlantselect=!1;$scope.laterlEntery.tmpIsDocumentChangeRequire=!1,$scope.getParticular(E.empDetails.branch.branchId),$scope.laterlEvalutionList(),$scope.machineHDList=[],$scope.laterlimplList(),$("#addLateralEntry").modal({backdrop:"static",keyboard:!1})},$scope.laterlEntery={},$scope.laterlEnteryDet={},$scope.createInitiatorlateralEntry=function(e){e.$invalid?angular.forEach(e.$error.required,function(e){e.$setDirty()}):($scope.laterlEnteryDet.flagFirstTab=!0,$scope.setLateralTab(2))},$scope.createEvaluatorLateralEntry=function(e){e.$invalid?angular.forEach(e.$error.required,function(e){e.$setDirty()}):($scope.laterlEnteryDet.flagSecondTab=!0,$scope.setLateralTab(3))},$scope.evalMachineHDList={},$scope.resetLateralHDVal=function(e){"circle"==e?($scope.lateralHDStageList=[],$scope.lateralHDProdFamilyList=[],$scope.lateralHDProdNoList=[],$scope.lateralHDMachineList=[],$scope.lateralHDOperationList=[],$scope.evalMachineHDList.stage=void 0,$scope.evalMachineHDList.product=void 0,$scope.evalMachineHDList.productNo=void 0,$scope.evalMachineHDList.machine=void 0,$scope.evalMachineHDList.operation=void 0):"stage"==e?($scope.lateralHDProdFamilyList=[],$scope.lateralHDProdNoList=[],$scope.lateralHDMachineList=[],$scope.lateralHDOperationList=[],$scope.evalMachineHDList.product=void 0,$scope.evalMachineHDList.productNo=void 0,$scope.evalMachineHDList.machine=void 0,$scope.evalMachineHDList.operation=void 0):"prodFamily"==e?($scope.lateralHDProdNoList=[],$scope.lateralHDMachineList=[],$scope.lateralHDOperationList=[],$scope.evalMachineHDList.productNo=void 0,$scope.evalMachineHDList.machine=void 0,$scope.evalMachineHDList.operation=void 0):"prodNo"==e?($scope.lateralHDMachineList=[],$scope.lateralHDOperationList=[],$scope.evalMachineHDList.machine=void 0,$scope.evalMachineHDList.operation=void 0):"machine"==e&&($scope.lateralHDOperationList=[],$scope.evalMachineHDList.operation=void 0)},$scope.getLateralHDStageListByCircleId=function(e){$scope.resetLateralHDVal("circle"),b.httpGet("getMasterStageByCircleId/"+$scope.loggedInUserBranchId+"/"+e).then(function(e){e.result&&null!=e.masterStageList&&0<e.masterStageList.length?$scope.lateralHDStageList=e.masterStageList:$scope.lateralHDStageList=[]})},$scope.getLateralHDProductFamilyListByStageId=function(e){$scope.resetLateralHDVal("stage"),b.httpGet("getProductFamilyByStage/"+$scope.loggedInUserBranchId+"/"+e).then(function(e){e.result&&null!=e.masterProductFamilyList&&0<e.masterProductFamilyList.length?$scope.lateralHDProdFamilyList=e.masterProductFamilyList:$scope.lateralHDProdFamilyList=[]})},$scope.getLatralHDProductNoListByproductId=function(e){$scope.resetLateralHDVal("prodFamily"),$scope.data={branchId:$scope.loggedInUserBranchId,productFamilyId:e},b.httpPost($scope.data,"getProductNo").then(function(e){e.result&&null!=e.productNoList&&0<e.productNoList.length?$scope.lateralHDProdNoList=e.productNoList:$scope.lateralHDProdNoList=[]})},$scope.getLatralHDMachineListByproductNoId=function(t){$scope.resetLateralHDVal("prodNo"),b.httpGet("getMachineListByProductNo/"+$scope.loggedInUserBranchId+"/"+t).then(function(e){e.result&&null!=e.masterMachineList&&0<e.masterMachineList.length?$scope.lateralHDMachineList=e.masterMachineList:($scope.lateralHDMachineList=[],t&&$scope.getLateralHDOperationList(data,0))})},$scope.getLateralHDOperationList=function(e,t){$scope.resetLateralHDVal("machine"),$scope.data={branchId:$scope.loggedInUserBranchId,productNoId:e,machineId:t||0},b.httpPost($scope.data,"getMasterOperationList").then(function(e){e.result&&null!=e.masterOperationlist&&0<e.masterOperationlist.length?$scope.lateralHDOperationList=e.masterOperationlist:$scope.lateralHDOperationList=[]})},$scope.createNewlateralEntry=function(e,t){if(e){var s=new FormData;if(s.append("orgId",$scope.loggedInUserOrgId),s.append("branchId ",$scope.loggedInUserBranchId),s.append("sourceType","portal"),s.append("createdBy",$scope.loggedInEmpId),s.append("tmtypeId",2),s.append("empId",$scope.laterlEntery.empId.empId),s.append("cntrlEmpId",$scope.laterlEntery.cntrlEmpId.empId),null!=$scope.laterlEntery.suggestionSource&&null!=$scope.laterlEntery.suggestionSource&&s.append("suggestionSource",$scope.laterlEntery.suggestionSource.id.id),null!=$scope.laterlEntery.catId&&null!=$scope.laterlEntery.catId&&s.append("catId",$scope.laterlEntery.catId.catId),null!=$scope.laterlEntery.suggestionTitle&&null!=$scope.laterlEntery.suggestionTitle&&s.append("suggestionTitle",$scope.laterlEntery.suggestionTitle),null!=$scope.laterlEntery.problemAnalysis&&null!=$scope.laterlEntery.problemAnalysis&&s.append("problemAnalysis",$scope.laterlEntery.problemAnalysis),null!=$scope.laterlEntery.sugession&&null!=$scope.laterlEntery.sugession&&s.append("suggestion",$scope.laterlEntery.sugession),null!=$scope.laterlEntery.deptId&&null!=$scope.laterlEntery.deptId&&""!=$scope.laterlEntery.deptId&&s.append("deptId",$scope.laterlEntery.deptId.deptId),null!=$scope.laterlEntery.line&&s.append("lineId",$scope.laterlEntery.line.id),1!=E.empDetails.productOrgConfigDet.isBeforeUploadImageOn||null!=$scope.files&&0!=$scope.files.length&&null!=$scope.implFiles&&0!=$scope.implFiles.length){if(null!=$scope.files&&0<$scope.files.length)for(var i in $scope.files)s.append("sugImg",$scope.files[i]);if(null!=$scope.implFiles&&0<$scope.implFiles.length)for(var i in $scope.implFiles)s.append("afterImg",$scope.implFiles[i]);if(null!=$scope.laterlEntery.activityId&&null!=$scope.laterlEntery.activityId&&""!=$scope.laterlEntery.activityId&&s.append("pillarId",$scope.laterlEntery.activityId.id),null!=$scope.laterlEntery.circleId&&null!=$scope.laterlEntery.circleId&&(0<$scope.laterlEntery.circleId.id&&null!=$scope.laterlEntery.circleId&&null!=$scope.laterlEntery.circleId&&""!=$scope.laterlEntery.circleId&&s.append("circleId",$scope.laterlEntery.circleId.id),null!=$scope.laterlEntery.stageId&&null!=$scope.laterlEntery.stageId&&""!=$scope.laterlEntery.stageId&&s.append("stageId",$scope.laterlEntery.stageId.id),null!=$scope.laterlEntery.machineId&&null!=$scope.laterlEntery.machineId&&""!=$scope.laterlEntery.machineId&&s.append("machineId",$scope.laterlEntery.machineId.id),null!=$scope.laterlEntery.opertionId&&null!=$scope.laterlEntery.opertionId&&""!=$scope.laterlEntery.opertionId&&s.append("operationId",$scope.laterlEntery.opertionId.id),null!=$scope.laterlEntery.productNoId&&null!=$scope.laterlEntery.productNoId&&""!=$scope.laterlEntery.productNoId&&s.append("masterProductNo.id",$scope.laterlEntery.productNoId.id),null!=$scope.laterlEntery.productId)&&null!=$scope.laterlEntery.productId&&""!=$scope.laterlEntery.productId&&s.append("productId",$scope.laterlEntery.productId.id),null!=$scope.laterlEntery.target&&null!=$scope.laterlEntery.target&&""!=$scope.laterlEntery.target&&s.append("target",$scope.laterlEntery.target),null!=$scope.laterlEntery.benchmark&&null!=$scope.laterlEntery.benchmark&&""!=$scope.laterlEntery.benchmark&&s.append("benchmark",$scope.laterlEntery.benchmark),s.append("evalEmpId",$scope.laterlEntery.evalEmpId.empId),null!=$scope.laterlEntery.evaluationInputs&&null!=$scope.laterlEntery.evaluationInputs&&s.append("summary",$scope.laterlEntery.evaluationInputs),null!=$scope.whyWhyAnalysisforImpl)for(var a=0;a<$scope.whyWhyAnalysisforImpl.length;a++)""!=$scope.whyWhyAnalysisforImpl[a].whyWhyAnalysis&&s.append("suggestionWhyWhyAnalysis["+a+"].name",$scope.whyWhyAnalysisforImpl[a].whyWhyAnalysis);null!=$scope.laterlEntery.whatToDo&&null!=$scope.laterlEntery.whatToDo&&""!=$scope.laterlEntery.whatToDo&&s.append("whatToDo",$scope.laterlEntery.whatToDo),null!=$scope.laterlEntery.howToDo&&null!=$scope.laterlEntery.howToDo&&""!=$scope.laterlEntery.howToDo&&s.append("howToDo",$scope.laterlEntery.howToDo),null!=$scope.laterlEntery.benefits&&null!=$scope.laterlEntery.benefits&&""!=$scope.laterlEntery.benefits&&s.append("benefits",$scope.laterlEntery.benefits),null!=$scope.laterlEntery.results&&null!=$scope.laterlEntery.results&&""!=$scope.laterlEntery.results&&s.append("results",$scope.laterlEntery.results),null!=$scope.laterlEntery.kaizenIdea&&null!=$scope.laterlEntery.kaizenIdea&&""!=$scope.laterlEntery.kaizenIdea&&s.append("kaizenIdea",$scope.laterlEntery.kaizenIdea),null!=$scope.laterlEntery.frquency&&null!=$scope.laterlEntery.frquency&&""!=$scope.laterlEntery.frquency&&s.append("frquency",$scope.laterlEntery.frquency),null!=$scope.laterlEntery.counterMeasures&&null!=$scope.laterlEntery.counterMeasures&&""!=$scope.laterlEntery.counterMeasures&&s.append("counterMeasures",$scope.laterlEntery.counterMeasures),null!=$scope.laterlEntery.rootCause&&null!=$scope.laterlEntery.rootCause&&""!=$scope.laterlEntery.rootCause&&s.append("rootCause",$scope.laterlEntery.rootCause);for(var n,l=[],i=0;i<$scope.activityList.length;i++)$scope.activityList[i].isselect&&(n={id:$scope.activityList[i].id,suggestion:{sugId:$scope.selectedSuggId},activity:$scope.activityList[i]},l.push(n));var o=0;if(null!=l)for(var i in l)s.append("suggActivity["+o+"].activity.id",l[i].id),o++;for(var r=[],i=0;i<$scope.documentLists.length;i++)$scope.documentLists[i].isChecked&&r.push($scope.documentLists[i]);var g=0;if(null!=r)for(var i in r)s.append("document["+g+"].document.id",r[i].id),g++;$scope.laterlEntery.tmpIsDocumentChangeRequire||null!=$scope.documentLists&&0==$filter("filter")($scope.documentLists,{isChecked:!0},!0).length?s.append("isDocumentChangeRequire","N/A"):s.append("isDocumentChangeRequire","Y");var u=[];for(let e=0;e<$scope.hDBranchList.length;e++)$scope.hDBranchList[e].isEvalPlantselect&&u.push({branchId:$scope.hDBranchList[e].branchId});for(var d=0,i=0;i<u.length;i++)s.append("suggestionHorizontalDept["+d+"].branchId",u[i].branchId),s.append("suggestionHorizontalDept["+d+"].hdType","ORG_LEVEL"),d++;if(null!=$scope.laterlEntery.deptId)for(a=0;a<$scope.departmentList.length;a++)if(null!=$scope.departmentList[a].lineFound&&null!=$scope.departmentList[a].lineList)for(var c=0;c<$scope.departmentList[a].lineList.length;c++){var p=!1;if(null!=$scope.suggestionDet.suggestionHorizontalDept)for(var m=0;m<$scope.suggestionDet.suggestionHorizontalDept.length;m++)$scope.departmentList[a].deptId==$scope.suggestionDet.suggestionHorizontalDept[m].deptId&&$scope.departmentList[a].lineList[c].lineId==$scope.suggestionDet.suggestionHorizontalDept[m].lineId&&(p=!0);!p&&$scope.departmentList[a].lineList[c].isLateralselect&&"All"!=$scope.departmentList[a].lineList[c].name&&(s.append("suggestionHorizontalDept["+d+"].lineId",$scope.departmentList[a].lineList[c].id),s.append("suggestionHorizontalDept["+d+"].deptId",$scope.departmentList[a].deptId),s.append("suggestionHorizontalDept["+d+"].hdType","PLANT_LEVEL"),d++)}else{var D=!1;if(null!=$scope.suggestionDet.suggestionHorizontalDept)for(m=0;m<$scope.suggestionDet.suggestionHorizontalDept.length;m++)$scope.departmentList[a].deptId==$scope.suggestionDet.suggestionHorizontalDept[m].deptId&&0==$scope.suggestionDet.suggestionHorizontalDept[m].lineId&&(D=!0);!D&&$scope.departmentList[a].isLateralselect&&"All"!=$scope.departmentList[a].deptName&&(s.append("suggestionHorizontalDept["+d+"].deptId",$scope.departmentList[a].deptId),s.append("suggestionHorizontalDept["+d+"].hdType","PLANT_LEVEL"),d++)}if(null!=$scope.laterlEntery.circleId&&null!=$scope.machineHDList&&0<$scope.machineHDList.length)for(c=0;c<$scope.machineHDList.length;c++)null!=$scope.machineHDList[c].machine&&null!=$scope.machineHDList[c].machine?s.append("suggestionHorizontalDept["+d+"].machineId",$scope.machineHDList[c].machine.id):s.append("suggestionHorizontalDept["+d+"].machineId",0),s.append("suggestionHorizontalDept["+d+"].circleId",$scope.machineHDList[c].circle.id),s.append("suggestionHorizontalDept["+d+"].stageId",$scope.machineHDList[c].stage.id),s.append("suggestionHorizontalDept["+d+"].productId",$scope.machineHDList[c].product.id),s.append("suggestionHorizontalDept["+d+"].productNoId",$scope.machineHDList[c].productNo.id),s.append("suggestionHorizontalDept["+d+"].operationId",$scope.machineHDList[c].operation.id),s.append("suggestionHorizontalDept["+d+"].hdType","PLANT_LEVEL"),d++;s.append("implEmpId",$scope.laterlEntery.implEmpId.empId),null!=$scope.laterlEntery.implAction&&null!=$scope.laterlEntery.implAction&&""!=$scope.laterlEntery.implAction&&s.append("implSummary",$scope.laterlEntery.implAction),null!=$scope.laterlEntery.implactionSummary&&null!=$scope.laterlEntery.implactionSummary&&""!=$scope.laterlEntery.implactionSummary&&s.append("implAction",$scope.laterlEntery.implactionSummary),null!=$scope.laterlEntery.implementedCost&&null!=$scope.laterlEntery.implementedCost&&""!=$scope.laterlEntery.implementedCost&&s.append("implementedCost",$scope.laterlEntery.implementedCost),null!=$scope.laterlEntery.costEffective&&null!=$scope.laterlEntery.costEffective&&""!=$scope.laterlEntery.costEffective&&s.append("costEffective",$scope.laterlEntery.costEffective);var f=[];if(null!=$scope.selectedEmpList&&0<$scope.selectedEmpList.length)for(i=0;i<$scope.selectedEmpList.length;i++)1==$scope.selectedEmpList[i].isSelected&&f.push($scope.selectedEmpList[i].empId);if(0<$scope.resultImageFiles.length)for(var i in $scope.resultImageFiles)s.append("resultDoc",$scope.resultImageFiles[i]);var e=$("#resultImageGraph").get(0);if(null!=e&&""!=e&&(e=e.toDataURL(),s.append("resultImageBase64",e)),null!=f)for(var i in f)s.append("empIds["+i+"]",f[i]);for(var h=[],i=0;i<$scope.benefitList.length;i++)$scope.benefitList[i].isBenefitChecked&&h.push($scope.benefitList[i].benfitId);var I=0;if(null!=h)for(var i in h)s.append("benefitIds["+I+"]",h[i]),I++;$scope.laterlEntery.lateralInitiatorDate&&s.append("lateralInitiatorDate",moment($scope.laterlEntery.lateralInitiatorDate).format("YYYY-MM-DD")),$scope.laterlEntery.lateralEvalDate&&s.append("lateralEvalDate",moment($scope.laterlEntery.lateralEvalDate).format("YYYY-MM-DD")),$scope.laterlEntery.lateralImpleDate&&s.append("lateralImpleDate",moment($scope.laterlEntery.lateralImpleDate).format("YYYY-MM-DD")),b.uploadFileToUrl(s,"suggestion/saveLateralEntry").then(function(e){"department"==$scope.status&&(e.data.result?($scope.resultImageFiles=[],$("#addLateralEntry").modal("hide"),$scope.whyWhyAnalysisforImpl=[{whyWhyAnalysis:""}],$scope.suggCreatedTitle="Awesome !",$scope.lateralCreatedMsg="Kaizen added successfully!",$("#latearlMsgCreateSugg").modal({backdrop:"static",keyboard:!1}),$scope.laterlEnteryDet.flagFirstTab=!1,$scope.laterlEnteryDet.flagSecondTab=!1,0==$scope.statusCountFilter?$scope.getsuggestionList("allSuggestion"):$scope.getsuggestionList("onUpdate"),$scope.getStatusWiseCount()):100==e.statusCode?C.create(e.reason,5e3,"error"):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error"))})}else C.create("Please select before or after image",3e3,"error")}else angular.forEach(t.$error.required,function(e){e.$setDirty()})},$scope.nextPrev=function(e){},$scope.setFCEvalTargetDate=function(){$scope.suggestionDet.fCEvalEndDate=$filter("date")(new Date,"yyyy-MM-dd")},$scope.change_flag_fcEvalEndDate=function(){$scope.suggestionInputDetails.acceptRejectStatus="accept",$scope.suggestionInputDetails.acceptRejBy="byFCEval",""==$scope.suggestionDet.fCEvalEndDate||null==$scope.suggestionDet.fCEvalEndDate||null==$scope.suggestionDet.fCEvalEndDate?$scope.flagRejectSugg=!0:(null==$scope.roleEscalationList||null==$scope.roleEscalationList?$scope.getRoleEscalateInfo():$scope.calculateTaskTime(),$scope.suggestionDet.fcEvalTaskDeviationInput="",$scope.scrollToBottom("#suggDetailsContainer"),$scope.flagRejectSugg=!1)},$scope.saveFinanceApprovalTimelineAtEval=function(){$scope.data={sugId:$scope.selectedSuggId,statusId:$scope.CONST.STATUS.UnderFinanceApproval.statusId,assignedById:parseInt($scope.loggedInEmpId),branchId:$scope.suggestionDet.branch.branchId,orgId:$scope.loggedInUserOrgId,actionDate:$scope.suggestionDet.fCEvalEndDate,summary:$scope.suggestionDet.fcEvalTaskDeviationInput},""==$scope.suggestionDet.fCEvalEndDate||null==$scope.suggestionDet.fCEvalEndDate||null==$scope.suggestionDet.fCEvalEndDate?($scope.flagRejectSugg=!0,angular.element("#errId_fcEvalEndDate").text($filter("translate")("Please_select_estimated_evaluation_time"))):!$scope.suggestionDet.fcEvalTaskDeviation||null!=$scope.suggestionDet.fcEvalTaskDeviationInput&&null!=$scope.suggestionDet.fcEvalTaskDeviationInput?b.httpPost($scope.data,"saveSuggestionAcceptedTimelineDetails").then(function(e){$scope.flagTeamDetPopupSpinner=!1,e.result?($scope.getStatusWiseCount(),$scope.getSuggestionListOnUpdate(),C.create($filter("translate")("Suggestion_accepted_by_finance_controller"),3e3,"success")):C.create($filter("translate")("Oops_Please_try_again"),6e3,"error")}):C.create($filter("translate")("Please_capture_reason_timeline_deviation"),5e3,"error")},$scope.setFCimplTargetDate=function(){$scope.suggestionDet.fCImplEndDate=$filter("date")(new Date,"yyyy-MM-dd")},$scope.change_flag_fCImplEndDate=function(){$scope.suggestionInputDetails.acceptRejectStatus="accept",$scope.suggestionInputDetails.acceptRejBy="byFCImpl",""==$scope.suggestionDet.fCImplEndDate||null==$scope.suggestionDet.fCImplEndDate||null==$scope.suggestionDet.fCImplEndDate?$scope.flagRejectSugg=!0:(null==$scope.roleEscalationList||null==$scope.roleEscalationList?$scope.getRoleEscalateInfo():$scope.calculateTaskTime(),$scope.flagRejectSugg=!1)},$scope.saveFinanceControolerTimelineAtImpl=function(){$scope.data={sugId:$scope.selectedSuggId,statusId:$scope.CONST.STATUS.UnderFinanceVerification.statusId,assignedById:parseInt($scope.loggedInEmpId),branchId:$scope.suggestionDet.branch.branchId,orgId:$scope.loggedInUserOrgId,actionDate:$scope.suggestionDet.fCImplEndDate,summary:$scope.suggestionDet.fcImplTaskDeviationInput},""==$scope.suggestionDet.fCImplEndDate||null==$scope.suggestionDet.fCImplEndDate||null==$scope.suggestionDet.fCImplEndDate?($scope.flagRejectSugg=!0,angular.element("#errId_fCImplEndDate").text($filter("translate")("Please_select_estimated_evaluation_time"))):!$scope.suggestionDet.fcImplTaskDeviation||null!=$scope.suggestionDet.fcImplTaskDeviationInput&&null!=$scope.suggestionDet.fcImplTaskDeviationInput?b.httpPost($scope.data,"saveSuggestionAcceptedTimelineDetails").then(function(e){$scope.flagTeamDetPopupSpinner=!1,e.result?($scope.getStatusWiseCount(),$scope.getSuggestionListOnUpdate(),C.create($filter("translate")("Suggestion_accepted_by_finance_validator"),3e3,"success")):100==e.statusCode?C.create(e.reason,3e3,"error"):C.create($filter("translate")("Oops_Please_try_again"),3e3,"error")}):C.create($filter("translate")("Please_capture_reason_timeline_deviation"),5e3,"error")},$scope.suggestionDetInput={},$scope.showDocOwnerModal=function(e){$scope.suggestionDetInput.ownerInputData={},$scope.suggestionDetInput.ownerInputData={stsAdt:e},$("#docOwnerModal").modal({backdrop:"static",keyboard:!1})},$scope.showDocVerifierModal=function(e){$("#docVerifierModal").modal({backdrop:"static",keyboard:!1})},$scope.showAssignedHDModal=function(e){$scope.suggestionDetInput.HDInputData={},$scope.suggestionDetInput.HDInputData={stsAdt:e},$("#assignedHDImplModal").modal({backdrop:"static",keyboard:!1})},$scope.setDCTargetDate=function(){$scope.suggestionDet.dcEndDate=$filter("date")(new Date,"yyyy-MM-dd"),$scope.change_flag_DCEndDate()},$scope.flagDCEndDate=!1,$scope.flagDCComment=!1,$scope.change_flag_DCEndDate=function(){$scope.suggestionInputDetails.acceptRejectStatus="accept",$scope.suggestionInputDetails.acceptRejBy="byDC",$scope.flagDCComment=!1,""==$scope.suggestionDet.dcEndDate||null==$scope.suggestionDet.dcEndDate||null==$scope.suggestionDet.dcEndDate?$scope.flagDCEndDate=!0:(null==$scope.roleEscalationList||null==$scope.roleEscalationList?$scope.getRoleEscalateInfo():$scope.calculateTaskTime(),$scope.flagDCEndDate=!1)},$scope.$watch("suggestionDet.dcEndDate",function(e,t){$scope.isEmpty($scope.suggestionDet)||$scope.suggestionDet.hasOwnProperty("dcEndDate")&&null!=$scope.suggestionDet.dcEndDate&&null!=$scope.suggestionDet.dcEndDate&&""!=$scope.suggestionDet.dcEndDate&&($scope.suggestionDet.dcEndDate=moment(e).format("YYYY-MM-DD"),$scope.change_flag_DCEndDate())}),$scope.docVerifierFlag=!1,$scope.submitDocData=function(e,t){var s;if($scope.docVerifierFlag=!0,"INPROCESS"==t){if(""==$scope.suggestionDet.dcEndDate||null==$scope.suggestionDet.dcEndDate||null==$scope.suggestionDet.dcEndDate)return $scope.flagDCEndDate=!0,void($scope.docVerifierFlag=!1);if($scope.suggestionDet.dcTaskDeviation&&(""==$scope.suggestionDet.dcTaskDeviationInput||null==$scope.suggestionDet.dcTaskDeviationInput||null==$scope.suggestionDet.dcTaskDeviationInput||0==$scope.suggestionDet.dcTaskDeviationInput.trim().length))return $scope.flagDCComment=!0,void($scope.docVerifierFlag=!1);s={status:"INPROCESS",actionDate:$scope.suggestionDet.dcEndDate,documentId:e.document.id,branchId:$scope.suggestionDet.branch.branchId,orgId:E.empDetails.organization.orgId,sugId:$scope.selectedSuggId,timeDeviationSummary:$scope.suggestionDet.dcTaskDeviationInput}}else if("COMPLETED"==t){if(""==e.document.fileNameInput||null==e.document.fileNameInput||null==e.document.fileNameInput)return C.create($filter("translate")("Please_enter_file_name"),5e3,"error"),void($scope.docVerifierFlag=!1);if(""==e.document.summaryInput||null==e.document.summaryInput||null==e.document.summaryInput)return C.create($filter("translate")("Please_enter_document_details"),5e3,"error"),void($scope.docVerifierFlag=!1);for(var i=0,a=0;a<$scope.suggestionDet.sugesstionStatusAudit.length;a++)if($scope.suggestionDet.sugesstionStatusAudit[a].status_master.status==$scope.CONST.STATUS.ImplementationRequestAccepted.status){i=$scope.suggestionDet.sugesstionStatusAudit[a].emp_details.empId;break}s={status:"COMPLETED",validatorId:null!=e.document.document.validator&&null!=e.document.document.validator?e.document.document.validator.empId:0,documentId:e.document.id,fileName:e.document.fileNameInput,summary:e.document.summaryInput,branchId:$scope.suggestionDet.branch.branchId,orgId:E.empDetails.organization.orgId,sugId:$scope.selectedSuggId,auditId:e.audit.stsadtId,implementedbyId:i}}s&&b.httpPost(s,"suggestionDocumentUpdate").then(function(e){$scope.docVerifierFlag=!1,e.result?("INPROCESS"==t?($scope.getSuggestionDetailsFlag="onUpdate",C.create($filter("translate")("Accepted_by_document_owner"),3e3,"success")):($scope.getSuggestionDetailsFlag="",$scope.getStatusWiseCount(),C.create($filter("translate")("Document_updated_successfully"),3e3,"success")),$scope.suggestionDet={},$scope.getsuggestionList("onUpdate")):C.create($filter("translate")("Oops_Please_try_again"),6e3,"error")})},$scope.resultImageFiles=[],$scope.getFileDetailsForResultImage=function(a){0<$scope.resultImageFiles.length?C.create($filter("translate")("Only one image upload"),5e3,"error"):$scope.$apply(function(){for(var e=0;e<a.files.length;e++){var t=a.files[e].name.match(/\.(.+)$/)[1],s=a.files[e].size,i=a.files[e].name.replace(/\.[^/.]+$/,"");if(10485760<s)return C.create($filter("translate")("Image_size_exceeds_limit"),5e3,"error"),void(document.getElementById("file").value="");a.files[e].fileName=i,a.files[e].ext=t,$scope.resultImageFiles.push(a.files[e])}})},$scope.docFiles=[],$scope.getFileDetailsDoc=function(a){$scope.$apply(function(){for(var e=0;e<a.files.length;e++){var t=a.files[e].name.match(/\.(.+)$/)[1],s=(a.files[e].ext=t,a.files[e].size,a.files[e].name),i=(a.files[e].fileName=i,a.files[e].ext=t,s.replace(/\.[^/.]+$/,""));if(10485760<a.files[e].size)return C.create($filter("translate")("Document_size_exceeds_limit"),5e3,"error"),void(document.getElementById("docFile").value="");a.files[e].fileName=i,a.files[e].ext=t,$scope.docFiles.push(a.files[e])}})},$scope.extension=function(e){return null!=e?(e=(e=(e=(e=e.substr(1+e.lastIndexOf("/"))).split("?")[0]).split("#")[0]).split(".")[1]).toLowerCase():""},$scope.clearImagedoc=function(e,t){$scope.docFiles.splice(e,1)},$scope.submitDocDataForDocUpload=function(e,t){if($scope.docVerifierFlag=!0,"INPROCESS"==t){if(""==$scope.suggestionDet.dcEndDate||null==$scope.suggestionDet.dcEndDate||null==$scope.suggestionDet.dcEndDate)return $scope.flagDCEndDate=!0,void($scope.docVerifierFlag=!1);if($scope.suggestionDet.dcTaskDeviation&&(""==$scope.suggestionDet.dcTaskDeviationInput||null==$scope.suggestionDet.dcTaskDeviationInput||null==$scope.suggestionDet.dcTaskDeviationInput||0==$scope.suggestionDet.dcTaskDeviationInput.trim().length))return $scope.flagDCComment=!0,void($scope.docVerifierFlag=!1);var s=new Date($scope.suggestionDet.dcEndDate),s=($filter("date")($scope.suggestionDet.dcEndDate,"dd-MM-yyyy"),s.toString());(i=new FormData($("#create-suggestion-docUpdateforDocOwner")[0])).append("status","INPROCESS"),i.append("actionDate",s),i.append("documentId ",e.document.id),i.append("branchId",$scope.suggestionDet.branch.branchId),i.append("orgId",$scope.loggedInUserOrgId),i.append("sugId",$scope.selectedSuggId),null!=$scope.suggestionDet.dcTaskDeviationInput&&null!=$scope.suggestionDet.dcTaskDeviationInput&&i.append("timeDeviationSummary",$scope.suggestionDet.dcTaskDeviationInput)}else if("COMPLETED"==t){if(""==e.document.fileNameInput||null==e.document.fileNameInput||null==e.document.fileNameInput)return C.create($filter("translate")("Please_enter_file_name"),5e3,"error"),void($scope.docVerifierFlag=!1);if(""==e.document.summaryInput||null==e.document.summaryInput||null==e.document.summaryInput)return C.create($filter("translate")("Please_enter_document_details"),5e3,"error"),void($scope.docVerifierFlag=!1);for(var i,a=0,n=0;n<$scope.suggestionDet.sugesstionStatusAudit.length;n++)if($scope.suggestionDet.sugesstionStatusAudit[n].status_master.status==$scope.CONST.STATUS.ImplementationRequestAccepted.status){a=$scope.suggestionDet.sugesstionStatusAudit[n].emp_details.empId;break}if(""==$scope.docFiles||null==$scope.docFiles||$scope.docFiles==[])return C.create($filter("translate")("Please_upload_document"),5e3,"error"),void($scope.docVerifierFlag=!1);for(n in(i=new FormData($("#create-suggestion-docUpdateforDocOwner")[0])).append("status","COMPLETED"),null!=e.document.document.validator&&null!=e.document.document.validator?i.append("validatorId ",e.document.document.validator.empId):i.append("validatorId ",0),i.append("documentId ",e.document.id),i.append("fileName ",e.document.fileNameInput),i.append("summary ",e.document.summaryInput),i.append("branchId",$scope.loggedInUserBranchId),i.append("orgId",E.empDetails.organization.orgId),i.append("sugId",$scope.selectedSuggId),i.append("auditId",e.audit.stsadtId),i.append("implementedbyId",a),$scope.docFiles)i.append("updatedDoc",$scope.docFiles[n])}i&&b.uploadFileToUrl(i,"suggestionDocumentUpdateWithDoc").then(function(e){$scope.docVerifierFlag=!1,e.data.result?"INPROCESS"==t?(C.create($filter("translate")("Accepted_by_document_owner"),3e3,"success"),$scope.suggestionDet={},$scope.getSuggestionDetails($scope.selectedSuggId)):($("#docOwnerModal").modal("hide"),$scope.getSuggestionDetailsFlag="",$scope.getStatusWiseCount(),C.create($filter("translate")("Document_updated_successfully"),3e3,"success"),$scope.suggestionDet={},$scope.docFiles=[],$scope.getsuggestionList("onLoad")):C.create($filter("translate")("Oops_Please_try_again"),6e3,"error")})},$scope.submitVerifyDocData=function(e,t){var s;if($scope.docVerifierFlag=!0,"REASSIGNTODC"==t){if(null==e.document.commentInput||""==e.document.commentInput||null==e.document.commentInput||0==e.document.commentInput.trim().length)return C.create($filter("translate")("Please_enter_comment_reason"),3e3,"error"),void($scope.docVerifierFlag=!1);for(var i=0,a=0;a<$scope.suggestionDet.sugesstionStatusAudit.length;a++)if($scope.suggestionDet.sugesstionStatusAudit[a].status_master.status==$scope.CONST.STATUS.ImplementationRequestAccepted.status){i=$scope.suggestionDet.sugesstionStatusAudit[a].emp_details.empId;break}s={status:"REASSIGNTODC",validatorId:null!=e.document.validator&&null!=e.document.validator?e.document.validator.empId:0,documentId:e.id,branchId:$scope.loggedInUserBranchId,orgId:$scope.loggedInUserOrgId,sugId:$scope.selectedSuggId,auditId:e.stsadtId,implementedbyId:i,summary:e.document.commentInput}}else if("COMPLETED"==t){for(i=0,a=0;a<$scope.suggestionDet.sugesstionStatusAudit.length;a++)if($scope.suggestionDet.sugesstionStatusAudit[a].status_master.status==$scope.CONST.STATUS.ImplementationRequestAccepted.status){i=$scope.suggestionDet.sugesstionStatusAudit[a].emp_details.empId;break}if(s={status:"COMPLETED",validatorId:null!=e.document.validator&&null!=e.document.validator?e.document.validator.empId:0,documentId:e.id,branchId:$scope.loggedInUserBranchId,orgId:$scope.loggedInUserOrgId,sugId:$scope.selectedSuggId,auditId:e.stsadtId,summary:e.document.commentInput,implementedbyId:i},null==e.document.commentInput||""==e.document.commentInput||null==e.document.commentInput||0==e.document.commentInput.trim().length)return delete s.summary,$scope.docVerifierFlag=!1,void C.create($filter("translate")("Please_enter_comment_reason"),3e3,"error")}s&&b.httpPost(s,"suggestionDocumentVerify").then(function(e){$scope.docVerifierFlag=!1,e.result?("REASSIGNTODC"==t?C.create($filter("translate")("Reassign_to_document_owner"),3e3,"success"):C.create($filter("translate")("Document_verified_successfully"),3e3,"success"),$("#docVerifierModal").modal("hide"),$scope.suggestionDet={},$scope.getsuggestionList("onUpdate"),$scope.getStatusWiseCount()):C.create($filter("translate")("Oops_Please_try_again"),6e3,"error")})},$scope.saveDocumentOwnerTimeline=function(){$scope.data={sugId:$scope.selectedSuggId,statusId:$scope.CONST.STATUS.UnderDocumentChangeApproval.statusId,assignedById:parseInt($scope.loggedInEmpId),branchId:$scope.loggedInUserBranchId,orgId:$scope.loggedInUserOrgId,actionDate:$scope.suggestionDet.dcEndDate,summary:$scope.suggestionDet.dcImplTaskDeviationInput},""==$scope.suggestionDet.dcEndDate||null==$scope.suggestionDet.dcEndDate||null==$scope.suggestionDet.dcEndDate?($scope.flagRejectSugg=!0,angular.element("#errId_dcEndDate").text("Please select estimated evaluation time.")):b.httpPost($scope.data,"saveDocumentChangeTimeline").then(function(e){$scope.flagTeamDetPopupSpinner=!1,e.result?($scope.getsuggestionList("onUpdate"),$scope.getStatusWiseCount(),C.create($filter("translate")("Suggestion_accepted_by_finance_controller"),3e3,"success")):C.create($filter("translate")("Oops_Please_try_again"),6e3,"error")})},$scope.applyFilterForList=function(){$scope.isFilterApplied=!0,$scope.getStatusWiseCount(),0==$scope.statusCountFilter?$scope.getsuggestionList("allSuggestion"):$scope.getsuggestionList("onUpdate"),$("#searchLateralPopup").modal("hide")},$scope.showAllFilterPopup=function(){$("#searchAllFilterPopupnew").modal({backdrop:"static",keyboard:!1})},$scope.listFilter={listdeptIds:[],listactivityIds:[],listcatIds:[],listsourceTypes:[],listsuggSource:[],COST_LATERAL_KAIZEN_SOURCE:[{id:0,source:"Mobile",value:"mobile"},{id:1,source:"Portal",value:"portal"},{id:3,source:"Lateral Entery",value:"LATERAL_ENTRY"}]},$scope.whyWhyAnalysisforImpl=[{whyWhyAnalysis:""}],$scope.addwhyWhyAnalysisforImpl=function(){$scope.whyWhyAnalysisforImpl.push({whyWhyAnalysis:""})},$scope.removewhyWhyAnalysisforImpl=function(e){$scope.whyWhyAnalysisforImpl.splice(e,1)},$scope.currentImplSubTab=1,$scope.setSubImplTab=function(e){if($scope.implSubTab!=e)switch($scope.implSubTab){case 1:$scope.setTabContentChecked("benefits");break;case 2:$scope.setTabContentChecked("otherBenefits");break;case 3:$scope.setTabContentChecked("hzDeployment");break;case 4:$scope.setTabContentChecked("whyAnalysis");break;case 5:$scope.setTabContentChecked("kaizenSustain");break;case 6:$scope.setTabContentChecked("results");break;case 7:$scope.setTabContentChecked("financeVerification");break;case 8:$scope.setTabContentChecked("teamMembers")}$scope.implSubTab=e},$scope.isSubImplSet=function(e){return $scope.implSubTab===e},$scope.getbranchWiseknowBankList=function(e){$scope.listFilter.deptId="",$scope.listFilter.catId="",$scope.listFilter.circleId="",$scope.listFilter.activityId="",$scope.listFilter.stageId="",$scope.listFilter.productId="",$scope.listFilter.productNoId="",$scope.listFilter.machineId="",$scope.listFilter.operationId="",null!=e&&""!=e&&($scope.KnowSelectedbranchId=e,$scope.getDepartmentList($scope.KnowSelectedbranchId),$scope.getCategoryList($scope.KnowSelectedbranchId),$scope.getCircleListBranchWise($scope.KnowSelectedbranchId))},$scope.getKnowMasterStageListByCircleId=function(e){$scope.listFilter.stageId="",$scope.masterStageList=[],$scope.listFilter.productId="",$scope.productList=[],$scope.listFilter.productNoId="",$scope.productNumberList=[],$scope.listFilter.machineId="",$scope.machineList=[],$scope.listFilter.operationId="",$scope.opertionList=[],null!=e&&""!=e&&b.httpGet("getMasterStageByCircleId/"+$scope.KnowSelectedbranchId+"/"+e).then(function(e){$scope.listFilter.stageId=void 0,$scope.listFilter.productId=void 0,$scope.listFilter.machineId=void 0,1==e.result?$scope.masterStageList=e.masterStageList:$scope.masterStageList=[]})},$scope.getKnowMasterProductFamilyListByStageId=function(e){$scope.listFilter.productId="",$scope.productList=[],$scope.listFilter.productNoId="",$scope.productNumberList=[],$scope.listFilter.operationId="",$scope.opertionList=[],$scope.listFilter.machineId="",$scope.machineList=[],null!=e&&""!=e&&b.httpGet("getProductFamilyByStage/"+$scope.KnowSelectedbranchId+"/"+e).then(function(e){$scope.listFilter.machineId=void 0,$scope.listFilter.productId=void 0,$scope.focus=!1,$scope.prodfocus=!0,1==e.result?$scope.productList=e.masterProductFamilyList:$scope.productList=[]})},$scope.getKnowMasterProductNumberListByproductId=function(e){$scope.listFilter.productNoId="",$scope.productNumberList=[],$scope.listFilter.machineId="",$scope.machineList=[],$scope.listFilter.operationId="",$scope.opertionList=[],null!=e&&""!=e&&($scope.data={branchId:$scope.KnowSelectedbranchId,productFamilyId:e},b.httpPost($scope.data,"getProductNo").then(function(e){1==e.result?$scope.productNumberList=e.productNoList:$scope.productNumberList=[]}))},$scope.getKnowmachineListByproductNoId=function(t){$scope.listFilter.machineId="",$scope.listFilter.operationId="",$scope.machineList=[],$scope.opertionList=[],null!=t&&""!=t&&b.httpGet("getMachineListByProductNo/"+$scope.KnowSelectedbranchId+"/"+t).then(function(e){1==e.result?$scope.machineList=e.masterMachineList:($scope.machineList=[],t&&$scope.getKnowMasterOperationList(t,0))})},$scope.getKnowMasterOperationList=function(e,t){null!=e&&""!=e&&($scope.globalLoadingIndicator=!0,$scope.flagEmployeeListSpinner=!1,$scope.flagTblemployee=!1,$scope.data={branchId:$scope.KnowSelectedbranchId,productNoId:e,machineId:t&&0},b.httpPost($scope.data,"getMasterOperationList").then(function(e){$scope.globalLoadingIndicator=!1,1==e.result?$scope.opertionList=e.masterOperationlist:$scope.opertionList=[]}))},$scope.showFilterPopup=function(){$("#searchFilterPopup").modal({backdrop:"static",keyboard:!1})},$scope.listFilter.flagopenFilter=!1,$scope.closeNav=function(){$scope.listFilter.flagopenFilter=!1},$scope.openNav=function(){$scope.listFilter.flagopenFilter=!0},$scope.selectFilterList=function(){for($scope.listFilter.selectAllPiller=!1,$scope.listFilter.selectAllDept=!1,$scope.listFilter.selectAllCategory=!1,$scope.listFilter.selectAllPlant=!0,$scope.listFilter.selectAllSourceType=!1,$scope.listFilter.selectAllSource=!1,i=0;i<$scope.listFilter.COST_LATERAL_KAIZEN_SOURCE.length;i++)$scope.listFilter.COST_LATERAL_KAIZEN_SOURCE[i].isSelectSourceType=!1;for(i=0;i<$scope.listFilter.suggestionSourceList.length;i++)$scope.listFilter.suggestionSourceList[i].isSelectSource=!1;for(i=0;i<$scope.listFilter.departmentList.length;i++)$scope.listFilter.departmentList[i].isSelectDept=!1;if(null!=$scope.listFilter.accessBranchList&&null!=$scope.listFilter.accessBranchList)for(i=0;i<$scope.listFilter.accessBranchList.length;i++)$scope.listFilter.accessBranchList[i].isSelectBranch=!0;for(i=0;i<$scope.listFilter.catagoryList.length;i++)"All"!=$scope.listFilter.catagoryList.categoryName&&($scope.listFilter.catagoryList[i].isSelectCategory=!1);for(i=0;i<$scope.listFilter.activityList.length;i++)$scope.listFilter.activityList[i].isSelectPiller=!1;$scope.listFilter.accessBranchKnowList=angular.copy($scope.listFilter.accessBranchList),$scope.listFilter.suggestionSourceLateralList=angular.copy($scope.listFilter.suggestionSourceList),$scope.listFilter.departmentLateralList=angular.copy($scope.listFilter.departmentList),$scope.listFilter.accessBranchLateralList=angular.copy($scope.listFilter.accessBranchList),$scope.listFilter.catagoryLateralList=angular.copy($scope.listFilter.catagoryList),$scope.listFilter.activityLateralList=angular.copy($scope.listFilter.activityList)},$scope.pillerToggle=function(){$(".deptwrapperPiller .listPiller").slideToggle("fast")},$scope.togglePillerDiv=function(e){var t=$(".deptwrapperPiller");t===e.target||t.has(e.target).length||$(".listPiller").slideUp("fast")},$scope.selectAllPiller=function(){var e=!$scope.listFilter.selectAllPiller;$scope.listFilter.selectAllPiller=e;for(var t=0;t<$scope.listFilter.activityList.length;t++)$scope.listFilter.activityList[t].isSelectPiller=$scope.listFilter.selectAllPiller;$scope.pillerToggle()},$scope.setPillerSelected=function(e){e.isSelectPiller=!e.isSelectPiller;for(var t=0;t<$scope.listFilter.activityList.length;t++)$scope.listFilter.activityList.isSelectPiller||($scope.listFilter.selectAllPiller=!1);$scope.pillerToggle()},$scope.sourceTypeToggle=function(){$(".deptwrapperSource .listSource").slideToggle("fast")},$scope.toggleSourceDiv=function(e){var t=$(".deptwrapperSource");t===e.target||t.has(e.target).length||$(".deptwrapperSourc").slideUp("fast")},$scope.selectAllSource=function(){var e=!$scope.listFilter.selectAllSource;$scope.listFilter.selectAllSource=e;for(var t=0;t<$scope.listFilter.suggestionSourceList.length;t++)$scope.listFilter.suggestionSourceList[t].isSelectSource=$scope.listFilter.selectAllSource;$scope.sourceToggle()},$scope.setSourceSelected=function(e){e.isSelectSource=!e.isSelectSource;for(var t=0;t<$scope.listFilter.suggestionSourceList.length;t++)$scope.listFilter.suggestionSourceList.isSelectSource||($scope.listFilter.selectAllSource=!1);$scope.sourceToggle()},$scope.NewDeptToggle=function(){$(".deptwrapperNewDept .listNewDept").slideToggle("fast")},$scope.toggleNewDeptDiv=function(e){var t=$(".deptwrapperNewDept");t===e.target||t.has(e.target).length||$(".listNewDept").slideUp("fast")},$scope.selectAllDeptL=function(){var e=!$scope.listFilter.selectAllDept;$scope.listFilter.selectAllDept=e;for(var t=0;t<$scope.listFilter.departmentList.length;t++)$scope.listFilter.departmentList[t].isSelectDept=$scope.listFilter.selectAllDept;$scope.NewDeptToggle()},$scope.setDeptLSelected=function(e){e.isSelectDept=!e.isSelectDept;for(var t=0;t<$scope.listFilter.departmentList.length;t++)$scope.listFilter.departmentList.isSelectDept||($scope.listFilter.selectAllDept=!1);$scope.NewDeptToggle()},$scope.CategoryToggle=function(){$(".deptwrapperCategory .listCategory").slideToggle("fast")},$scope.toggleSourceDiv=function(e){var t=$(".deptwrapperCategory");t===e.target||t.has(e.target).length||$(".listCategory").slideUp("fast")},$scope.selectAllCategory=function(){var e=!$scope.listFilter.selectAllCategory;$scope.listFilter.selectAllCategory=e;for(var t=0;t<$scope.listFilter.catagoryList.length;t++)$scope.listFilter.catagoryList[t].isSelectCategory=$scope.listFilter.selectAllCategory;$scope.CategoryToggle()},$scope.setSelectedCategory=function(e){e.isSelectCategory=!e.isSelectCategory;for(var t=0;t<$scope.listFilter.catagoryList.length;t++)$scope.listFilter.catagoryList.isSelectCategory||($scope.listFilter.selectAllCategory=!1);$scope.CategoryToggle()},$scope.selectAllPlant=function(){var e=!$scope.listFilter.selectAllPlant;$scope.listFilter.selectAllPlant=e;for(var t=0;t<$scope.listFilter.accessBranchList.length;t++)$scope.listFilter.accessBranchList[t].isSelectBranch=$scope.listFilter.selectAllPlant;$scope.deptToggle()},$scope.setSelectedPlant=function(e){e.isSelectBranch=!e.isSelectBranch;for(var t=0;t<$scope.listFilter.accessBranchList.length;t++)$scope.listFilter.accessBranchList.isSelectBranch||($scope.listFilter.selectAllPlant=!1);$scope.deptToggle()},$scope.sourceToggle=function(){$(".deptwrapperSourceType .listSourceType").slideToggle("fast")},$scope.toggleSourceDiv=function(e){var t=$(".deptwrapperTypeSource");t===e.target||t.has(e.target).length||$(".deptwrapperTypeSource").slideUp("fast")},$scope.selectAllSourceType=function(){var e=!$scope.listFilter.selectAllSourceType;$scope.listFilter.selectAllSourceType=e;for(var t=0;t<$scope.listFilter.COST_LATERAL_KAIZEN_SOURCE.length;t++)$scope.listFilter.COST_LATERAL_KAIZEN_SOURCE[t].isSelectSourceType=$scope.listFilter.selectAllSourceType;$scope.sourceTypeToggle()},$scope.setSourceTypeSelected=function(e){e.isSelectSourceType=!e.isSelectSourceType;for(var t=0;t<$scope.listFilter.COST_LATERAL_KAIZEN_SOURCE.length;t++)$scope.listFilter.COST_LATERAL_KAIZEN_SOURCE.isSelectSourceType||($scope.listFilter.selectAllSourceType=!1);$scope.sourceTypeToggle()},$scope.applySearchFilter=function(){0==$scope.statusCountFilter?$scope.getsuggestionList("allSuggestion"):$scope.getsuggestionList("onLoad"),$scope.getStatusWiseCount()},$scope.acceptByEvalHD=function(){if(!$scope.suggestionDet.evalTaskDeviation||null!=$scope.suggestionDet.evalTaskDeviationInput&&null!=$scope.suggestionDet.evalTaskDeviationInput){var e={branchId:$scope.loggedInUserBranchId,orgId:$scope.loggedInUserOrgId,sugId:$scope.selectedSuggId,statusId:$scope.CONST.STATUS.EvaluationRequestAccepted.statusId,empId:$scope.loggedInEmpId,endDate:$scope.newSug.evalEndDate};""!=$scope.suggestionDet.evalTaskDeviationInput&&null!=$scope.suggestionDet.evalTaskDeviationInput&&null!=$scope.suggestionDet.evalTaskDeviationInput||(e.summary=$scope.suggestionDet.evalTaskDeviationInput);for(var t=0;t<$scope.suggestionDet.evaluationTeamList.length;t++)parseInt($scope.suggestionDet.evaluationTeamList[t].empId)==parseInt($scope.loggedInEmpId)&&(e.sugTrackId=$scope.suggestionDet.evaluationTeamList[t].sugTrackId);consoleLog(e),b.httpPost(e,"acceptedByEvalHD").then(function(e){e.result?($scope.getsuggestionList("onUpdate"),$scope.getStatusWiseCount(),$scope.flagHDDept=!1,$scope.flagHDLine=!1,$scope.flagErrCatHD=!1,$scope.newSug.deptId="",$scope.newSug.line="",$scope.newSug.catId="",C.create($filter("translate")("Suggestion_accepted_by_evaluator"),3e3,"success")):C.create($filter("translate")("Oops_Please_try_again"),3e3,"error")})}else C.create($filter("translate")("Please_capture_reason_timeline_deviation"),5e3,"error")},$scope.getMasterOperationList=function(e,t){$scope.globalLoadingIndicator=!0,$scope.flagEmployeeListSpinner=!1,$scope.flagTblemployee=!1,-1==t?$scope.newSug.addMachineFlag=!0:($scope.data={branchId:$scope.loggedInUserBranchId,productNoId:e,machineId:t||0},b.httpPost($scope.data,"getMasterOperationList").then(function(e){if($scope.globalLoadingIndicator=!1,$scope.opertionList=[],$scope.newSug.addOperationFlagnew&&$scope.opertionList.push({operationType:"Add Operation",id:0}),1==e.result){for(var t=0;t<e.masterOperationlist.length;t++)$scope.opertionList.push(e.masterOperationlist[t]),$scope.newSug.addOperationFlagnew&&$scope.newSug.newOperationType==e.masterOperationlist[t].operationType&&($scope.newSug.opertionId=e.masterOperationlist[t]);$scope.newSug.newOperationType=""}}))},$scope.circleList=[],$scope.getCircleList=function(){$scope.circleList=[],b.httpGet("getCircleList/"+$scope.loggedInUserBranchId).then(function(e){if(1==e.result){$scope.circleList.push({id:0,circleName:"NA"});for(var t=0;t<e.circleList.length;t++)$scope.circleList.push(e.circleList[t])}else $scope.circleList=[]})},$scope.getCircleListBranchWise=function(e){b.httpGet("getCircleList/"+e).then(function(e){1==e.result?$scope.circleList=e.circleList:$scope.circleList=[]})},$scope.getMasterStageList=function(e){b.httpGet("getMasterStageList/"+e).then(function(e){1==e.result?$scope.masterStageList=e.masterStageList:$scope.masterStageList=[]})},$scope.getMasterStageListByCircleId=function(e){b.httpGet("getMasterStageByCircleId/"+$scope.loggedInUserBranchId+"/"+e).then(function(e){$scope.newSug.stageId=void 0,$scope.newSug.productId=void 0,$scope.newSug.deptId=void 0,$scope.newSug.machineId=void 0,$scope.listFilter.stageId=void 0,$scope.listFilter.productId=void 0,$scope.listFilter.machineId=void 0,$scope.laterlEntery.deptId=void 0,$scope.laterlEntery.stageId=void 0,$scope.laterlEntery.productId=void 0,$scope.laterlEntery.machineId=void 0,$scope.laterlEntery.productNoId=void 0,$scope.newSug.productNoId=void 0,$scope.listFilter.productNoId=void 0,$scope.pillarfocus=!1,$scope.circlefocus=!0,1==e.result?($scope.masterStageList=e.masterStageList,$scope.focus=!0):($scope.masterStageList=[],$scope.focus=!1)})},$scope.getMasterProductNumberListByproductId=function(e){$scope.data={branchId:$scope.loggedInUserBranchId,productFamilyId:e},b.httpPost($scope.data,"getProductNo").then(function(e){1==e.result?$scope.productNumberList=e.productNoList:$scope.productNumberList=[]})},$scope.getmachineListByproductNoId=function(s){b.httpGet("getMachineListByProductNo/"+$scope.loggedInUserBranchId+"/"+s).then(function(e){if(1==e.result){$scope.machineList=[],$scope.newSug.addMachineFlagnew&&$scope.machineList.push({machineName:"Add Machine",id:-1});for(var t=0;t<e.masterMachineList.length;t++)$scope.machineList.push(e.masterMachineList[t]),$scope.newSug.addMachineFlagnew&&$scope.newSug.machineNameNew==e.masterMachineList[t].machineName&&($scope.newSug.machineId=e.masterMachineList[t],$scope.getMasterOperationList($scope.newSug.productNoId.id,$scope.newSug.machineId.id));$scope.newSug.machineNameNew=""}else $scope.machineList=[],s&&$scope.getMasterOperationList(s,0)})},$scope.getMasterMachineList=function(e){b.httpGet("getMasterMachineList/"+e).then(function(e){1==e.result?$scope.machineList=e.masterMachineList:$scope.machineList=[]})},$scope.getMasterMachineListBbyProductId=function(e){b.httpGet("getMachineByProductId/"+$scope.loggedInUserBranchId+"/"+e).then(function(e){$scope.newSug.machineId=void 0,$scope.listFilter.machineId=void 0,$scope.prodfocus=!1,$scope.machfocus=!0,1==e.result?$scope.machineList=e.masterMachineList:$scope.machineList=[]})},$scope.getMasterMachinePartList=function(e){b.httpGet("getMasterMachinePartList/"+e).then(function(e){1==e.result?$scope.machinePartList=e.machinePartList:$scope.machinePartList=[]})},$scope.getMasterProductFamilyList=function(e){$scope.listFilter.productNoId="",$scope.productNumberList=[],b.httpGet("getMasterProductFamilyList/"+e).then(function(e){1==e.result?$scope.productList=e.masterProductFamilyList:$scope.productList=[]})},$scope.getMasterProductFamilyListByStageId=function(e){b.httpGet("getProductFamilyByStage/"+$scope.loggedInUserBranchId+"/"+e).then(function(e){$scope.newSug.machineId=void 0,$scope.listFilter.machineId=void 0,$scope.listFilter.productId=void 0,$scope.newSug.productId=void 0,$scope.newSug.productNoId=void 0,$scope.listFilter.productNoId=void 0,$scope.focus=!1,$scope.prodfocus=!0,1==e.result?$scope.productList=e.masterProductFamilyList:$scope.productList=[]})},$scope.setExportDataold=function(e){$scope.exportProject=angular.copy(e);var t=[],s=[];if(null!=$scope.exportProject.sugImplTeam&&null!=$scope.exportProject.sugImplTeam&&0<$scope.exportProject.sugImplTeam.length){for(var i=0;i<$scope.exportProject.sugImplTeam.length;i++)t.push($scope.exportProject.sugImplTeam[i].empName);$scope.exportProject.teamMemberNames=t.join()}$scope.exportProject.activityName="";for(i=0;i<$scope.activityList.length;i++)$scope.activityList[i].isselect=!1,null!=$scope.suggestionDet.suggestionActivityList&&0<$filter("filter")($scope.suggestionDet.suggestionActivityList,{activity:{id:$scope.activityList[i].id}},!0).length?($scope.activityList[i].isselect=!0,$scope.exportProject.activityName+="<td style='border: 1px solid black;border-collapse: collapse;text-align: center;background:#00B050'><span style='padding:2px;font-size: 12px;font-weight: 500;'> "+$scope.activityList[i].activityName+" </span></td>"):$scope.exportProject.activityName+="<td style='border: 1px solid black;border-collapse: collapse;text-align: center;'><span style='padding:2px;font-size: 12px;font-weight: 500;'> "+$scope.activityList[i].activityName+" </span></td>";if($scope.suggestionDet.createdHDHTMLlist="",null!=$scope.suggestionDet.suggestionHDList)for(i=0;i<$scope.suggestionDet.suggestionHDList.length;i++)$scope.suggestionDet.createdHDHTMLlist+="<tr style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left;'><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+(i+1)+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$scope.suggestionDet.suggestionHDList[i].branchName+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left;'>"+$filter("date")(new Date($scope.suggestionDet.suggestionHDList[i].filterCreatedDate),"MMM d, y ")+"</td> <td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$scope.suggestionDet.suggestionHDList[i].hdEvalName+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$scope.suggestionDet.suggestionHDList[i].label+"</td></tr>";if($scope.suggestionDet.createdHDcirclelist="",null!=$scope.suggestionDet.suggestionHorizontalDept)for(i=0;i<$scope.suggestionDet.suggestionHorizontalDept.length;i++)$scope.suggestionDet.createdHDcirclelist+="<tr style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left;'><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+(i+1)+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$scope.suggestionDet.suggestionHorizontalDept[i].circleName+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left;'>"+$scope.suggestionDet.suggestionHorizontalDept[i].stageName+"</td> <td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$scope.suggestionDet.suggestionHorizontalDept[i].productName+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$scope.suggestionDet.suggestionHorizontalDept[i].machineName+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$filter("date")(new Date($scope.suggestionDet.suggestionHorizontalDept[i].targetDate),"MMM d, y ")+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$scope.suggestionDet.suggestionHorizontalDept[i].hdEvalName+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$scope.suggestionDet.suggestionHorizontalDept[i].actionStatus+"</td></tr>";if($scope.suggestionDet.createdHDcirclelist="",null!=$scope.suggestionDet.suggestionHorizontalDept)for(i=0;i<$filter("filter")($scope.suggestionDet.suggestionHorizontalDept,{hdType:"PLANT_LEVEL"},!0).length;i++)if("PLANT_LEVEL"==$scope.suggestionDet.suggestionHorizontalDept[i].hdType){for(let e=0;e<$scope.departmentList.length;e++)$scope.suggestionDet.suggestionHorizontalDept[i].deptId==$scope.departmentList[e].deptId&&($scope.suggestionDet.suggestionHorizontalDept[i].name=$scope.departmentList[e].deptName);null!=$scope.suggestionDet.suggestionHorizontalDept[i].hdEvalName&&null!=$scope.suggestionDet.suggestionHorizontalDept[i].hdEvalName||($scope.suggestionDet.suggestionHorizontalDept[i].hdEvalName="N/A"),"PENDING"==$scope.suggestionDet.suggestionHorizontalDept[i].actionStatus?$scope.suggestionDet.suggestionHorizontalDept[i].status="Pending For Implementation":"COMPLETED"==$scope.suggestionDet.suggestionHorizontalDept[i].actionStatus&&($scope.suggestionDet.suggestionHorizontalDept[i].status="Implemented"),$scope.suggestionDet.createdHDDeptlist+="<tr style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left;'><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+(i+1)+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left;'>"+$scope.suggestionDet.suggestionHorizontalDept[i].name+"</td> <td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$filter("date")(new Date($scope.suggestionDet.suggestionHorizontalDept[i].targetDate),"MMM d, y ")+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$scope.suggestionDet.suggestionHorizontalDept[i].hdEvalName+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$scope.suggestionDet.suggestionHorizontalDept[i].status+"</td></tr>"}if($scope.exportProject.category="",null!=$scope.catbranchwise&&0<$scope.catbranchwise.length)for(let e=0;e<$scope.catbranchwise.length;e++)null!=$scope.suggestionDet.category&&$scope.suggestionDet.category.catId==$scope.catbranchwise[e].catId?$scope.exportProject.category+="<td style='border: 1px solid black;border-collapse: collapse;text-align: center;background:#00B050;'><span style='padding:2px;font-size: 12px;font-weight: 500;'>"+$scope.catbranchwise[e].categoryName[0]+"</span></td>":$scope.exportProject.category+="<td style='border: 1px solid black;border-collapse: collapse;text-align: center;'><span style='padding:2px;font-size: 12px;font-weight: 500;'>"+$scope.catbranchwise[e].categoryName[0]+"</span></td>";$scope.exportProject.analysis=[];for(let e=0;e<$scope.suggestionDet.suggestionWhyWhyAnalysis.length;e++)s.push($scope.suggestionDet.suggestionWhyWhyAnalysis[e].name);$scope.exportProject.analysis=s.join()},$scope.setExportData=function(e){$scope.exportProject=angular.copy(e);var t=[];if(null!=$scope.exportProject.sugImplTeam&&null!=$scope.exportProject.sugImplTeam&&0<$scope.exportProject.sugImplTeam.length){for(var s=0;s<$scope.exportProject.sugImplTeam.length;s++)t.push($scope.exportProject.sugImplTeam[s].empName);$scope.exportProject.teamMemberNames=t.join()}$scope.exportProject.result="",$scope.checkForHdConfig()&&null!=$scope.suggestionDet.implSummary&&($scope.exportProject.result=$scope.suggestionDet.implSummary),$scope.checkForHdConfig()||null==$scope.implwhyWhyAnalysisData||($scope.exportProject.result=$scope.implwhyWhyAnalysisData.results),$scope.exportProject.activityName="";for(s=0;s<$scope.activityList.length;s++)$scope.activityList[s].isselect=!1,null!=$scope.suggestionDet.suggestionActivityList&&0<$filter("filter")($scope.suggestionDet.suggestionActivityList,{activity:{id:$scope.activityList[s].id}},!0).length?($scope.activityList[s].isselect=!0,$scope.exportProject.activityName+="<td style='border: 1px solid black;border-collapse: collapse;text-align: center;background:#00B050'><span style='padding:2px;font-size: 12px;font-weight: 500;'> "+$scope.activityList[s].activityName+" </span></td>"):$scope.exportProject.activityName+="<td style='border: 1px solid black;border-collapse: collapse;text-align: center;'><span style='padding:2px;font-size: 12px;font-weight: 500;'> "+$scope.activityList[s].activityName+" </span></td>";if($scope.suggestionDet.createdHDHTMLlist="",null!=$scope.suggestionDet.suggestionHDList)for(s=0;s<$scope.suggestionDet.suggestionHDList.length;s++)$scope.suggestionDet.createdHDHTMLlist+="<tr style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left;'><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+(s+1)+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$scope.suggestionDet.suggestionHDList[s].branchName+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left;'>"+$filter("date")(new Date($scope.suggestionDet.suggestionHDList[s].filterCreatedDate),"MMM d, y ")+"</td> <td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$scope.suggestionDet.suggestionHDList[s].hdEvalName+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$scope.suggestionDet.suggestionHDList[s].label+"</td></tr>";if($scope.suggestionDet.createdHDcirclelist="",$scope.suggestionDet.columCircle=" ",null!=$scope.suggestionDet.circle&&($scope.suggestionDet.columCircle+="<td style='border: 0.5px solid black;border-collapse: collapse;padding: 5px;text-align: left;font-weight: bold;'>SR.NO.</td><td style='border: 0.5px solid black;border-collapse: collapse;padding: 5px;text-align: left;font-weight: bold;'><div>Circle</div></td><td style='border: 0.5px solid black;border-collapse: collapse;padding: 5px;text-align: left;font-weight: bold;'>Operation Type</td><td style='border: 0.5px solid black;border-collapse: collapse;padding: 5px;text-align: left;font-weight: bold;'>TDC</td><td style='border: 0.5px solid black;border-collapse: collapse;padding: 5px;text-align: left;font-weight: bold;'>RESP</td><td style='border: 0.5px solid black;border-collapse: collapse;padding: 5px;text-align: left;font-weight: bold;'>Status</td>",$scope.suggestionDet.createdHDcirclelist="",null!=$scope.suggestionDet.suggestionHorizontalDept)){$scope.plantHDsuggestionHorizontalDept=$filter("filter")($scope.suggestionDet.suggestionHorizontalDept,{hdType:"PLANT_LEVEL"},!0);for(var i,s=0;s<$scope.plantHDsuggestionHorizontalDept.length;s++)i=null!=$scope.plantHDsuggestionHorizontalDept[s].hdEvalName&&null!=$scope.plantHDsuggestionHorizontalDept[s].hdEvalName?$scope.plantHDsuggestionHorizontalDept[s].hdEvalName:"N/A",$scope.suggestionDet.createdHDcirclelist+="<tr style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left;'><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+(s+1)+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '><div>"+$scope.plantHDsuggestionHorizontalDept[s].circleName+"</div></td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left;'><div>"+$scope.plantHDsuggestionHorizontalDept[s].operationType+"</div></td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$filter("date")(new Date($scope.plantHDsuggestionHorizontalDept[s].targetDate),"MMM d, y ")+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+i+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$scope.plantHDsuggestionHorizontalDept[s].actionStatus+"</td></tr>"}if(null!=$scope.suggestionDet.dept){$scope.suggestionDet.columCircle+="<td style='border: 0.5px solid black;border-collapse: collapse;padding: 5px;text-align: left;font-weight: bold;'>SR.NO.</td><td style='border: 0.5px solid black;border-collapse: collapse;padding: 5px;text-align: left;font-weight: bold;'><div>Department</div></td><td style='border: 0.5px solid black;border-collapse: collapse;padding: 5px;text-align: left;font-weight: bold;'>Line</td><td style='border: 0.5px solid black;border-collapse: collapse;padding: 5px;text-align: left;font-weight: bold;'>TDC</td><td style='border: 0.5px solid black;border-collapse: collapse;padding: 5px;text-align: left;font-weight: bold;'>RESP</td><td style='border: 0.5px solid black;border-collapse: collapse;padding: 5px;text-align: left;font-weight: bold;'>Status</td>";for(s=0;s<$filter("filter")($scope.suggestionDet.suggestionHorizontalDept,{hdType:"PLANT_LEVEL"},!0).length;s++)if("PLANT_LEVEL"==$scope.suggestionDet.suggestionHorizontalDept[s].hdType){for(let e=0;e<$scope.departmentList.length;e++)$scope.suggestionDet.suggestionHorizontalDept[s].deptId==$scope.departmentList[e].deptId&&($scope.suggestionDet.suggestionHorizontalDept[s].name=$scope.departmentList[e].deptName);null!=$scope.suggestionDet.suggestionHorizontalDept[s].hdEvalName&&null!=$scope.suggestionDet.suggestionHorizontalDept[s].hdEvalName||($scope.suggestionDet.suggestionHorizontalDept[s].hdEvalName="N/A"),"PENDING"==$scope.suggestionDet.suggestionHorizontalDept[s].actionStatus?$scope.suggestionDet.suggestionHorizontalDept[s].status="Pending For Implementation":"COMPLETED"==$scope.suggestionDet.suggestionHorizontalDept[s].actionStatus&&($scope.suggestionDet.suggestionHorizontalDept[s].status="Implemented"),$scope.suggestionDet.createdHDcirclelist+="<tr style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left;'><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+(s+1)+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left;'><div>"+$scope.suggestionDet.suggestionHorizontalDept[s].name+"</div></td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left;'>"+$scope.suggestionDet.suggestionHorizontalDept[s].lineName+"</td> <td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$filter("date")(new Date($scope.suggestionDet.suggestionHorizontalDept[s].targetDate),"MMM d, y ")+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$scope.suggestionDet.suggestionHorizontalDept[s].hdEvalName+"</td><td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left; '>"+$scope.suggestionDet.suggestionHorizontalDept[s].status+"</td></tr>"}}if($scope.exportProject.category="",null!=$scope.catbranchwise&&0<$scope.catbranchwise.length)for(let e=0;e<$scope.catbranchwise.length;e++)null!=$scope.suggestionDet.category&&$scope.suggestionDet.category.catId==$scope.catbranchwise[e].catId?$scope.exportProject.category+="<td style='border: 1px solid black;border-collapse: collapse;text-align: center;background:#00B050;'><span style='padding:2px;font-size: 12px;font-weight: 500;'>"+$scope.catbranchwise[e].categoryName[0]+"</span></td>":$scope.exportProject.category+="<td style='border: 1px solid black;border-collapse: collapse;text-align: center;'><span style='padding:2px;font-size: 12px;font-weight: 500;'>"+$scope.catbranchwise[e].categoryName[0]+"</span></td>";$scope.exportProject.analysis=[];for(let e=0;e<$scope.suggestionDet.suggestionWhyWhyAnalysis.length;e++)$scope.exportProject.analysis+="<div><span style='font-weight: bold;'>Why"+(e+1)+": </span>"+$scope.suggestionDet.suggestionWhyWhyAnalysis[e].name+"</div>"},$scope.tpmkaizenExportUrl=o.trustAsResourceUrl(E.appDomain+"downloadTPMKkaizenFile"),$scope.exportTpmKaizen=function(){var e=new FormData,t=angular.element("#tpmKaizenDetails1").val(),a=(e.append("content",t),E.flagpageloadindicator=!0,$q.defer());return $http.post($scope.tpmkaizenExportUrl,e,{transformRequest:angular.identity,responseType:"arraybuffer",headers:{"Content-Type":void 0,Authorization:r.getToken()}}).then(function(e){E.flagpageloadindicator=!1;var t=document.createElement("a"),s=(document.body.appendChild(t),t.style="display: none","Kaizen_Suggestion_"+$scope.suggestionDet.suggestionNumber+".pdf"),i=new Blob([e.data],{type:"application/pdf"}),i=URL.createObjectURL(i);t.href=i,t.download=s,t.click(),window.URL.revokeObjectURL(i),a.resolve(e)}).catch(function(e){E.flagpageloadindicator=!1,a.resolve(e.data)}),a.promise},$scope.exportStandardKaizen=function(){var e=new FormData,t=angular.element("#exportStandardKaizen").val(),a=(e.append("content",t),E.flagpageloadindicator=!0,$q.defer());return $http.post($scope.kaizenExportUrl,e,{transformRequest:angular.identity,responseType:"arraybuffer",headers:{"Content-Type":void 0,Authorization:r.getToken()}}).then(function(e){E.flagpageloadindicator=!1;var t=document.createElement("a"),s=(document.body.appendChild(t),t.style="display: none","Kaizen_Suggestion_"+$scope.suggestionDet.suggestionNumber+".pdf"),i=new Blob([e.data],{type:"application/pdf"}),i=URL.createObjectURL(i);t.href=i,t.download=s,t.click(),window.URL.revokeObjectURL(i),a.resolve(e)}).catch(function(e){E.flagpageloadindicator=!1,a.resolve(e.data)}),a.promise},$scope.setEvalAllPillar=function(){for(var e=!1,t=0;t<$scope.activityList.length;t++)$scope.activityList[t].isEvalPillarselect&&(e=!0);$scope.suggestionDet.hdSelected=!e},$scope.setEvalAllMachine=function(){for(var e=!1,t=0;t<$scope.machineList.length;t++)$scope.machineList[t].isEvalMachineSelect&&(e=!0);$scope.suggestionDet.hdSelected=!e},$scope.setEvalAllPlant=function(){for(var e=!1,t=0;t<$scope.hDBranchList.length;t++)$scope.hDBranchList[t].isEvalPlantselect&&(e=!0);0<$scope.machineHDList.length&&(e=!0),$scope.suggestionDet.hdSelected=!e},$scope.setEvalCirclePillar=function(e){for(var t=0;t<$scope.circleList.length;t++)e.isEvalCircleselect?$scope.circleList[t].isEvalCircleselect=!1:$scope.circleList[t].isEvalCircleselect=!0},$scope.setImplAllPillar=function(e){e.isImplPillarselect=!e.isImplPillarselect;for(var t=!1,s=0;s<$scope.activityList.length;s++)e.isImplPillarselect?$scope.activityList[s].isImplPillarselect=!0:$scope.activityList[s].isImplPillarselect=!1,$scope.activityList[s].isImplPillarselect&&(t=!0);$scope.suggestionDet.hdSelected=!t},$scope.setImplCirclePillar=function(e){e.isImplCircleselect=!e.isImplCircleselect;for(var t=0;t<$scope.circleList.length;t++)e.isImplCircleselect?$scope.circleList[t].isImplCircleselect=!0:$scope.circleList[t].isImplCircleselect=!1},$scope.setEvalPlant=function(e){e.isEvalPlantselect=!e.isEvalPlantselect;for(var t=0;t<$scope.hDBranchList.length;t++)e.isEvalPlantselect?$scope.hDBranchList[t].isEvalPlantselect=!0:$scope.hDBranchList[t].isEvalPlantselect=!1},$scope.getbranchlistbyorgid=function(){b.httpGet("getbranchlistbyorgid/"+$scope.loggedInUserOrgId).then(function(e){1==e.result?$scope.hDBranchList=e.branchList:$scope.hDBranchList=[]})},$scope.getbranchlistbyorgid(),$scope.getCircleList(),$scope.getMasterOperationList($scope.loggedInUserBranchId),$scope.setParentExportData=function(e){$scope.parentexportProject=angular.copy(e);var t=[];if(null!=$scope.parentexportProject.sugImplTeam&&null!=$scope.parentexportProject.sugImplTeam&&0<$scope.exportProject.sugImplTeam.length){for(var s=0;s<$scope.parentexportProject.sugImplTeam.length;s++)t.push($scope.parentexportProject.sugImplTeam[s].empName);$scope.parentexportProject.teamMemberNames=t.join()}$scope.parentexportProject.activityName="";for(s=0;s<$scope.activityList.length;s++)$scope.parentexportProject.activityName+="<td style='border: 1px solid black;border-collapse: collapse;padding: 5px;text-align: left;'>"+$scope.activityList[s].activityName+"</td>";if($scope.parentexportProject.category="",null!=$scope.catbranchwise&&0<$scope.catbranchwise.length)for(s=0;s<$scope.catbranchwise.length;s++)$scope.catbranchwise[s].catId==$scope.suggestionDet.category.catId?$scope.parentexportProject.category+="<span style='width: 30px;border: 1px solid #000;margin: 1px;position: relative;padding:5px;font-weight:bold;'>"+$scope.catbranchwise[s].categoryName[0]+"<div style='position: absolute;right: 0px;top:-3px;'><span style='font-size:12px;color: #615b5b;font-weight:bold;'>&#10003;</span></div></span>":$scope.parentexportProject.category+="<span style='width: 30px;border: 1px solid #000;margin: 1px;position: relative;padding:5px;'>"+$scope.catbranchwise[s].categoryName[0]+"</span>"},$scope.getParentSuggestionDetails=function(){b.httpGet("getSuggestionDetails/"+$scope.suggestionDet.parentSuggestionHDId).then(function(e){if($scope.flagSuggDetLoader=!1,$scope.isExecutiveSugg=!1,$scope.flagSuggDetBoxIndicator=!1,$scope.isSelectedSuggestionEdited=!1,$scope.parentKaizanDetails={},null!=e&&"success"==e.status){$scope.clearSuggDetFields(),$scope.parentKaizanDetails=e.sugesstionDetails,$scope.parentKaizanDetails.changeDocInput="",$scope.parentKaizanDetails.docFileName="";for(var t=0;t<$scope.parentKaizanDetails.implTeamList.length;t++)"null"==$scope.parentKaizanDetails.implTeamList[t].implInputs&&($scope.parentKaizanDetails.implTeamList[t].implInputs="");for(t=0;t<$scope.suggestionDet.sugEmpDocDetails.length;t++)null!=$scope.suggestionDet.parentKaizanDetails[t].url&&null!=$scope.parentKaizanDetails.sugEmpDocDetails[t].url.lastIndexOf(".")&&($scope.suggestionDet.parentKaizanDetails[t].ext=$scope.parentKaizanDetails.sugEmpDocDetails[t].url.substring($scope.parentKaizanDetails.sugEmpDocDetails[t].url.lastIndexOf(".")+1));if(1==$scope.parentKaizanDetails.isExecutive&&($scope.isExecutiveSugg=!0),0<$scope.parentKaizanDetails.implBenefitAnalysisList.length&&null!=$scope.parentKaizanDetails.implBenefitAnalysisList){for(var s=[],t=0;t<$scope.parentKaizanDetails.implBenefitAnalysisList.length;t++)s.push($scope.parentKaizanDetails.implBenefitAnalysisList[t].benefitAnalysis.benefits);$scope.kaizenExportFormatedData.benefits=s.toString()}if(null!=$scope.parentKaizanDetails.document&&0!=$scope.parentKaizanDetails.document.length){$scope.parentKaizanDetails.doc={};for(t=0;t<$scope.parentKaizanDetails.document.length;t++)null!=$scope.parentKaizanDetails.document[t].fileName||""!=$scope.parentKaizanDetails.document[t].fileName?$scope.parentKaizanDetails.doc.fileName=$scope.parentKaizanDetails.document[t].fileName:$scope.parentKaizanDetails.doc.fileName="N/A",null!=$scope.parentKaizanDetails.document[t].document.documentName||""!=$scope.parentKaizanDetails.document[t].document.documentName?$scope.parentKaizanDetails.doc.docName=$scope.parentKaizanDetails.document[t].document.documentName:$scope.parentKaizanDetails.doc.docName="N/A",null==$scope.parentKaizanDetails.document[t].document.owner.firstName&&""==$scope.parentKaizanDetails.document[t].document.owner.firstName&&""==$scope.parentKaizanDetails.document[t].document.owner.lastName&&null==$scope.parentKaizanDetails.document[t].document.owner.lastName||($scope.parentKaizanDetails.doc.ownerName=$scope.parentKaizanDetails.document[t].document.owner.firstName+" "+$scope.parentKaizanDetails.document[t].document.owner.lastName)}else $scope.parentKaizanDetails.doc={};for(t=0;t<$scope.suggestionDet.sugesstionStatusAudit.length;t++)if($scope.suggestionDet.sugesstionStatusAudit[t].status_master.status==$scope.CONST.STATUS.Implemented.status&&($scope.parentKaizanDetails.kaizanEndDate=$filter("date")(new Date($scope.suggestionDet.sugesstionStatusAudit[t].createdDate),"MMM d, y"),$scope.suggestionDet.ownerDetails=[],null!=$scope.suggestionDet.document)&&0!=$scope.suggestionDet.document.length)for(var i,a=0;a<$scope.suggestionDet.document.length;a++)"COMPLETED"==$scope.suggestionDet.document[a].status&&(i={ownerName:$scope.suggestionDet.document[a].document.owner.firstName+" "+$scope.suggestionDet.document[a].document.owner.lastName,docName:$scope.suggestionDet.document[a].document.documentName,docDate:$scope.suggestionDet.document[a].updatedDate},$scope.suggestionDet.ownerDetails.push(i));if(null!=$scope.activityList&&0<$scope.activityList.length)for(var n=0;n<$scope.activityList.length;n++)$scope.activityList[n].isselect=!1;if(null!=$scope.parentKaizanDetails.suggestionActivityList&&0<$scope.parentKaizanDetails.suggestionActivityList.length)for(t=0;t<$scope.parentKaizanDetails.suggestionActivityList.length;t++)for(a=0;a<$scope.activityList.length;a++)if($scope.parentKaizanDetails.suggestionActivityList[t].activity.id==$scope.activityList[a].id){$scope.activityList[a].isselect=!0;break}for(n=0;n<$scope.orgLevelBenefitMasterList.length;n++)$scope.orgLevelBenefitMasterList[n].isselect=!1;if(null!=$scope.parentKaizanDetails.implBenefitAnalysisList&&0<$scope.parentKaizanDetails.implBenefitAnalysisList.length)for(t=0;t<$scope.parentKaizanDetails.implBenefitAnalysisList.length;t++)for(a=0;a<$scope.orgLevelBenefitMasterList.length;a++)if($scope.orgLevelBenefitMasterList[a].benfitId==$scope.parentKaizanDetails.implBenefitAnalysisList[t].benefitAnalysis.benfitId){$scope.orgLevelBenefitMasterList[a].isselect=!0;break}null!=$scope.parentKaizanDetails.sugEmpDocDetails&&0<$filter("filter")($scope.parentKaizanDetails.sugEmpDocDetails,{docType:"beforeDoc"},!0).length?$scope.parentKaizanDetails.beforeImgArray=$filter("filter")($scope.parentKaizanDetails.sugEmpDocDetails,{docType:"beforeDoc"},!0):$scope.parentKaizanDetails.beforeImgArray=[],$scope.parentKaizanDetails.blocksummery={},null!=$scope.parentKaizanDetails.sugEmpDocDetails&&0<$filter("filter")($scope.parentKaizanDetails.sugEmpDocDetails,{docType:"beforeDoc"},!0).length?$scope.parentKaizanDetails.blocksummery.beforeImg=$filter("filter")($scope.parentKaizanDetails.sugEmpDocDetails,{docType:"beforeDoc"},!0):$scope.parentKaizanDetails.blocksummery.beforeImg=[];var l=[];if(null!=$scope.parentKaizanDetails.implBenefitAnalysisList&&0<$scope.parentKaizanDetails.implBenefitAnalysisList.length){for(t=0;t<$scope.parentKaizanDetails.implBenefitAnalysisList.length;t++)l.push($scope.parentKaizanDetails.implBenefitAnalysisList[t].benefitAnalysis.benefits);$scope.parentKaizanDetails.blocksummery.benefits=l.join()}var o="";if(null!=$scope.orgLevelBenefitMasterList&&0<$scope.orgLevelBenefitMasterList.length){for(t=0;t<$scope.orgLevelBenefitMasterList.length;t++)$scope.orgLevelBenefitMasterList[t].branch.branchId==$scope.parentKaizanDetails.branch.branchId&&($scope.orgLevelBenefitMasterList[t].isselect?o+="<span style='width: 30px;border: 1px solid #000;margin: 1px;position: relative;padding:5px;font-weight:bold;'>"+$scope.orgLevelBenefitMasterList[t].benefits[0]+"<div style='position: absolute;right: 0px;top:-3px;'><span style='font-size:12px;color: #615b5b;font-weight:bold;'>&#10003;</span></div></span>":o+="<span style='width: 30px;border: 1px solid #000;margin: 1px;position: relative;padding:5px;'>"+$scope.orgLevelBenefitMasterList[t].benefits[0]+"</span>");$scope.parentKaizanDetails.blocksummery.category=o}for(t=0;t<$scope.parentKaizanDetails.sugesstionStatusAudit.length;t++)$scope.parentKaizanDetails.sugesstionStatusAudit[t].status_master.status==$scope.CONST.STATUS.SuggestionAssigned.status&&($scope.parentKaizanDetails.blocksummery.controller=$scope.parentKaizanDetails.sugesstionStatusAudit[t].emp_details);var r=[];if(null!=$scope.parentKaizanDetails.evaluationTeamList&&0<$scope.parentKaizanDetails.evaluationTeamList.length){for(t=0;t<$scope.parentKaizanDetails.evaluationTeamList.length;t++)r.push($scope.parentKaizanDetails.evaluationTeamList[t].empName);$scope.parentKaizanDetails.blocksummery.evaluator=r.join()}var g=[];if(null!=$scope.parentKaizanDetails.implTeamList&&0<$scope.parentKaizanDetails.implTeamList.length){for(t=0;t<$scope.parentKaizanDetails.implTeamList.length;t++)g.push($scope.parentKaizanDetails.implTeamList[t].empName);$scope.parentKaizanDetails.blocksummery.implementor=g.join()}if(null!=$scope.parentKaizanDetails.sugesstionStatusAudit&&0<$scope.parentKaizanDetails.sugesstionStatusAudit.length)for(t=0;t<$scope.parentKaizanDetails.sugesstionStatusAudit.length;t++)$scope.parentKaizanDetails.sugesstionStatusAudit[t].status_master.status==$scope.CONST.STATUS.UnderFinanceApproval.status&&($scope.parentKaizanDetails.blocksummery.financeController=$scope.parentKaizanDetails.sugesstionStatusAudit[t].emp_details.firstName+" "+$scope.parentKaizanDetails.sugesstionStatusAudit[t].emp_details.lastName);if(null!=$scope.parentKaizanDetails.sugesstionStatusAudit&&0<$scope.parentKaizanDetails.sugesstionStatusAudit.length)for(t=0;t<$scope.parentKaizanDetails.sugesstionStatusAudit.length;t++)$scope.parentKaizanDetails.sugesstionStatusAudit[t].status_master.status==$scope.CONST.STATUS.UnderFinanceVerification.status&&($scope.parentKaizanDetails.blocksummery.financeValidator=$scope.parentKaizanDetails.sugesstionStatusAudit[t].emp_details.firstName+" "+$scope.parentKaizanDetails.sugesstionStatusAudit[t].emp_details.lastName);var u,d=[];if(null!=$scope.parentKaizanDetails.document&&0<$scope.parentKaizanDetails.document.length){for(let e=0;e<$scope.parentKaizanDetails.document.length;e++)"COMPLETED"==$scope.parentKaizanDetails.document[e].status&&(u=$scope.parentKaizanDetails.document[e],d.push(u.document.documentName));$scope.parentKaizanDetails.blocksummery.document=d.join()}}else C.create($filter("translate")("Oops_Please_try_again"),4e3,"error");if(0==$scope.suggestionList.length&&($scope.suggestionDet={}),null!=$scope.parentKaizanDetails.suggestionTrackerDetails&&0<$scope.parentKaizanDetails.suggestionTrackerDetails.length)for(let e=0;e<$scope.parentKaizanDetails.suggestionTrackerDetails.length;e++)null!=$scope.parentKaizanDetails.suggestionTrackerDetails[e].team_type_master&&"Implementation"==$scope.parentKaizanDetails.suggestionTrackerDetails[e].team_type_master.type&&($scope.parentImplwhyWhyAnalysisData=$scope.parentKaizanDetails.suggestionTrackerDetails[e])})},$scope.selectedRejection=[],$scope.getRejectionListDetails=function(e){$scope.getSelectedRejection=[],$scope.selectedSuggId=e,$scope.getReject={sugId:$scope.selectedSuggId},b.httpPost($scope.getReject,"getsuggData").then(function(e){if(e.result){if(null!=e.data.rejectionList&&0<e.data.rejectionList.length){$scope.getSelectedRejection=e.data.rejectionList;for(let e=0;e<$scope.getSelectedRejection.length;e++)$scope.selectAud=$scope.getSelectedRejection[e].stsadtId}}else 100==e.statusCode?($scope.statusMessage=e.reason,$("#statusMessageModal").modal({backdrop:"static",keyboard:!1})):C.create("Error occured while getting rejection reason",3e3,"error")})},$scope.selectFilterAllRejection=function(){var e=!$scope.selectAllRejection;if($scope.selectAllRejection=e,$scope.selectRejArray=[],null!=$scope.getRejectionList&&0<$scope.getRejectionList.length){for(var t=0;t<$scope.getRejectionList.length;t++)$scope.getRejectionList[t].isSelected=$scope.selectAllRejection,$scope.selectRejArray.push($scope.getRejectionList[t].id);$scope.count=$filter("filter")($scope.getRejectionList,{isSelected:!0},!0).length}else $scope.selectRejArray=[]},$scope.isOther=!1,$scope.isRejectByEval=!1,$scope.isDropdownRejImpl=!1,$scope.isDropdownRejEval=!1,$scope.count=0,$scope.selectRejArray=[],$scope.onRejection=function(){$scope.isOther=!0,1==$scope.isOther&&($scope.isDropdownRej=!1)},$scope.isImplementerRej=!1,$scope.onImplementerReject=function(){$scope.isImplementerRej=!0,1==$scope.isImplementerRej&&($scope.isDropdownRejImpl=!1)},$scope.onImplementerRejectModal=function(){$scope.isDropdownRejImpl=!0,$scope.isImplementerRej=!1},$scope.isEvaluatorReject=!1,$scope.onEvaluatorReject=function(){$scope.isEvaluatorReject=!0,1==$scope.isEvaluatorReject&&($scope.isDropdownRejEval=!1)},$scope.onFinanceController=function(){$scope.isDropdownRejFc=!0,$scope.isFinanceReject=!1,$scope.isSubmitFinanace=!0},$scope.isFinanceReject=!1,$scope.onFinanceOther=function(){$scope.isFinanceReject=!0,1==$scope.isFinanceReject&&($scope.isDropdownRejFc=!1,$scope.isSubmitFinanace=!0)},$scope.setFilterRejectionSelected=function(e){if($scope.selectRejArray=[],$scope.selectedRejId=e.id,e.isSelected=!e.isSelected,null!=$scope.getRejectionList&&0<$scope.getRejectionList.length){for(var t=0;t<$scope.getRejectionList.length;t++)$scope.getRejectionList[t].isSelected?$scope.selectRejArray.push($scope.getRejectionList[t].id):($scope.getRejectionList[t].isSelected=!1,$scope.selectAllRejection=!1);$scope.count=$filter("filter")($scope.getRejectionList,{isSelected:!0},!0).length,$scope.selectAllRejection=$scope.getRejectionList.length==$scope.count}},$scope.dropDownRejectionList=function(){$scope.getRejectionList=[],b.httpGet("getSuggRejectionReason/"+E.empDetails.organization.orgId+"/"+$scope.suggestionDet.branch.branchId).then(function(e){$scope.rejectionListLoding=!1,e.result&&null!=e.data&&0<e.data.length?$scope.getRejectionList=e.data:$scope.getRejectionList=[]})},$scope.showParentKaizanDetails=function(){$scope.getParentSuggestionDetails(),$("#parentKaizenModal").modal({backdrop:"static",keyboard:!1})},$scope.machineHDList=[],$scope.addmachineHDList=function(t){if($scope.isEmpty(t))C.create($filter("translate")("Please_select_data"),5e3,"error");else if(null==t.operation||null==t.operation||""==t.operation)C.create($filter("translate")("Please_select_operation"),5e3,"error");else{if(null!=$scope.machineHDList&&0<$scope.machineHDList.length)for(let e=0;e<$scope.machineHDList.length;e++)if($scope.machineHDList[e].operation.id==t.operation.id)return void C.create("Already Exist",5e3,"error");var e=angular.copy(t),s=($scope.machineHDList.push(e),!1);0<$scope.machineHDList.length&&(s=!0);for(var i=0;i<$scope.hDBranchList.length;i++)$scope.hDBranchList[i].isEvalPlantselect&&(s=!0);$scope.suggestionDet.hdSelected=!s,$scope.evalMachineHDList={}}},$scope.removeHDMachine=function(e){$scope.machineHDList.splice(e,1)},$scope.implMachineHDList=[],$scope.addimplMachineHDList=function(t){for(let e=t.id=0;e<$scope.implMachineHDList.length;e++)if($scope.implMachineHDList[e].operation.id==t.operation.id)return void C.create($filter("translate")("Already_Exist"),5e3,"error");var e=angular.copy(t);$scope.implMachineHDList.push(e)},$scope.removeImplHDMachine=function(e){$scope.implMachineHDList.splice(e,1)},$scope.WhyWhyAnlysisTip={whywhyAnalysisToolTip:"Analytics showing as how the real root cause was identified",rootCause:"Root Cause is basically reason for the problem",counterMeasures:"Action taken to prevent the problem",kaizenIdea:"Suggestion  for the problem",result:"Outcome post implementation of suggestion",whatToDo:"Indicating 'what to check/audit to ensure that kaizen will be effective in long run'",howToDo:"Indicating 'how to check/audit to ensure that kaizen will be effective in long run'",frquency:"Repetation of check /audit"},$scope.getSuggestionTypeDetail=function(e,t){e&&t&&b.httpGet("suggestion/getSuggestionTypeDetail/"+e+"/"+t).then(function(e){e.result?$scope.parentSuggType=e.suggestionDTO:$scope.parentSuggType={}})},$scope.CloseGuestSugg=function(){$scope.data={statusId:$scope.CONST.STATUS.GSCloseWithoutImplementation.statusId,sugId:$scope.selectedSuggId,summary:$scope.suggestionDet.guestComment,empId:parseInt($scope.loggedInEmpId),branchId:$scope.loggedInUserBranchId,orgId:$scope.loggedInUserOrgId},b.httpPost($scope.data,"closeGSSuggestionByEvalHD").then(function(e){$scope.suggestionDet.closeGuest=!1,"success"==e.status?($scope.suggestionDet={},$scope.getSuggestionDetails($scope.selectedSuggId),C.create($filter("translate")("Suggestion_closed_successfully"),5e3,"success"),$scope.getsuggestionList("onUpdate"),$scope.getStatusWiseCount()):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")})},$scope.particularsnew=[],$scope.groupingParticular=function(t){if($scope.particularsnew=[],t&&($scope.newSug.initiatorPart=void 0,null!=$scope.particulars)&&0<$scope.particulars.length){for(let e=0;e<$scope.particulars.length;e++)$scope.particulars[e].isInitiatorSelected=!1,t?$scope.particulars[e].category.catId==t.catId?($scope.particulars[e].type="",$scope.particulars[e].isSelected=!1,$scope.particularsnew.push($scope.particulars[e])):($scope.particulars[e].type="Other category benefits",$scope.particulars[e].isSelected=!1):$scope.particulars[e].type="";$scope.particularsnew.push({id:0,particulars:"Other Benefits",type:""})}},$scope.clearBenefit=function(){$scope.particularsnew=[]},$scope.setPerticularsSelected=function(e){for(var t=0;t<$scope.particulars.length;t++)e.isSelected?$scope.particulars[t].isSelected=!1:$scope.particulars[t].isSelected=!0,$scope.particulars[t].id!==e.id&&($scope.particulars[t].isSelected=!1,$scope.particulars[t].isInitiatorSelected=!1),$scope.particulars[t].id===e.id&&($scope.newSug.initiatorPart=$scope.particulars[t],$scope.particulars[t].isInitiatorSelected=!0);var s=$filter("filter")($scope.particulars,{isSelected:!0},!0).length;$scope.selectAllStatus=$scope.particulars.length==s,$scope.selectAllStatus&&$scope.statusToggle()},$scope.resetPerticularsList=function(e){if("Other Benefits"==e.particulars)for(let e=0;e<$scope.particulars.length;e++)$scope.particulars[e].isSelected=!1,"Other category benefits"==$scope.particulars[e].type&&$scope.particularsnew.push($scope.particulars[e]);else{for(let e=0;e<$scope.particularsnew.length;e++)0==$scope.particularsnew[e].id&&($scope.particularsnew[e].isSelected=!1);$scope.newSug.catId.catId==e.category.catId&&$scope.groupingParticular(e.category)}},$scope.benefitToggle=function(){$(".benefitWrapper .benefitList").slideToggle("fast")},$scope.toggleBenefitDiv=function(e){var t=$(".benefitWrapper");t===e.target||t.has(e.target).length||$(".benefitList").slideUp("fast")},$scope.duplicationPaginate={current:1,total:0,perPage:5,maxsize:5},$scope.onSimilarSuggPaginationClick=function(e){$scope.duplicationPaginate.current=e},$scope.showSimilarSugg=function(){$scope.duplicationPaginate={current:1,total:0,perPage:5,maxsize:5},$scope.similarsuggestionList=[],$scope.suggestionInputDetails.acceptRejectStatus="Duplication",$scope.data={sugId:$scope.selectedSuggId,branchId:$scope.loggedInUserBranchId,suggestion:$scope.suggestionDet.suggestionTitle+" "+$scope.suggestionDet.problemAnalysis+" "+$scope.suggestionDet.sugession},b.httpPost($scope.data,"findSimilarSuggestions").then(function(t){if(t.result)if(t.hasOwnProperty("similarSuggCount")&&($scope.duplicationPaginate.total=t.similarSuggCount),null!=t.similarSugList&&0<t.similarSugList.length)for(let e=0;e<t.similarSugList.length;e++)t.similarSugList[e].sugId!=$scope.suggestionDet.sugId&&$scope.similarsuggestionList.push(t.similarSugList[e]);else $scope.similarsuggestionList=[];else $scope.similarsuggestionList=[]}),$("#modelSimilarSugg").modal({backdrop:"static",keyboard:!1})},$scope.setActivityInfo=function(){if(null!=$scope.activityList&&0<$scope.activityList.length)for(let e=0;e<$scope.activityList.length;e++)"KK"==$scope.activityList[e].activityName?($scope.activityList[e].desc="Cost saving, Ergonomic improvements, Productivity/OEE improvement, Setup time reduction, delivery method or delivery time to customer, etc.",$scope.activityList[e].fullForm="Kobetsu-Kaizen or Focused improvement"):"JH"==$scope.activityList[e].activityName?($scope.activityList[e].desc="Any Abnormality elimination (Out of the 7) , simplifying the CLITA tasks, reducing the CLITA time taken, closure of any audit points related to JH Pillar/JH activities.",$scope.activityList[e].fullForm="Jishu-Hozen or Autonomous Maintenance"):"QM"==$scope.activityList[e].activityName?($scope.activityList[e].desc="Internal defect/scrap reduction, improving rejection handling, to avoid Customer complaint - both reported or proactive, improvement in child part packaging/storage/handling, closure of any audit points related to Quality Systems, etc.",$scope.activityList[e].fullForm="Quality Maintenance"):"PM"==$scope.activityList[e].activityName?($scope.activityList[e].desc="Improvement points for - PM activities, PM adherence, improving quality of PM done by concerned team.",$scope.activityList[e].fullForm="Planned Maintenance"):"SH"==$scope.activityList[e].activityName?($scope.activityList[e].desc="Improving safety aspects in work area, elimination of near miss concerns, improvement in health and hygiene of employees, reducing any harmful effects on environment, etc.",$scope.activityList[e].fullForm="Safety, Health and Environment"):"OTPM"==$scope.activityList[e].activityName?($scope.activityList[e].desc="Improvements related to shopfloor office areas, common areas in lines, etc.",$scope.activityList[e].fullForm="Office Total Productive Maintenance"):"ET"==$scope.activityList[e].activityName?($scope.activityList[e].desc="Related to On-Job-Training methods, skill matrix methodology followed, closure of any audit points related to training, etc.",$scope.activityList[e].fullForm="Education and Training"):"DM"==$scope.activityList[e].activityName&&($scope.activityList[e].desc="This pillar is responsible for the development of systems within the company, so that company can grow.",$scope.activityList[e].fullForm="Development Management")},$scope.getActivityList=function(){b.httpGet("getActivityList").then(function(e){e.result&&null!=e.activityList&&0<e.activityList.length?($scope.activityList=e.activityList,$scope.setActivityInfo()):$scope.activityList=[]})},$scope.getPillarInfo=function(){null!=$scope.activityList&&0<$scope.activityList.length?$scope.setActivityInfo():$scope.getActivityList(),$("#pillarInfoModal").modal({backdrop:"static",keyboard:!1})},$scope.isMahle=function(){var e,t=!1;return t=null==E.empDetails||null==E.empDetails||null==(e=E.empDetails.organization.alies)||angular.isUndefined(e)||"mahle"!=e?t:!0},$scope.KaizenSustenanceMon={},$scope.getKaizenSustenanceMonitoring=function(e,t){$scope.captionName=t,$scope.KaizenSustenanceMon.selectedfilterId=e,console.log($scope.suggestionList),$scope.getKaizenSustenanceMonitoringDetails($scope.selectedfilterId),$("#kaizenSustenanceMonitoring").modal({backdrop:"static",keyboard:!1})},$scope.getKaizenSustenanceMonitoringDetails=function(e){if($scope.data={orgId:$scope.loggedInUserOrgId,branchIds:[],caption:$scope.captionName,suggestionLevel:"WITHIN_PLANT",typeId:$scope.statusCountFilter,assignedToId:$scope.loggedInEmpId},null!=$scope.guestBranchList)for(var t=0;t<$scope.guestBranchList.length;t++)$scope.guestBranchList[t].isSelected&&$scope.data.branchIds.push(parseInt($scope.guestBranchList[t].branchId));$scope.globalLoadingIndicator=!0,$scope.flagEmployeeListSpinner=!1,$scope.flagTblemployee=!1,$scope.showTable=!0,b.httpPost($scope.data,"getsuggestionlistnew").then(function(e){if(1==e.result){$scope.globalLoadingIndicator=!1,$scope.kaizenSustenanceMonitoringList=e.sugessionsByEmpIdList,console.log($scope.kaizenSustenanceMonitoringList);for(var t=0;t<$scope.kaizenSustenanceMonitoringList.length;t++){var s="";$scope.kaizenSustenanceMonitoringList[t].firstName&&(s+=$scope.kaizenSustenanceMonitoringList[t].firstName),$scope.kaizenSustenanceMonitoringList[t].lastName&&($scope.kaizenSustenanceMonitoringList[t].firstName&&(s+=" "),s+=$scope.kaizenSustenanceMonitoringList[t].lastName),$scope.kaizenSustenanceMonitoringList[t].empName=s}console.log($scope.kaizenSustenanceMonitoringList)}else $scope.kaizenSustenanceMonitoringList=[]})},$scope.getExportKaizenSustenanceMonitoring=function(){for(var e=new Date,t=(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),[]),s=0;s<$scope.kaizenSustenanceMonitoringList.length;s++){$scope.kaizenSustenanceMonitoringList[s].createdSuggestionNumber;t.push({"Employee Name":$scope.kaizenSustenanceMonitoringList[s].empName||"-","Suggestion Id":$scope.kaizenSustenanceMonitoringList[s].suggestionNumber||"-","Suggestion Title":$scope.kaizenSustenanceMonitoringList[s].suggestionTitle||"-",Department:$scope.kaizenSustenanceMonitoringList[s].deptName||"-","Suggestion Source":$scope.kaizenSustenanceMonitoringList[s].suggestionSource||"-",Category:$scope.kaizenSustenanceMonitoringList[s].catName||"-",Benefit:$scope.kaizenSustenanceMonitoringList[s].particulars||"-","Current Status":$scope.kaizenSustenanceMonitoringList[s].label||"-"})}m.exportDataToExcel(t,"Suggestion Details","Suggestion_Details")},$scope.setDeptBranchWiseTab="branch",$scope.setDeptBranchWise=function(e){"branch"==($scope.setDeptBranchWiseTab=e)?($scope.setSelectedDeptIdForGraph=0,$scope.getBenefitWiseCount($scope.graphFromDt,$scope.graphToDt),$scope.getStatusGraph($scope.graphFromDt,$scope.graphToDt),$scope.getCostEffect($scope.graphFromDt,$scope.graphToDt)):($scope.selectGraphDeptId=$scope.selectGraphDeptId,$scope.setGraphDeptWise($scope.selectGraphDeptId))},$scope.setSelectedDeptIdForGraph=0,$scope.setGraphDeptWise=function(e){$scope.setSelectedDeptIdForGraph=e,$scope.getBenefitWiseCount($scope.graphFromDt,$scope.graphToDt),$scope.getStatusGraph($scope.graphFromDt,$scope.graphToDt),$scope.getCostEffect($scope.graphFromDt,$scope.graphToDt)},$scope.exportKaizenData=function(){var e=new FormData,t=angular.element("#kaizenDetails").val(),a=(e.append("content",t),E.flagpageloadindicator=!0,$q.defer());return $http.post($scope.kaizenExportUrl,e,{transformRequest:angular.identity,responseType:"arraybuffer",headers:{"Content-Type":void 0,Authorization:r.getToken()}}).then(function(e){E.flagpageloadindicator=!1;var t=document.createElement("a"),s=(document.body.appendChild(t),t.style="display: none","Kaizen_Suggestion_"+$scope.suggestionDet.suggestionNumber+".pdf"),i=new Blob([e.data],{type:"application/pdf"}),i=URL.createObjectURL(i);t.href=i,t.download=s,t.click(),window.URL.revokeObjectURL(i),a.resolve(e)}).catch(function(e){E.flagpageloadindicator=!1,a.resolve(e.data)}),a.promise},$scope.changeLanguage=function(e){window.location.hostname;2==e&&b.httpGetLocal("translations/suggestion-mr.json").then(function(e){$scope.langTranslate=e}),1==e&&b.httpGetLocal("i18n/Suggestion/en.json").then(function(e){$scope.langTranslate=e})},$scope.getTabId=function(){var e=window.location.href,t="tabId".replace(/[\[\]]/g,"\\$&"),t=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return t?t[2]?void(1!=(e=decodeURIComponent(t[2].replace(/\+/g," ")))&&($scope.initMasterDataForSugg(),$scope.getBranchAccessSetup(),$scope.setMainTab(parseInt(e),""),$scope.resetRzSlider())):"":null},$scope.getEvalcommentDetails=function(){var e;!$scope.isEmpty($scope.suggestionDet)&&null!=$scope.suggestionDet.sugesstionStatusAudit&&0<$scope.suggestionDet.sugesstionStatusAudit.length&&null!=(e=$filter("filter")($scope.suggestionDet.sugesstionStatusAudit,{status_master:{status:$scope.CONST.STATUS.EvaluationRequestAccepted.status}},!0))&&0<e.length&&b.httpGet("getSuggestionComments/"+$scope.selectedSuggId).then(function(e){e.result?$scope.suggestionComment=e.suggestionComments:$scope.suggestionComment=[]})},$scope.addComment=function(){var e;($scope.Evaldata=null)!=$scope.suggestionDet.sugesstionStatusAudit&&0<$scope.suggestionDet.sugesstionStatusAudit.length&&null!=(e=$filter("filter")($scope.suggestionDet.sugesstionStatusAudit,{status_master:{status:$scope.CONST.STATUS.EvaluationRequestAccepted.status}},!0))&&0<e.length&&($scope.Evaldata=e[0]),$scope.suggestionDet.comment="",$scope.getEvalcommentDetails(),$("#addComment").modal({backdrop:"static",keyboard:!1})},$scope.submitComment=function(e){$scope.submitSpinner=!0,""==$scope.suggestionDet.comment||null==$scope.suggestionDet.comment||null==$scope.suggestionDet.comment?(C.create($filter("translate")("Please_Enter_Comment"),4e3,"error"),$scope.submitSpinner=!1):($scope.data={comment:$scope.suggestionDet.comment,commentsRaisedById:E.empDetails.empId,sugDet:{sugId:$scope.selectedSuggId}},b.httpPost($scope.data,"saveSuggestionComments").then(function(e){$scope.submitSpinner=!1,e.result?(C.create($filter("translate")("Comment_added_successfully"),4e3,"success"),$scope.clearComments(),$scope.getEvalcommentDetails(),$("#addComment").modal("hide")):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")}))},$scope.clearComments=function(){$scope.suggestionDet.comment=""},$scope.getSuggestionEvalParametersList=function(){b.httpGet("getSuggestionEvalParameters").then(function(e){e.result&&($scope.suggestionEvalParametersList=e.suggestionKaizenParameter)})},$scope.getSuggestionEvalRatingsList=function(){b.httpGet("getSuggestionEvalRatings/"+$scope.loggedInUserBranchId).then(function(e){e.result&&($scope.suggestionEvalRatingsList=e.suggestionKaizenRating)})},$scope.getSuggestionEvalRatingsList(),$scope.getSuggestionEvalParametersList(),$scope.juryInputSave=function(t,e){if($scope.parameterListNew=t.parameterList,$scope.juryDatanew=t,$scope.sugAssignedToJury=[],"PRODUCTION_HEAD"==$scope.juryDatanew.inputType&&"UPDATE"==e)for(var s=0;s<t.ratingList.length;s++)1==t.ratingList[s].isSelected&&$scope.sugAssignedToJury.push({sugAssignedToJury:{id:t.jAssinedToId},phRatingId:t.ratingList[s].id,phRating:t.ratingList[s].scale,isPlantHead:1});else if("JURY"==$scope.juryDatanew.inputType&&"UPDATE"==e){for(var i=0,a=0;a<$scope.parameterListNew.length;a++)for(var n=0;n<$scope.juryDatanew.suggestionEvalJuryInput.length;n++)if($scope.parameterListNew[a].id==$scope.juryDatanew.suggestionEvalJuryInput[n].parameterId)for(s=0;s<$scope.parameterListNew[a].ratingList.length;s++)1==$scope.parameterListNew[a].ratingList[s].isSelected&&(i+=$scope.parameterListNew[a].ratingList[s].scale,$scope.sugAssignedToJury.push({id:$scope.juryDatanew.suggestionEvalJuryInput[n].id,sugAssignedToJury:{id:$scope.juryDatanew.jAssinedToId},parameterId:$scope.parameterListNew[a].id,ratingId:$scope.parameterListNew[a].ratingList[s].id,juryRating:$scope.parameterListNew[a].ratingList[s].scale,totalRating:0}));for(var l=0;l<$scope.sugAssignedToJury.length;l++)$scope.sugAssignedToJury[l].totalRating=i}else if("PRODUCTION_HEAD"==$scope.juryDatanew.inputType&&"ADD"==e)for(s=0;s<t.ratingList.length;s++)1==t.ratingList[s].isSelected&&$scope.sugAssignedToJury.push({sugAssignedToJury:{id:t.jAssinedToId},phRatingId:t.ratingList[s].id,phRating:t.ratingList[s].scale,isPlantHead:1});else if("JURY"==$scope.juryDatanew.inputType&&"ADD"==e){for(i=0,a=0;a<$scope.parameterListNew.length;a++)for(s=0;s<$scope.parameterListNew[a].ratingList.length;s++)1==$scope.parameterListNew[a].ratingList[s].isSelected&&(i+=$scope.parameterListNew[a].ratingList[s].scale,$scope.sugAssignedToJury.push({sugAssignedToJury:{id:$scope.juryDatanew.jAssinedToId},parameterId:$scope.parameterListNew[a].id,ratingId:$scope.parameterListNew[a].ratingList[s].id,juryRating:$scope.parameterListNew[a].ratingList[s].scale}));if($scope.sugAssignedToJury.length<6)return void C.create($filter("translate")("Please_submit_all_inputs"),5e3,"error");for(l=0;l<$scope.sugAssignedToJury.length;l++)$scope.sugAssignedToJury[l].totalRating=i}b.httpPost($scope.sugAssignedToJury,"submitSuggestionJuryInputs").then(function(e){1==e.result?("COMPLETED"==t.jStatus?C.create($filter("translate")("Jury_ratings_modified_successfully"),4e3,"success"):C.create($filter("translate")("Jury_rating_submitted_successfully"),4e3,"success"),$scope.getsuggestionList(),$scope.getJuryTopKiazenList(),$scope.getJueryStatusList(),t.isupdate=!1):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")})},$scope.juryInputupdate=function(e){e.isupdate=!0},$scope.getWinnerKizan4block=function(e){$scope.getSuggestionDetails(e.sugId),$("#topkizan4block").modal({backdrop:"static",keyboard:!1})},$scope.sustenanceAuditBtn=!1,$scope.submitSustenanceData=function(e,t){$scope.sustenanceAuditBtn=!0,t.$invalid?angular.forEach(t.$error.required,function(e){e.$setDirty(),$scope.sustenanceAuditBtn=!1}):e&&(t={currentValue:$scope.suggestionDet.sustenanceAuditData.currentValue,createdBy:$scope.loggedInEmpId,updatedBy:$scope.loggedInEmpId,auditorRemark:$scope.suggestionDet.sustenanceAuditData.auditorRemark,suggestionSustenance:{sugId:$scope.selectedSuggId},sustenanceAudit:{id:$scope.suggestionDet.sustenanceAuditData.questions[0].id},stsId:130},b.httpPost(t,"test/submitSustenanceAuditInputs").then(function(e){$scope.sustenanceAuditBtn=!1,e.result?(C.create($filter("translate")("Sustenance_audit_completed_successfully"),4e3,"success"),$scope.getsuggestionList("onUpdate"),$scope.getStatusWiseCount()):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")}))},$scope.setNextVerificationDate=function(){$scope.suggestionDet.sustenanceAuditData.nextSustenaceAuditDate=$filter("date")(new Date,"yyyy-MM-dd"),$(".target-date-picker").datepicker({update:$scope.suggestionDet.sustenanceAuditData.nextSustenaceAuditDate,autoclose:!0,todayHighlight:!0})},$scope.submitSustenanceDataNew=function(e,t){if($scope.sustenanceAuditBtn=!0,t.$invalid)angular.forEach(t.$error.required,function(e){e.$setDirty(),$scope.sustenanceAuditBtn=!1});else if(e){t={createdBy:$scope.loggedInEmpId,updatedBy:$scope.loggedInEmpId,sugId:$scope.selectedSuggId,auditorId:$scope.loggedInEmpId,benefitVerifyReq:$scope.suggestionDet.sustenanceAuditData.benefitValueY,action:"",sustenanceBenefits:[],isKaizenExist:"N",remarks:$scope.suggestionDet.sustenanceAuditData.sustenaceRemarks};if("Y"==$scope.suggestionDet.sustenanceAuditData.currentValue?t.isKaizenExist="Y":null!=$scope.suggestionDet.failedReason&&null!=$scope.suggestionDet.failedReason&&""!=$scope.suggestionDet.failedReason&&(t.failedReason=$scope.suggestionDet.failedReason),$scope.suggestionInputDetails.flagsustanceKaizen?t.action="FAILED_AND_CLOSED":$scope.suggestionInputDetails.flagCloseKaizen?t.action="CLOSE_KAIZEN":$scope.suggestionDet.sustenanceAuditData.setNextDate&&(t.action="CONTINUE_VERIFICATION",t.verificationReq=!0,t.verificationDt=$scope.suggestionDet.sustenanceAuditData.nextSustenaceAuditDate),""==t.action)C.create("Please select the action",5e3,"error"),$scope.sustenanceAuditBtn=!1;else{if($scope.sustenanceBenefits=[],$scope.suggestionDet.sustenanceAuditData.benefitValueY)for(let e=0;e<$scope.suggestionDet.customEvaluationParticularsList.length;e++)"Y"==$scope.suggestionDet.customEvaluationParticularsList[e].isActive&&($scope.suggestionDet.customEvaluationParticularsList[e].tangible?$scope.sustenanceBenefits.push({auditorId:$scope.loggedInEmpId,benefits:{id:$scope.suggestionDet.customEvaluationParticularsList[e].id},unit:$scope.suggestionDet.customEvaluationParticularsList[e].unit.id,value:$scope.suggestionDet.customEvaluationParticularsList[e].value}):$scope.sustenanceBenefits.push({auditorId:$scope.loggedInEmpId,benefits:{id:$scope.suggestionDet.customEvaluationParticularsList[e].id}}));t.sustenanceBenefits=$scope.sustenanceBenefits,b.httpPost(t,"saveSustenanceAuditorInputs").then(function(e){$scope.sustenanceAuditBtn=!1,e.result?($("#sustainceInputModal").modal("hide"),$scope.suggestionInputDetails.flagCloseKaizen?C.create($filter("translate")("Sustenance_Audit_Sustained_Successfully"),4e3,"success"):$scope.suggestionInputDetails.flagsustanceKaizen?C.create($filter("translate")("Sustenance_Audit_Sustained_Successfully_Sustenance_Audit_Failed_and_Close_Successfully"),4e3,"success"):C.create($filter("translate")("Sustenance_Audit_Continue_Verification_Successfully"),4e3,"success"),$scope.getsuggestionList("onUpdate"),$scope.getStatusWiseCount()):C.create($filter("translate")("Oops_Please_try_again"),5e3,"error")})}}},$scope.showkaizenMonitorDetails=function(e,t,s,i){$scope.getSuggestionDetails(e,t,s),$scope.selectedAuditorName=i,$("#sustanceModal").modal({backdrop:"static",keyboard:!1})},$scope.focusdata=function(e,t,s){$scope.suggfocus=!1,e&&"DEPT"!=t||($scope.newdeptfocus=!0),s&&"PILLER"==t?($scope.newdeptfocus=!0,$scope.focus=!1,$scope.machfocus=!1):$scope.newdeptfocus=!1,$scope.pillarfocus=!0},$scope.lateralfocus=function(){$scope.newdeptfocus=!1,$scope.linefocus=!0,$scope.suggfocus=!0},$scope.pillardata=function(){$scope.circlefocus=!0},$scope.graphLabels=[{label:void 0,value:void 0,series:void 0}],$scope.addRemoveRow=function(e,t){"add"==t?$scope.graphLabels.push({label:void 0,value:void 0,series:void 0}):$scope.graphLabels.splice(e,1)},$scope.clearAllGraphData=function(){$scope.dashboardData={},$scope.graphLabels=[{label:void 0,value:void 0,series:void 0}],$scope.dashboardData.selectedTypeId=$scope.graphTypeList[0]},$scope.graphTypeList=[{id:1,type:"Line Chart"},{id:1,type:"Bar Chart"}],$scope.dashboardData={},$scope.dashboardData.selectedTypeId=$scope.graphTypeList[0],$scope.generateData=function(){if(null!=$scope.graphLabels&&0<$scope.graphLabels.length){for(let e=0;e<$scope.graphLabels.length;e++)null==$scope.graphLabels[e].series&&null==$scope.graphLabels[e].series&&($scope.graphLabels[e].series="");$scope.dashboardData.generatedGraph=dashboardGraphFactory1.getLevelWiseDefect($scope.graphLabels,"",""),$scope.dashboardData.generatedGraph.graphOption.scales.xAxes[0].offset=!0,$scope.dashboardData.generatedGraph.graphOption.elements.line.fill=!1,$scope.dashboardData.generatedGraph.graphOption.scales.xAxes[0].scaleLabel.labelString=$scope.dashboardData.xAxeslabel,$scope.dashboardData.generatedGraph.graphOption.scales.yAxes[0].scaleLabel.labelString=$scope.dashboardData.yAxeslabel}},$scope.gerateResultgraph=function(){$("#GenerateGraph").modal({backdrop:"static",keyboard:!1})},$scope.setFilterDeptSelected=function(e){e.isSelected=!e.isSelected;for(var t=0;t<$scope.accessBranchList.length;t++)$scope.accessBranchList.isSelected||($scope.selectAllBranch=!1);1==$filter("filter")($scope.accessBranchList,{isSelected:!0},!0).length&&null!=(e=$filter("filter")($scope.accessBranchList,{isSelected:!0},!0))[0]&&null!=e[0].branchId&&($scope.getDepartmentList(e[0].branchId),$scope.getCategoryList(e[0].branchId));e=$filter("filter")($scope.accessBranchList,{isSelected:!0},!0).length;$scope.selectAllBranch=$scope.accessBranchList.length==e,$scope.selectAllBranch&&$scope.deptToggle()},$scope.selectFilterAllDepartment=function(){var e=!$scope.selectAllBranch;$scope.selectAllBranch=e;for(var t=0;t<$scope.accessBranchList.length;t++)$scope.accessBranchList[t].isSelected=$scope.selectAllBranch;1==$filter("filter")($scope.accessBranchList,{isSelected:!0},!0).length&&null!=(e=$filter("filter")($scope.accessBranchList,{isSelected:!0},!0))[0]&&null!=e[0].branchId&&($scope.getDepartmentList(e[0].branchId),$scope.getCategoryList(e[0].branchId)),$scope.selectAllBranch&&$scope.deptToggle()},$scope.statusToggle=function(){$(".statusWrapper .statusList").slideToggle("fast")},$scope.toggleStatusDiv=function(e){var t=$(".statusWrapper");t===e.target||t.has(e.target).length||$(".statusList").slideUp("fast")},$scope.setStatusSelected=function(e){e.isSelected=!e.isSelected;for(var t=0;t<$scope.suggDetailModel.statusList.length;t++)$scope.suggDetailModel.statusList.isSelected||($scope.selectAllStatus=!1);e=$filter("filter")($scope.suggDetailModel.statusList,{isSelected:!0},!0).length;$scope.selectAllStatus=$scope.suggDetailModel.statusList.length==e,$scope.selectAllStatus&&$scope.statusToggle()},$scope.selectFilterAllStatus=function(){var e=!$scope.selectAllStatus;$scope.selectAllStatus=e;for(var t=0;t<$scope.suggDetailModel.statusList.length;t++)$scope.suggDetailModel.statusList[t].isSelected=$scope.selectAllStatus;$scope.selectAllStatus&&$scope.statusToggle()},$scope.handleKeyPress=function(e){13===e.keyCode&&""!==$scope.suggDetailModel.searchBy.id&&2!==$scope.suggDetailModel.searchBy.id&&$scope.searchFilterData("")},$scope.emptySearchInput=function(){$scope.suggDetailModel.suggestionNumber=""},$scope.searchFilterData=function(e){$scope.suggDetailModel.searchModule=!0,""==e?$scope.suggDetailModel.suggestionNumber&&""!=$scope.suggDetailModel.suggestionNumber&&null!=$scope.suggDetailModel.suggestionNumber?($scope.suggDetailModel.searchById=!0,$scope.getStatusWiseCount(),0==$scope.statusCountFilter?$scope.getsuggestionList("allSuggestion"):$scope.getsuggestionList("onUpdate")):$scope.suggDetailModel.searchModule=!1:($scope.suggDetailModel.suggestionNumber="",$scope.suggDetailModel.searchById=!1,$scope.getStatusWiseCount(),0==$scope.statusCountFilter?$scope.getsuggestionList("allSuggestion"):$scope.getsuggestionList("onUpdate"))},$scope.searchFilterPopup=function(){$scope.suggDetailModel.suggestionNumber="",$scope.suggDetailModel.searchModule||($scope.suggDetailModel.searchModule=!1),(6==$scope.typeFilter||7==$scope.typeFilter?$("#searchLateralPopup"):$("#searchPopup")).modal({backdrop:"static",keyboard:!1})},$scope.isFilterApplied=!1,$scope.searchApplyFilter=function(){$scope.isFilterApplied=!0,$scope.suggDetailModel.searchModule=!0,"All"!=$scope.suggDetailModel.deptFilter.deptName?($scope.suggestionPagination.selectedDeptId=$scope.suggDetailModel.deptFilter.deptId,$scope.suggDetailModel.selectedDeptName=$scope.suggDetailModel.deptFilter.deptName):($scope.suggestionPagination.selectedDeptId=0,$scope.suggDetailModel.selectedDeptName=""),"All"!=$scope.suggDetailModel.catFilter.categoryName?($scope.suggestionPagination.selectedCatId=$scope.suggDetailModel.catFilter.catId,$scope.suggDetailModel.selectedCategoryName=$scope.suggDetailModel.catFilter.categoryName):($scope.suggestionPagination.selectedCatId=0,$scope.suggDetailModel.selectedCategoryName=""),$scope.getStatusWiseCount(),0==$scope.statusCountFilter?$scope.getsuggestionList("allSuggestion"):$scope.getsuggestionList("onUpdate"),$scope.flagfillterApply=!0,$scope.flagapplydata=!1,$("#searchPopup").modal("hide")},$scope.closedFilter=function(e){if($scope.suggestionPagination.current=1,$scope.resetSuggestionFilter(),6==$scope.typeFilter||7==$scope.typeFilter)$scope.suggestionPagination.fromDt="",$scope.suggestionPagination.toDt="",$scope.listFilter.branchId="",$scope.listFilter.deptId="",$scope.listFilter.catId="",$scope.listFilter.activityId="",$scope.listFilter.circleId="",$scope.listFilter.stageId="",$scope.listFilter.productId="",$scope.listFilter.productNoId="",$scope.listFilter.machineId="",$scope.listFilter.operationId="",$scope.listFilter.sourceId="",$scope.listFilter.sourceTypeId="",$scope.suggDetailModel.suggestionNumber="","clearFilter"==e&&($scope.getStatusWiseCount(),$scope.getsuggestionList()),$("#searchLateralPopup").modal("hide");else{if($scope.suggDetailModel.searchModule=!1,$scope.suggDetailModel.searchBy=$scope.searchList[1],$scope.suggDetailModel.selectedLevel=$scope.suggestionLevelList[0],$scope.suggDetailModel.searchById=!1,$scope.suggDetailModel.suggestionNumber="",$scope.suggestionPagination.selectedDeptId=0,$scope.suggDetailModel.catFilter="",$scope.suggDetailModel.deptFilter="",$scope.suggestionPagination.selectedCatId=0,$scope.suggDetailModel.selectedCategoryName="",$scope.suggestionPagination.selectedStatus=null,$scope.suggDetailModel.fromDt="",$scope.suggDetailModel.toDt="",$scope.suggDetailModel.suggPriorityFilter="",null!=$scope.pendingBranchlist)for(var t=0;t<$scope.pendingBranchlist.length;t++)$scope.pendingBranchlist[t].isSelected=!0;if(null!=$scope.mySuggBranchlist)for(t=0;t<$scope.mySuggBranchlist.length;t++)$scope.mySuggBranchlist[t].isSelected=!0;if(null!=$scope.onholdBranchlist)for(t=0;t<$scope.onholdBranchlist.length;t++)$scope.onholdBranchlist[t].isSelected=!0;if(null!=$scope.allBranchaccessList)for(t=0;t<$scope.allBranchaccessList.length;t++)$scope.allBranchaccessList[t].isSelected=!0;if(null!=$scope.suggDetailModel.statusList&&0<$scope.suggDetailModel.statusList.length){$scope.selectAllStatus=!1;for(let e=0;e<$scope.suggDetailModel.statusList.length;e++)$scope.suggDetailModel.statusList[e].isSelected=!1}"clearFilter"==e&&($scope.getStatusWiseCount(),0==$scope.statusCountFilter?$scope.getsuggestionList("allSuggestion"):$scope.getsuggestionList("onUpdate")),$scope.flagfillterApply=!1,$scope.flagapplydata=!0,$("#searchPopup").modal("hide")}},$scope.getMasterUnitsList=function(){var e={branchId:E.empDetails.branch.branchId};b.httpPost(e,"getMasterUnitList").then(function(e){e.result&&null!=e.unitList&&0<e.unitList.length?$scope.unitlistForparticular=e.unitList:$scope.unitlistForparticular=[]})},$scope.getMasterUnitsList(),$scope.getUnitDet=function(e){var t={};return t=null!=$scope.unitlistForparticular&&0<$scope.unitlistForparticular.length&&(e=parseInt(e),null!=(e=$filter("filter")($scope.unitlistForparticular,{id:e},!0)))&&0<e.length?e[0]:t},$scope.evalInputData={},$scope.evalInputModal=function(e,t,s){if($scope.evalInputData={},$scope.evalInputData={rec:t,stsAdt:s},"change_doc"==e)$scope.checkToDisplayPending(s)||$scope.getSuggestionDocList(),$("#changeDocumentModal").modal({backdrop:"static",keyboard:!1});else if("kaizenActivity"==e)$("#kaizenActivityModal").modal({backdrop:"static",keyboard:!1});else if("savingType"==e)$scope.suggestionDet.status_master.statusId==$scope.CONST.STATUS.EvaluationRequestAccepted.statusId&&s.status_master.statusId==$scope.CONST.STATUS.EvaluationRequestAccepted.statusId&&null!=$scope.savingTypes&&0<$scope.savingTypes.length&&($scope.evalSavingType={type:$scope.savingTypes[0],typeName:$scope.savingTypes[0].name.toLowerCase(),amt:"",points:0,role:""}),$("#savingTypeModal").modal({backdrop:"static",keyboard:!1});else if("OtherBenefit"==e){if("HD"==$scope.suggestionDet.sourceType){if($scope.isEmpty($scope.suggestionDet.hdCatId)||null==$scope.suggestionDet.hdCatId||null==$scope.suggestionDet.hdCatId||""==$scope.suggestionDet.hdCatId)return void C.create($filter("translate")("Please_select_category"),3e3,"error");if(0<$scope.suggestionDet.customEvaluationParticularsList.length&&null!=$scope.suggestionDet.customEvaluationParticularsList)for(let t=0;t<$scope.suggCatbranchwise.length;t++)for(let e=0;e<$scope.suggestionDet.customEvaluationParticularsList.length;e++)$scope.suggCatbranchwise[t].catId==$scope.suggestionDet.customEvaluationParticularsList[e].catId&&"Y"==$scope.suggestionDet.customEvaluationParticularsList[e].isActive&&($scope.suggestionDet.selectedCatName=$scope.suggCatbranchwise[t].categoryName,$scope.suggestionDet.selectedEvalCatId=$scope.suggCatbranchwise[t].catId);else $scope.suggestionDet.selectedCatName=$scope.isEmpty($scope.suggestionDet.hdCatId)?"":$scope.suggestionDet.hdCatId.categoryName,$scope.suggestionDet.selectedEvalCatId=$scope.suggestionDet.category.catId}else if(0<$scope.suggestionDet.customEvaluationParticularsList.length&&null!=$scope.suggestionDet.customEvaluationParticularsList)for(let t=0;t<$scope.suggCatbranchwise.length;t++)for(let e=0;e<$scope.suggestionDet.customEvaluationParticularsList.length;e++)$scope.suggCatbranchwise[t].catId==$scope.suggestionDet.customEvaluationParticularsList[e].catId&&"Y"==$scope.suggestionDet.customEvaluationParticularsList[e].isActive&&($scope.suggestionDet.selectedCatName=$scope.suggCatbranchwise[t].categoryName,$scope.suggestionDet.selectedEvalCatId=$scope.suggCatbranchwise[t].catId);else $scope.suggestionDet.selectedCatName=$scope.isEmpty($scope.suggestionDet.category)?"":$scope.suggestionDet.category.categoryName,$scope.suggestionDet.selectedEvalCatId=$scope.suggestionDet.category.catId;if($scope.checkToDisplayPending(s))$scope.suggestionDet.evalSustenanceflow=!0;else if(null!=$scope.particulars&&0<$scope.particulars.length){t=$filter("filter")($scope.particulars,{isChecked:!0},!0);if(null!=t&&0<t.length)if(0<$scope.suggestionDet.customEvaluationParticularsList.length&&null!=$scope.suggestionDet.customEvaluationParticularsList)for(let t=0;t<$scope.suggCatbranchwise.length;t++)for(let e=0;e<$scope.suggestionDet.customEvaluationParticularsList.length;e++)$scope.suggCatbranchwise[t].catId==$scope.suggestionDet.customEvaluationParticularsList[e].catId&&"Y"==$scope.suggestionDet.customEvaluationParticularsList[e].isActive&&($scope.suggestionDet.selectedCatName=$scope.suggCatbranchwise[t].categoryName,$scope.suggestionDet.selectedEvalCatId=$scope.suggCatbranchwise[t].catId);else $scope.suggestionDet.selectedCatName=t[0].category.categoryName,$scope.suggestionDet.selectedEvalCatId=$scope.suggestionDet.category.catId}null!=$scope.suggestionDet.sustenanceAuditorList&&0!=$scope.suggestionDet.sustenanceAuditorList.length||$scope.getSustenaceAuditor(),$("#otherBebefitModal").modal({backdrop:"static",keyboard:!1})}else if("HD"==e){if("HD"==$scope.suggestionDet.sourceType&&$scope.getSuggestionTypeDetail($scope.suggestionDet.suggestionHD.parentSuggId,$scope.suggestionDet.suggestionHD.branchId),"PILLER"==$scope.hdConfigData.hdLevel&&null!=$scope.circleList&&0<$scope.circleList.length){$scope.newCircleList=[];for(let e=0;e<$scope.circleList.length;e++)0!=$scope.circleList[e].id&&$scope.newCircleList.push($scope.circleList[e])}$("#horizontalModal").modal({backdrop:"static",keyboard:!1})}else"recommendation"==e&&$("#recommendationModal").modal({backdrop:"static",keyboard:!1})},$scope.analysisRecommendTabsFillStatus={changeDoc:!1,kaizenActivity:!1,otherBenefits:!1,horizontalDeployment:!1,recommendation:!1},$scope.checkAnalysisRecommendTabsFillStatus=function(e){if("change_doc"==e){$scope.analysisRecommendTabsFillStatus.changeDoc=!1;for(var t=0;t<$scope.documentLists.length;t++)if($scope.documentLists[t].isChecked){$scope.analysisRecommendTabsFillStatus.changeDoc=!0;break}$scope.suggestionDet.tmpIsDocumentChangeRequire&&($scope.analysisRecommendTabsFillStatus.changeDoc=!0)}else if("kaizen_activity"==e){$scope.analysisRecommendTabsFillStatus.kaizenActivity=!1;for(t=0;t<$scope.activityList.length;t++)if($scope.activityList[t].isselect){$scope.analysisRecommendTabsFillStatus.kaizenActivity=!0;break}}else if("other_benefits"==e){$scope.analysisRecommendTabsFillStatus.otherBenefits=!1;for(t=0;t<$scope.particulars.length;t++)if($scope.particulars[t].isChecked){$scope.analysisRecommendTabsFillStatus.otherBenefits=!0;break}}else if("horizontal_deployment"==e){$scope.analysisRecommendTabsFillStatus.horizontalDeployment=!1;for(t=0;t<$scope.departmentList.length;t++)if($scope.departmentList[t].isEvalselect){$scope.analysisRecommendTabsFillStatus.horizontalDeployment=!0;break}$scope.suggestionDet.isHDRequire&&($scope.analysisRecommendTabsFillStatus.horizontalDeployment=!0)}else"recommendation"==e&&($scope.analysisRecommendTabsFillStatus.recommendation=!1,$scope.suggestionDet.recommendationData.ideaAwardRecommEval||$scope.suggestionDet.recommendationData.implAwardRecommEval)&&($scope.analysisRecommendTabsFillStatus.recommendation=!0)},$scope.implInputData={},$scope.implInputModal=function(e,t){if($scope.implInputData={},$scope.implInputData={currentDiv:e,stsAdt:t},$scope.suggestionDet.sustenanceAuditorId&&($scope.implInputData.sustenanceAuditorId=$scope.suggestionDet.sustenanceAuditorId.toString()),"implemented"==e){if($scope.setImplTab(1),$scope.implFiles=[],$scope.resultImageFiles=[],"Y"==$scope.suggFlowConfig.isBenefitsEnbld?($scope.getBenefitAnalysisList($scope.suggestionDet.branch.branchId),$scope.setSubImplTab(1)):"Y"==$scope.suggFlowConfig.isImplParticularsEnbld?$scope.setSubImplTab(2):"Y"==$scope.suggFlowConfig.isImplHorizDplymntEnbld?$scope.setSubImplTab(3):"Y"==$scope.suggFlowConfig.isWhyWhyAnalysisEnbld?$scope.setSubImplTab(4):"Y"==$scope.suggFlowConfig.isKaizenSustainanceEnbld?$scope.setSubImplTab(5):$scope.setSubImplTab(6),"HD"==$scope.suggestionDet.sourceType&&$scope.getSuggestionTypeDetail($scope.suggestionDet.suggestionHD.parentSuggId,$scope.suggestionDet.suggestionHD.branchId),"PILLER"==$scope.hdConfigData.hdLevel&&null!=$scope.circleList&&0<$scope.circleList.length){$scope.newCircleList=[];for(let e=0;e<$scope.circleList.length;e++)0!=$scope.circleList[e].id&&$scope.newCircleList.push($scope.circleList[e])}if("Y"==$scope.suggFlowConfig.isImplParticularsEnbld)if(0<$scope.suggestionDet.customEvaluationParticularsList.length&&null!=$scope.suggestionDet.customEvaluationParticularsList)for(let t=0;t<$scope.suggCatbranchwise.length;t++)for(let e=0;e<$scope.suggestionDet.customEvaluationParticularsList.length;e++)$scope.suggCatbranchwise[t].catId==$scope.suggestionDet.customEvaluationParticularsList[e].catId&&"Y"==$scope.suggestionDet.customEvaluationParticularsList[e].isActive&&($scope.suggestionDet.selectedCatName=$scope.suggCatbranchwise[t].categoryName,$scope.suggestionDet.selectedEvalCatId=$scope.suggCatbranchwise[t].catId);else $scope.suggestionDet.selectedCatName=$scope.suggestionDet.category.categoryName,$scope.suggestionDet.selectedEvalCatId=$scope.suggestionDet.category.catId;null!=$scope.suggestionDet.sustenanceAuditorList&&0!=$scope.suggestionDet.sustenanceAuditorList.length||$scope.getSustenaceAuditor(),null!=$scope.employeeList&&0<$filter("filter")($scope.employeeList,{branch:{branchId:$scope.suggestionDet.branch.branchId}},!0).length||$scope.getEmployeeList($scope.suggestionDet.branch.branchId);t=$scope.employeeList.find(e=>e.empId===f.empId);if(null!=t||t)t.isSelected=!0,$scope.selectedEmpList.some(e=>e.empId===f.empId)||(f.isSelected=!0,$scope.selectedEmpList.push(f));else{$scope.employeeList.push(f);for(let e=0;e<$scope.employeeList.length;e++)$scope.employeeList[e].empId==f.empId&&(selectedEmp.isSelected=!0,$scope.selectedEmpList.push(f))}$("#implementedModal").modal({backdrop:"static",keyboard:!1})}else"onHold"==e?($scope.setImplTab(2),$("#onHoldModal").modal({backdrop:"static",keyboard:!1})):"rejected"==e&&($scope.setImplTab(3),$("#implRejectedModal").modal({backdrop:"static",keyboard:!1}))},$scope.toggleParticular=function(){$(".wrapperForPart .listForPart").slideToggle("fast")},$scope.toggleParticularDiv=function(e){var t=$(".wrapperForPart");t===e.target||t.has(e.target).length||$(".listForPart").slideUp("fast")},$scope.isAccessImplTab=function(e){var t=!1;return t=1==e&&"Y"==$scope.suggFlowConfig.isBenefitsEnbld||2==e&&"Y"==$scope.suggFlowConfig.isImplParticularsEnbld||3==e&&"Y"==$scope.suggFlowConfig.isImplHorizDplymntEnbld||4==e&&"Y"==$scope.suggFlowConfig.isWhyWhyAnalysisEnbld||5==e&&"Y"==$scope.suggFlowConfig.isKaizenSustainanceEnbld||6==e||7==e&&"Y"==$scope.suggFlowConfig.isFinVerifEnbld||8==e?!0:t},$scope.nextPreviousAction=function(e,t){if("next"==e){for(let e=t+1;e<=8;e++)if($scope.isAccessImplTab(e)){$scope.setSubImplTab(e);break}}else for(let e=t-=1;1<=e;e--)if($scope.isAccessImplTab(e)){$scope.setSubImplTab(e);break}},$scope.tabContentChecked={benefits:!1,markBenefitsAsClicked:!1,otherBenefits:!1,markOtherBenefitsAsClicked:!1,hzDeployment:!1,markHzDeployementClicked:!1,whyAnalysis:!1,kaizenSustain:!1,results:!1,financeVerification:!1,teamMembers:!1,markTeamMemberAsClicked:!1},$scope.setTabContentChecked=function(e){var t,s;"benefits"==e?$scope.tabContentChecked.markBenefitsAsClicked&&($scope.tabContentChecked.benefits=!1,$scope.benefitList.forEach(e=>{e.isBenefitChecked&&($scope.tabContentChecked.benefits=!0)})):"otherBenefits"==e?$scope.tabContentChecked.markOtherBenefitsAsClicked&&($scope.tabContentChecked.otherBenefits=!1,$scope.particulars.forEach(e=>{e.isChecked&&($scope.tabContentChecked.otherBenefits=!0)})):"hzDeployment"==e?$scope.tabContentChecked.markHzDeployementClicked&&(t=$scope.tabContentChecked.hzDeployment=!1,s=!1,$scope.departmentList.forEach(e=>{e.isImplselect&&e.lineList.forEach(e=>{e.isImplselect&&(t=!0)})}),$scope.hDBranchList.forEach(e=>{e.name!=$scope.suggestionDet.branch.name&&e.isEvalPlantselect&&(s=!0)}),t||s)&&($scope.tabContentChecked.hzDeployment=!0):"whyAnalysis"==e?($scope.tabContentChecked.whyAnalysis=!1,$scope.whyWhyAnalysisforImpl.forEach(e=>{null!=e.whyWhyAnalysis&&""!=e.whyWhyAnalysis&&($scope.tabContentChecked.whyAnalysis=!0)}),null!=$scope.suggestionDet.rootCause&&""!=$scope.suggestionDet.rootCause&&($scope.tabContentChecked.whyAnalysis=!0),null!=$scope.suggestionDet.counterMeasures&&""!=$scope.suggestionDet.counterMeasures&&($scope.tabContentChecked.whyAnalysis=!0),null!=$scope.suggestionDet.kaizenIdea&&""!=$scope.suggestionDet.kaizenIdea&&($scope.tabContentChecked.whyAnalysis=!0),null!=$scope.suggestionDet.benefits&&""!=$scope.suggestionDet.benefits&&($scope.tabContentChecked.whyAnalysis=!0)):"kaizenSustain"==e?($scope.tabContentChecked.kaizenSustain=!1,null!=$scope.suggestionDet.whatToDo&&""!=$scope.suggestionDet.whatToDo&&($scope.tabContentChecked.kaizenSustain=!0),null!=$scope.suggestionDet.howToDo&&""!=$scope.suggestionDet.howToDo&&($scope.tabContentChecked.kaizenSustain=!0),null!=$scope.suggestionDet.frquency&&""!=$scope.suggestionDet.frquency&&($scope.tabContentChecked.kaizenSustain=!0)):"results"==e?($scope.tabContentChecked.results=!1,null!=$scope.implData.implSummary&&""!=$scope.implData.implSummary&&($scope.tabContentChecked.results=!0),null!=$scope.implFiles&&0<$scope.implFiles.length&&($scope.tabContentChecked.results=!0),null!=$scope.implData.implactionSummary&&""!=$scope.implData.implactionSummary&&($scope.tabContentChecked.results=!0),$scope.checkForHdConfig()&&null!=$scope.resultImageFiles&&0<$scope.resultImageFiles.length&&($scope.tabContentChecked.results=!0),"Y"==$scope.suggFlowConfig.isSafetyEnbld&&$scope.suggestionDet.ehsbenefit&&$scope.implData.safetImplactionSummary&&""!=$scope.implData.safetImplactionSummary&&($scope.tabContentChecked.results=!0),"Y"==$scope.suggFlowConfig.isPCNNoEnbld&&$scope.suggestionDet.pcnNumber&&""!=$scope.suggestionDet.pcnNumber&&($scope.tabContentChecked.results=!0),$scope.checkForHdConfig()||null!=$scope.suggestionDet.results&&""!=$scope.suggestionDet.results&&($scope.tabContentChecked.results=!0)):"financeVerification"==e?($scope.tabContentChecked.financeVerification=!1,$scope.suggestionDet.implfinanceflow&&null!=$scope.suggestionDet.implfc&&null!=$scope.suggestionDet.implfc&&($scope.tabContentChecked.financeVerification=!0),null!=$scope.implData.implementedCost&&""!=$scope.implData.implementedCost&&0<$scope.implData.implementedCost&&($scope.tabContentChecked.financeVerification=!0),null!=$scope.implData.costEffective&&""!=$scope.implData.costEffective&&0<$scope.implData.costEffective&&($scope.tabContentChecked.financeVerification=!0)):"teamMembers"==e&&$scope.tabContentChecked.markTeamMemberAsClicked&&($scope.tabContentChecked.teamMembers=!1,null!=$scope.employeeList)&&0<$scope.employeeList.length&&$scope.employeeList.forEach(e=>{e.isSelected&&($scope.tabContentChecked.teamMembers=!0)})},$scope.schemePolicy={flag:!1},$scope.isSuggSchemePolicy=function(){$scope.schemePolicy.flag=!1;var e={orgId:E.empDetails.organization.orgId};b.httpPost(e,"getSuggestionPolicyDoc").then(function(e){!e.result||$scope.isEmpty(e.suggestionFlowConfig)?$scope.schemePolicy.flag=!1:($scope.schemePolicy.docUrl=e.suggestionFlowConfig.suggPolicyDocUrl,$scope.schemePolicy.flag=!0)}).catch(function(e){$scope.schemePolicy.flag=!1})},$scope.downloadFile=function(e){window.open(e,"_blank")},$scope.isSuggSchemePolicy(),$scope.showSustainceModal=function(){$("#sustainceInputModal").modal({backdrop:"static",keyboard:!1})},$scope.viewKaizenModal=function(){$scope.underFinanceApprovalList=[];for(var e=0;e<$scope.suggestionDet.sugesstionStatusAudit.length;e++)$scope.suggestionDet.sugesstionStatusAudit[e].status_master.status==$scope.CONST.STATUS.UnderFinanceVerification.status&&$scope.underFinanceApprovalList.push($scope.suggestionDet.sugesstionStatusAudit[e]);$("#kaizenExportModal").modal({backdrop:"static",keyboard:!1})},[{"next .tabSuggestions-Suggestions":$scope.CONST_HELP_STMT.HOME_SCREEN.Suggestion_Tab,nextButton:{className:"myNext",text:"Next"},skipButton:{className:"mySkip",text:"Skip"}},{"next .my-Pending":$scope.CONST_HELP_STMT.HOME_SCREEN.My_Pending_Action_Tab,nextButton:{className:"myNext",text:"Next"}},{"next .my-Suggestions":$scope.CONST_HELP_STMT.HOME_SCREEN.My_Suggestions_Tab,nextButton:{className:"myNext",text:"Next"}},{"next .all-Suggestions":$scope.CONST_HELP_STMT.HOME_SCREEN.All_Suggestions,nextButton:{className:"myNext",text:"Next"}},{"next .Clear-Filter-Search-Button":$scope.CONST_HELP_STMT.HOME_SCREEN.Clear_Filter_Search_Button,nextButton:{className:"myNext",text:"Next"}},{"next .Export-Excel":$scope.CONST_HELP_STMT.HOME_SCREEN.Export_Excel,nextButton:{className:"myNext",text:"Next"}},{"next .Add-On-Search":$scope.CONST_HELP_STMT.HOME_SCREEN.Add_On_Search,nextButton:{className:"myNext",text:"Next"}},{"next .Search-Field":$scope.CONST_HELP_STMT.HOME_SCREEN.Search_Field,nextButton:{className:"myNext",text:"Next"}},{"next .Home-Points":$scope.CONST_HELP_STMT.HOME_SCREEN.Points,nextButton:{className:"myNext",text:"Next"}},{"click .Create-Button":$scope.CONST_HELP_STMT.HOME_SCREEN.Create_Sugg_Button,shape:"circle",radius:30,showSkip:!1,nextButton:{className:"mySkip",text:"Got it!!"}}]),y=($scope.homeScreenHelp={},$scope.homeScreenHelp.flagHomehelp=!1,$scope.starthomeScreenHelp=function(){$scope.homeScreenHelp.flagHomehelp=!0;var e=new EnjoyHint({});e.set(I),e.run()},[{"next .On_Behalf_Suggestion":$scope.CONST_HELP_STMT.CREATE_SUGGESTION.On_Behalf_Suggestion,nextButton:{className:"myNext",text:"Next"}},{"next .Self_Implement":$scope.CONST_HELP_STMT.CREATE_SUGGESTION.Self_Implement,showSkip:!1,nextButton:{className:"mySkip",text:"Got It!!"}}]),S=($scope.startCreateSuggHelp=function(){$scope.scrollToBottom("#createSuggScroll"),setTimeout(function(){$scope.homeScreenHelp.flagCreateSugg=!0;var e=new EnjoyHint({});e.set(y),e.run()},1e3)},[{"next .Accept_Assign":$scope.CONST_HELP_STMT.CONTROLLER_SCREEN.Accept_Assign,nextButton:{className:"myNext",text:"Next"}},{"next .Reject_Button":$scope.CONST_HELP_STMT.CONTROLLER_SCREEN.Reject_Button,nextButton:{className:"myNext",text:"Next"}},{"next .Reassign_to_Initiator":$scope.CONST_HELP_STMT.CONTROLLER_SCREEN.Reassign_to_Initiator,nextButton:{className:"myNext",text:"Next"}},{"next .Pass_to_Peer":$scope.CONST_HELP_STMT.CONTROLLER_SCREEN.Pass_to_Peer,nextButton:{className:"myNext",text:"Next"}},{"next .Check_Duplication":$scope.CONST_HELP_STMT.CONTROLLER_SCREEN.Check_Duplication,nextButton:{className:"mySkip",text:"Got It!!"}}]),L=($scope.homeScreenHelp.flagCtrlhelp=!1,$scope.startControllerHelp=function(){$scope.homeScreenHelp.flagCtrlhelp=!0;var e=new EnjoyHint({});e.set(S),e.run()},[{"next .Change_Document":$scope.CONST_HELP_STMT.EVALUATOR_SCREEN.Change_Document,nextButton:{className:"myNext",text:"Next"}},{"next .Kaizen_Activity":$scope.CONST_HELP_STMT.EVALUATOR_SCREEN.Kaizen_Activity,nextButton:{className:"myNext",text:"Next"}},{"next .Saving_Type":$scope.CONST_HELP_STMT.EVALUATOR_SCREEN.Saving_Type,nextButton:{className:"myNext",text:"Next"}},{"next .Particulars":$scope.CONST_HELP_STMT.EVALUATOR_SCREEN.Particulars,nextButton:{className:"myNext",text:"Next"}},{"next .Horizontal_Deployment":$scope.CONST_HELP_STMT.EVALUATOR_SCREEN.Horizontal_Deployment,nextButton:{className:"myNext",text:"Next"}},{"next .Analysis_Summary":$scope.CONST_HELP_STMT.EVALUATOR_SCREEN.Analysis_Summary,nextButton:{className:"myNext",text:"Next"}},{"next .Override_Initiator_Category":$scope.CONST_HELP_STMT.EVALUATOR_SCREEN.Override_Initiator_Category,nextButton:{className:"myNext",text:"Next"}},{"next .Budgetary_Cost":$scope.CONST_HELP_STMT.EVALUATOR_SCREEN.Budgetary_Cost,nextButton:{className:"myNext",text:"Next"}},{"next .SAP_Code":$scope.CONST_HELP_STMT.EVALUATOR_SCREEN.SAP_Code,nextButton:{className:"myNext",text:"Next"}},{"next .Assign_For_Implementation_Button":$scope.CONST_HELP_STMT.EVALUATOR_SCREEN.Assign_For_Implementation_Button,nextButton:{className:"myNext",text:"Next"}},{"next .Eval_Reject_Button":$scope.CONST_HELP_STMT.EVALUATOR_SCREEN.Eval_Reject_Button,nextButton:{className:"myNext",text:"Next"}}]),v=($scope.starEvaluatorHelp=function(){var e=new EnjoyHint({});e.set(L),e.run()},[{"next .implemented_tab":$scope.CONST_HELP_STMT.IMPLEMENTER_SCREEN.Implemented_Tab,nextButton:{className:"myNext",text:"Next"}},{"next .on_hold_tab":$scope.CONST_HELP_STMT.IMPLEMENTER_SCREEN.On_Hold_Tab,nextButton:{className:"myNext",text:"Next"}},{"next .reject_tab":$scope.CONST_HELP_STMT.IMPLEMENTER_SCREEN.Reject_Tab,nextButton:{className:"myNext",text:"Next"}},{"next .approximate_implementation_cost":$scope.CONST_HELP_STMT.IMPLEMENTER_SCREEN.Approximate_Implementation_Cost,nextButton:{className:"myNext",text:"Next"}},{"next .annual_savings":$scope.CONST_HELP_STMT.IMPLEMENTER_SCREEN.Annual_Savings,nextButton:{className:"myNext",text:"Next"}}]),T=($scope.starImplementerHelp=function(){var e=new EnjoyHint({});e.set(v),e.run()},$scope.monthDiff=function(e,t){var s=12*(t.getFullYear()-e.getFullYear());return(s=(s-=e.getMonth())+t.getMonth())<=0?0:s},$scope.resetSustenanceFlag=function(){$scope.suggestionDet.sustenanceAuditData.setNextDate=!1,$scope.suggestionInputDetails.nextSustenaceAuditDate="",$scope.suggestionInputDetails.flagCloseKaizen=!0,$scope.suggestionInputDetails.flagsustanceKaizen=!1},$scope.sustainanceCloseOrNot=function(){var e,t=!1,s=new Date;return $scope.isEmpty(E.empDetails)||null==E.empDetails||null==E.empDetails||null==(e=E.empDetails.organization.alies)||angular.isUndefined(e)||"rpl"!=e||!$scope.isEmpty($scope.suggestionDet)&&null!=$scope.suggestionDet.sugesstionStatusAudit&&0<$filter("filter")($scope.suggestionDet.sugesstionStatusAudit,{status_master:{status:$scope.CONST.STATUS.Implemented.status}},!0).length&&(e=$filter("filter")($scope.suggestionDet.sugesstionStatusAudit,{status_master:{status:$scope.CONST.STATUS.Implemented.status}},!0),e=new Date(e[0].createdDate),$scope.monthDiff(e,s)<6)&&(t=!0),t},$scope.setJuryTab=function(e){$scope.juryTab=e,$scope.nominationId=$scope.suggestionPagination.selectedMonth.id,$scope.getStatusWiseCount(),$scope.getsuggestionList(),$scope.getJuryTopKiazenList(),$scope.getJueryStatusList(),$scope.getJuryList()},$scope.isSetJuryTab=function(e){return $scope.juryTab===e},$scope.getNominationDateListData=function(){$scope.data={branchId:$scope.loggedInUserBranchId,type:$scope.isSelectJuryTab},"NOMINATION"==$scope.isSelectJuryTab&&($scope.data.type=$scope.isSelectJuryTab),b.httpPost($scope.data,"getNominationDateList").then(function(e){if(1==e.result)if(null!=e.evalMstrNominationList&&0<e.evalMstrNominationList.length){$scope.NominationDateList=e.evalMstrNominationList;for(let e=0;e<$scope.NominationDateList.length;e++)$scope.NominationDateList[e].monthYearNew=$scope.arrMonths[$scope.NominationDateList[e].month-1]+" "+$scope.NominationDateList[e].year;$scope.suggestionPagination.selectedMonth=$scope.NominationDateList[0],$scope.nominationId=$scope.NominationDateList[0].id}else $scope.NominationDateList=[];else $scope.NominationDateList=[]})},$scope.getNominationDateListData(),$scope.juryInputSave=function(t,e,s){if($scope.parameterListNew=t.parameterList,$scope.juryDatanew=t,$scope.sugAssignedToJury=[],"PRODUCTION_HEAD"==$scope.juryDatanew.inputType&&"UPDATE"==e)for(var i=0;i<t.ratingList.length;i++)1==t.ratingList[i].isSelected&&$scope.sugAssignedToJury.push({sugAssignedToJury:{id:t.jAssinedToId},phRatingId:t.ratingList[i].id,phRating:t.ratingList[i].scale,isPlantHead:1});else if("JURY"==$scope.juryDatanew.inputType&&"UPDATE"==e){for(var a=0,n=0;n<$scope.parameterListNew.length;n++)for(var l=0;l<$scope.juryDatanew.suggestionEvalJuryInput.length;l++)if($scope.parameterListNew[n].id==$scope.juryDatanew.suggestionEvalJuryInput[l].parameterId)for(i=0;i<$scope.parameterListNew[n].ratingList.length;i++)1==$scope.parameterListNew[n].ratingList[i].isSelected&&(a+=$scope.parameterListNew[n].ratingList[i].scale,$scope.sugAssignedToJury.push({id:$scope.juryDatanew.suggestionEvalJuryInput[l].id,sugAssignedToJury:{id:$scope.juryDatanew.jAssinedToId},parameterId:$scope.parameterListNew[n].id,ratingId:$scope.parameterListNew[n].ratingList[i].id,juryRating:$scope.parameterListNew[n].ratingList[i].scale,totalRating:0,browniePoints:s.points}));for(var o=0;o<$scope.sugAssignedToJury.length;o++)$scope.sugAssignedToJury[o].totalRating=a}else if("PRODUCTION_HEAD"==$scope.juryDatanew.inputType&&"ADD"==e)for(i=0;i<t.ratingList.length;i++)1==t.ratingList[i].isSelected&&$scope.sugAssignedToJury.push({sugAssignedToJury:{id:t.jAssinedToId},phRatingId:t.ratingList[i].id,phRating:t.ratingList[i].scale,isPlantHead:1});else if("JURY"==$scope.juryDatanew.inputType&&"ADD"==e){for(a=0,n=0;n<$scope.parameterListNew.length;n++)for(i=0;i<$scope.parameterListNew[n].ratingList.length;i++)1==$scope.parameterListNew[n].ratingList[i].isSelected&&(a+=$scope.parameterListNew[n].ratingList[i].scale,$scope.sugAssignedToJury.push({sugAssignedToJury:{id:$scope.juryDatanew.jAssinedToId},parameterId:$scope.parameterListNew[n].id,ratingId:$scope.parameterListNew[n].ratingList[i].id,juryRating:$scope.parameterListNew[n].ratingList[i].scale,browniePoints:s.points}));if($scope.sugAssignedToJury.length<6)return void C.create("Please submit all inputs.",5e3,"error");for(o=0;o<$scope.sugAssignedToJury.length;o++)$scope.sugAssignedToJury[o].totalRating=a}b.httpPost($scope.sugAssignedToJury,"submitSuggestionJuryInputs").then(function(e){1==e.result?("COMPLETED"==t.jStatus?(C.create("Jury ratings modified successfully.",4e3,"success"),$scope.getStatusWiseCount(),$scope.getsuggestionList(),$scope.getJuryTopKiazenList(),$scope.getJueryStatusList()):(C.create("Jury rating submitted successfully.",4e3,"success"),$scope.getsuggestionList()),t.isupdate=!1):C.create("Oops!! Please try again.",3e3,"error")})},$scope.cardSelected=function(e){for(var t=0;t<$scope.juryData.length;t++)$scope.juryData[t].isSelectedCard=!1,$scope.juryData[t].suggestionNumber==e?$scope.juryData[t].isSelectedCard=!0:$scope.juryData[t].isSelectedCard=!1},$scope.modifySuggFrom={},$scope.updateSuggestionData=function(){$("#editModal").modal({backdrop:"static",keyboard:!1}),$scope.suggDataForModify=angular.copy($scope.suggestionDet)},$scope.updateNewData=function(e){$scope.flagModifySuggSpinner=!0,e.$invalid?angular.forEach(e.$error.required,function(e){e.$setDirty(),$scope.flagModifySuggSpinner=!1}):($scope.data={sugg_id:$scope.suggDataForModify.sugId},$scope.suggestionDet.problemAnalysis!=$scope.suggDataForModify.problemAnalysis&&($scope.data.problemAnalysis=$scope.suggDataForModify.problemAnalysis),$scope.suggestionDet.problemAnalysis!=$scope.suggDataForModify.sugession&&($scope.data.suggestion=$scope.suggDataForModify.sugession),$scope.suggestionDet.problemAnalysis!=$scope.suggDataForModify.suggestionTitle&&($scope.data.suggestionTitle=$scope.suggDataForModify.suggestionTitle),b.httpPost($scope.data,"modifySugesstionDetails").then(function(e){$scope.flagModifySuggSpinner=!1,e.result?($("#editModal").modal("hide"),C.create($filter("translate")("Suggestion_Updated_Successfully"),5e3,"success"),$scope.getSuggestionListOnUpdate()):($scope.flagModifySuggSpinner=!1,100==e.statusCode?C.create(e.reason,5e3,"success"):C.create($filter("translate")("Error_occured_Please_try_again"),5e3,"success"))}))},$scope.dateRangePickerOptions={singleDatePicker:!0,drops:"up",maxDate:moment()},$scope.isSelectJuryTab=E.checkSubMenuAccess("Suggestions","Suggestions-Nomination")?"NOMINATION":"ASSESSMENT",$scope.selectJuryTab=function(e){$scope.isSelectJuryTab=e,"NOMINATION"==$scope.isSelectJuryTab?$scope.getDeptList():$scope.setJuryTab()},$scope.setNomination=function(){$scope.data={orgId:$scope.loggedInUserOrgId,branchId:$scope.loggedInUserBranchId,year:$scope.suggestionPagination.selectedMonth.year,month:$scope.suggestionPagination.selectedMonth.month},null!=$scope.selectDeptIdsList&&0<$scope.selectDeptIdsList.length&&($scope.data.deptIds=$scope.selectDeptIdsList),$scope.flagJuryDetIndicator=!0,b.httpPost($scope.data,"getSuggestionNominationList").then(function(e){if($scope.flagJuryDetIndicator=!1,e.result)if($scope.nominationList=e.list,null!=e.list&&0<e.list.length){$scope.nominationList=e.list;for(var t=0;t<$scope.nominationList.length;t++)$scope.nominationList[t].implementedDate=$scope.nominationList[t].implementedDate?$filter("date")(new Date($scope.nominationList[t].implementedDate),"MMM d, y"):""}else $scope.nominationList=[];else $scope.nominationList=[],100==e.statusCode?C.create(e.reason,5e3,"error"):500==e.statusCode&&C.create($filter("translate")("Error_occured_Please_try_again"),5e3,"error")})},$scope.flagBeforeSuggSelection=!1,$scope.selectAllSuggestion=function(){var e=!$scope.selectAllSugg;$scope.selectAllSugg=e,$scope.flagBeforeSuggSelection=$scope.selectAllSugg;for(var t=0;t<$scope.nominationList.length;t++)$scope.nominationList[t].selectedSugg=$scope.selectAllSugg},$scope.setSuggSelected=function(e){$scope.flagBeforeSuggSelection=!1,e.selectedSugg=!e.selectedSugg;for(var t=0;t<$scope.nominationList.length;t++)$scope.nominationList[t].selectedSugg&&($scope.flagBeforeSuggSelection=!0);$filter("filter")($scope.nominationList,{selectedSugg:!0},!0).length==$scope.nominationList.length?$scope.selectAllSugg=!0:$scope.selectAllSugg=!1},$scope.assignForAssessment=function(){$scope.selectSuggId=[];for(var e=0;e<$scope.nominationList.length;e++)$scope.nominationList[e].selectedSugg&&$scope.selectSuggId.push($scope.nominationList[e].sugId);null==$scope.selectSuggId.length||null==$scope.selectSuggId.length||0==$scope.selectSuggId.length?C.create($filter("translate")("Please select kaizen for nomination"),3e3,"error"):($scope.data={orgId:$scope.loggedInUserOrgId,suggIds:$scope.selectSuggId,branchId:$scope.loggedInUserBranchId,nominationBy:$scope.loggedInEmpId,nominationId:$scope.suggestionPagination.selectedMonth.id},b.httpPost($scope.data,"nominationSuggestion").then(function(e){e.result?(C.create($filter("translate")("Kaizen successfully nominated for assessment"),4e3,"success"),$scope.getDeptList()):C.create($filter("translate")("Oop's please try again"),3e3,"error")}))},$scope.openJuryDetailModal=function(){$("#juryDetails").modal("show")},$scope.statusListConfig={scrollButtons:{scrollAmount:"170px",enable:!0},scrollInertia:0,axis:"x",autoHideScrollbar:!1,advanced:{updateOnContentResize:!0}},$scope.isImplVerification=!1,$scope.getRoleAccessList=function(){b.httpGet("getlistofroleaccessnew/"+E.empDetails.organization.orgId+"/"+E.empDetails.branch.branchId+"/9/"+E.empDetails.productOrgConfigDet.product.id).then(function(e){$scope.menuList=e.menuDataList;for(var t=0;t<$scope.menuList.length;t++)if("Settings"==$scope.menuList[t].menuName)for(var s=0;s<$scope.menuList[t].subMenuList.length;s++)"Implementation Verification"==$scope.menuList[t].subMenuList[s].subMenuName?$scope.isImplVerification=!0:$scope.isImplVerification=!1})},$scope.getRoleAccessList(),$scope.checkPriority=function(){$scope.suggestionDet&&$scope.suggestionDet.suggPriority&&("H"==$scope.suggestionDet.suggPriority?$scope.suggestionDet.suggPriority={id:"H",name:"High"}:"M"==$scope.suggestionDet.suggPriority?$scope.suggestionDet.suggPriority={id:"M",name:"Medium"}:"L"==$scope.suggestionDet.suggPriority&&($scope.suggestionDet.suggPriority={id:"L",name:"Medium"}))},$scope.flagCheckRejStatus=!1,$scope.flagCheckCommentStatus=!1,$scope.checkRejStatus=function(e){"YES"==e&&($scope.flagCheckRejStatus=!0,$scope.flagCheckCommentStatus=!1,$scope.suggestionDet.futuristicSummary=""),"NO"==e&&($scope.flagCheckCommentStatus=!0,$scope.flagCheckRejStatus=!1,$scope.suggestionDet.rejectionReason=""),$scope.suggestionDet.actionStatus=e},$scope.futuristicCommitteeSubmission=function(){var e=E.empDetails.organization.alies;$scope.futuristicMsg="",void 0!==$scope.suggestionDet.futuristicSummary&&""!==$scope.suggestionDet.futuristicSummary||null!=$scope.suggestionDet.rejectionReason&&""!=$scope.suggestionDet.rejectionReason?("YES"==$scope.suggestionDet.actionStatus&&($scope.futuristicMsg="gmr"==e?"Idea rejected by futuristic commitee successfully.":"Suggestion rejected by futuristic commitee successfully."),"NO"==$scope.suggestionDet.actionStatus&&($scope.futuristicMsg="gmr"==e?"Idea assigned to evaluator successfully.":"Suggestion assigned to evaluator successfully."),$scope.data={sugId:$scope.selectedSuggId,sugTrackId:$scope.suggestionDet.evaluationTeamList[0].sugTrackId,assigned_by:parseInt($scope.loggedInEmpId),updatedBy:parseInt($scope.loggedInEmpId),createdBy:parseInt($scope.loggedInEmpId),actionStatus:$scope.suggestionDet.actionStatus,statusId:$scope.CONST.STATUS.AssignToFuturisticCommittee.statusId},"YES"==$scope.suggestionDet.actionStatus&&($scope.data.comment=$scope.suggestionDet.rejectionReason),"NO"==$scope.suggestionDet.actionStatus&&($scope.data.comment=$scope.suggestionDet.futuristicSummary),b.httpPost($scope.data,"futuristicCommitteeSubmission").then(function(e){1==e.result?(C.create($filter("translate")($scope.futuristicMsg),4e3,"success"),$scope.getsuggestionList("onLoad"),$scope.getStatusWiseCount()):C.create($filter("translate")("Error_occured_Please_try_again"),5e3,"error")})):C.create($filter("translate")("Please_enter_comment"),5e3,"error")},$scope.verifyImplDetails=function(e,t){if($scope.implInputData={},$scope.implInputData={currentDiv:e,stsAdt:t},$scope.suggestionDet.sustenanceAuditorId&&($scope.implInputData.sustenanceAuditorId=$scope.suggestionDet.sustenanceAuditorId.toString()),$scope.isDepartmentSelected(),"implemented"==e){if($scope.setImplTab(1),"Y"==$scope.suggFlowConfig.isBenefitsEnbld?($scope.getBenefitAnalysisList($scope.suggestionDet.branch.branchId),$scope.setSubImplTab(1)):"Y"==$scope.suggFlowConfig.isImplParticularsEnbld?$scope.setSubImplTab(2):"Y"==$scope.suggFlowConfig.isImplHorizDplymntEnbld?$scope.setSubImplTab(3):"Y"==$scope.suggFlowConfig.isWhyWhyAnalysisEnbld?$scope.setSubImplTab(4):"Y"==$scope.suggFlowConfig.isKaizenSustainanceEnbld?$scope.setSubImplTab(5):$scope.setSubImplTab(6),"HD"==$scope.suggestionDet.sourceType&&$scope.getSuggestionTypeDetail($scope.suggestionDet.suggestionHD.parentSuggId,$scope.suggestionDet.suggestionHD.branchId),"PILLER"==$scope.hdConfigData.hdLevel&&null!=$scope.circleList&&0<$scope.circleList.length){$scope.newCircleList=[];for(let e=0;e<$scope.circleList.length;e++)0!=$scope.circleList[e].id&&$scope.newCircleList.push($scope.circleList[e])}if("Y"==$scope.suggFlowConfig.isImplParticularsEnbld)if(0<$scope.suggestionDet.customEvaluationParticularsList.length&&null!=$scope.suggestionDet.customEvaluationParticularsList)for(let t=0;t<$scope.suggCatbranchwise.length;t++)for(let e=0;e<$scope.suggestionDet.customEvaluationParticularsList.length;e++)$scope.suggCatbranchwise[t].catId==$scope.suggestionDet.customEvaluationParticularsList[e].catId&&"Y"==$scope.suggestionDet.customEvaluationParticularsList[e].isActive&&($scope.suggestionDet.selectedCatName=$scope.suggCatbranchwise[t].categoryName,$scope.suggestionDet.selectedEvalCatId=$scope.suggCatbranchwise[t].catId);else $scope.suggestionDet.selectedCatName=$scope.suggestionDet.category.categoryName,$scope.suggestionDet.selectedEvalCatId=$scope.suggestionDet.category.catId;null!=$scope.suggestionDet.sustenanceAuditorList&&0!=$scope.suggestionDet.sustenanceAuditorList.length||$scope.getSustenaceAuditor(),null!=$scope.employeeList&&0<$filter("filter")($scope.employeeList,{branch:{branchId:$scope.suggestionDet.branch.branchId}},!0).length||$scope.getEmployeeList($scope.suggestionDet.branch.branchId),$("#viewImplementedModal").modal({backdrop:"static",keyboard:!1})}},$scope.verifyImplDetails=function(e,t){if($scope.implInputData={},$scope.implInputData={currentDiv:e,stsAdt:t},$scope.suggestionDet.sustenanceAuditorId&&($scope.implInputData.sustenanceAuditorId=$scope.suggestionDet.sustenanceAuditorId.toString()),$scope.isDepartmentSelected(),"implemented"==e){if($scope.setImplTab(1),"Y"==$scope.suggFlowConfig.isBenefitsEnbld?($scope.getBenefitAnalysisList($scope.suggestionDet.branch.branchId),$scope.setSubImplTab(1)):"Y"==$scope.suggFlowConfig.isImplParticularsEnbld?$scope.setSubImplTab(2):"Y"==$scope.suggFlowConfig.isImplHorizDplymntEnbld?$scope.setSubImplTab(3):"Y"==$scope.suggFlowConfig.isWhyWhyAnalysisEnbld?$scope.setSubImplTab(4):"Y"==$scope.suggFlowConfig.isKaizenSustainanceEnbld?$scope.setSubImplTab(5):$scope.setSubImplTab(6),"HD"==$scope.suggestionDet.sourceType&&$scope.getSuggestionTypeDetail($scope.suggestionDet.suggestionHD.parentSuggId,$scope.suggestionDet.suggestionHD.branchId),"PILLER"==$scope.hdConfigData.hdLevel&&null!=$scope.circleList&&0<$scope.circleList.length){$scope.newCircleList=[];for(let e=0;e<$scope.circleList.length;e++)0!=$scope.circleList[e].id&&$scope.newCircleList.push($scope.circleList[e])}if(null!=$scope.suggestionDet.sustenanceAuditorList&&0!=$scope.suggestionDet.sustenanceAuditorList.length||$scope.getSustenaceAuditor(),null!=$scope.employeeList&&0<$filter("filter")($scope.employeeList,{branch:{branchId:$scope.suggestionDet.branch.branchId}},!0).length||$scope.getEmployeeList($scope.suggestionDet.branch.branchId),null!=$scope.suggestionDet.suggestionTrackerDetails)for(let e=0;e<$scope.suggestionDet.suggestionTrackerDetails.length;e++)null!=$scope.suggestionDet.suggestionTrackerDetails[e].team_type_master&&"Implementation"==$scope.suggestionDet.suggestionTrackerDetails[e].team_type_master.type&&($scope.resultData=$scope.suggestionDet.suggestionTrackerDetails[e]);$scope.checkboxValueEHS="YES"===$scope.resultData.isEHSBenefit,$("#viewImplementedModal").modal({backdrop:"static",keyboard:!1})}},$scope.isBenefitChecked=function(t){for(let e=0;e<$scope.suggestionDet.implBenefitAnalysisList.length;e++)if(t.benfitId==$scope.suggestionDet.implBenefitAnalysisList[e].benefitAnalysis.benfitId)return!0},$scope.isDepartmentSelected=function(){if(null!=$scope.departmentList&&0<$scope.departmentList.length)for(let s=0;s<$scope.departmentList.length;s++){let t=!1;for(let e=0;e<$scope.suggestionDet.suggestionHorizontalDept.length;e++)if($scope.departmentList[s].deptId===$scope.suggestionDet.suggestionHorizontalDept[e].deptId){t=!0;break}$scope.departmentList[s].isImplselect=t}},$scope.implBeforFiles=[],$scope.checkImplData=function(s){if($scope.implBeforFiles=[],$scope.resultImageBeforFiles=[],$scope.selectedEmpList=[],null!=$scope.employeeList&&0<$filter("filter")($scope.employeeList,{branch:{branchId:s.branch.branchId}},!0).length)for(let e=0;e<$scope.employeeList.length;e++)$scope.employeeList[e].isSelected=!1,$scope.employeeList[e].selectedId=0;else $scope.getEmployeeList(s.branch.branchId);if(null!=s.sugImplTeam&&0<s.sugImplTeam.length)$scope.checkEmpTeam();else for(var e=0;e<$scope.employeeList.length;e++)$scope.employeeList[e].isSelected=!1;if(null!=$scope.suggestionDet.suggestionActivityList&&0<$scope.suggestionDet.suggestionActivityList.length&&$scope.isActivityBeforChecked(),null!=s.ehsbenefit&&""!=s.ehsbenefit&&"Yes"==s.ehsbenefit?($scope.suggestionDet.ehsbenefit=!0,$scope.implData.safetImplactionSummary=s.safetyImplemention):($scope.suggestionDet.ehsbenefit=!1,$scope.implData.safetImplactionSummary=null),$scope.whyWhyAnalysisforImplSuggDet=s.suggestionWhyWhyAnalysis,null!=$scope.suggestionDet.sugesstionStatusAudit&&0<$scope.suggestionDet.sugesstionStatusAudit.length)for(let e=0;e<$scope.suggestionDet.sugesstionStatusAudit.length;e++)if("PENDING"==$scope.suggestionDet.sugesstionStatusAudit[e].actionStatus&&($scope.suggestionDet.sugesstionStatusAudit[e].status_master.status==$scope.CONST.STATUS.ReassignedToImplPostVerification.status||$scope.suggestionDet.sugesstionStatusAudit[e].status_master.status==$scope.CONST.STATUS.AssignedForImplVerification.status||$scope.suggestionDet.sugesstionStatusAudit[e].status_master.status==$scope.CONST.STATUS.ReassignedToImplPostFincVerification.status)){if(null!=s.suggestionWhyWhyAnalysis&&0<s.suggestionWhyWhyAnalysis.length){$scope.whyWhyAnalysisforImpl=[];for(let e=0;e<s.suggestionWhyWhyAnalysis.length;e++)$scope.whyWhyAnalysisforImpl.push({whyWhyAnalysis:s.suggestionWhyWhyAnalysis[e].name,id:s.suggestionWhyWhyAnalysis[e].id})}if($scope.resultImageBeforFiles=[],""!=s.resultDocUrl&&null!=s.resultDocUrl&&$scope.resultImageBeforFiles.push({imgsrc:s.resultDocUrl}),$scope.implBeforFiles=[],null!=s.implementedDocDetails&&0<s.implementedDocDetails.length){let t=0;for(let e=0;e<s.implementedDocDetails.length;e++){var i=s.implementedDocDetails[e].suggdocId;i>t&&(t=i,$scope.implBeforFiles)&&($scope.implBeforFiles=[{imgsrcImpl:s.implementedDocDetails[e].url}])}}}null!=s.pcrNo&&""!=s.pcrNo?$scope.suggestionDet.pcrNumber=s.pcrNo:$scope.suggestionDet.pcrNumber="",null!=s.pcnNo&&""!=s.pcnNo?$scope.suggestionDet.pcnNumber=s.pcnNo:$scope.suggestionDet.pcnNumber="",$scope.implData.implSummary=s.implSummary,$scope.implData.implactionSummary=s.implementationAction,$scope.suggestionDet.rootCause=s.suggestionTrackerDetails[s.suggestionTrackerDetails.length-1].rootCause,$scope.suggestionDet.counterMeasures=s.suggestionTrackerDetails[s.suggestionTrackerDetails.length-1].counterMeasures,$scope.suggestionDet.kaizenIdea=s.suggestionTrackerDetails[s.suggestionTrackerDetails.length-1].kaizenIdea,$scope.suggestionDet.benefits=s.suggestionTrackerDetails[s.suggestionTrackerDetails.length-1].benefits,$scope.suggestionDet.whatToDo=s.suggestionTrackerDetails[s.suggestionTrackerDetails.length-1].whatToDo,$scope.suggestionDet.howToDo=s.suggestionTrackerDetails[s.suggestionTrackerDetails.length-1].howToDo,$scope.suggestionDet.frquency=s.suggestionTrackerDetails[s.suggestionTrackerDetails.length-1].frquency,$scope.implData.implementedCost=s.suggestionTrackerDetails[s.suggestionTrackerDetails.length-1].implementedCost,$scope.implData.costEffective=s.suggestionTrackerDetails[s.suggestionTrackerDetails.length-1].costEffective,$scope.suggestionDet.implSummary=s.implSummary,$scope.suggestionDet.implactionSummary=s.suggestionTrackerDetails[s.suggestionTrackerDetails.length-1].implementationAction,""!=$scope.suggestionDet.FCData&&null!=$scope.suggestionDet.FCData&&$scope.isFcAvailable($scope.suggestionDet.FCData)},$scope.checkEmpTeam=function(){$scope.selectedEmpList=[];for(var e=0;e<$scope.employeeList.length;e++)$scope.employeeList[e].isSelected=!1,$scope.employeeList[e].selectedId=0;if(null!=$scope.suggestionDet.sugImplTeam&&0<$scope.suggestionDet.sugImplTeam.length)for(let t=0;t<$scope.employeeList.length;t++)for(let e=0;e<$scope.suggestionDet.sugImplTeam.length;e++)$scope.employeeList[t].empId===$scope.suggestionDet.sugImplTeam[e].empId&&($scope.employeeList[t].isSelected=!0,$scope.employeeList[t].selectedId=$scope.suggestionDet.sugImplTeam[e].id,$scope.selectedEmpList.push($scope.employeeList[t]))},$scope.isBenefitBeforChecked=function(){if(null!=$scope.suggestionDet.implBenefitAnalysisList&&0<$scope.suggestionDet.implBenefitAnalysisList.length)for(let t=0;t<$scope.benefitList.length;t++)for(let e=0;e<$scope.suggestionDet.implBenefitAnalysisList.length;e++)$scope.benefitList[t].benfitId==$scope.suggestionDet.implBenefitAnalysisList[e].benefitAnalysis.benfitId&&1!=$scope.benefitList[t].benfitId&&($scope.benefitList[t].isBenefitChecked=!0)},$scope.isHdDeptBeforeCheck=function(){if(null!=$scope.suggestionDet.suggestionHorizontalDept&&0<$scope.suggestionDet.suggestionHorizontalDept.length){$scope.suggestionDet.isHDRequire=!0,$scope.suggestionDet.hdSelected=!1;for(let t=0;t<$scope.departmentList.length;t++)for(let e=0;e<$scope.suggestionDet.suggestionHorizontalDept.length;e++)$scope.departmentList[t].deptId!=$scope.suggestionDet.suggestionHorizontalDept[e].deptId||1==$scope.departmentList[t].isImplselect&&1==$scope.departmentList[t].isEvalselect||($scope.departmentList[t].isImplselect=!0,$scope.departmentList[t].isEvalselect=!0,$scope.getImplDeptLineList($scope.departmentList[t],"New"))}},$scope.isFcAvailable=function(t){if(null!=$scope.FCList&&0<$scope.FCList.length){$scope.suggestionDet.implfinanceflow=!0;for(let e=0;e<$scope.FCList.length;e++)t.fcId==$scope.FCList[e].empId&&($scope.suggestionDet.implfc=$scope.FCList[e])}},$scope.isActivityBeforChecked=function(){if(null!=$scope.suggestionDet.suggestionActivityList&&0<$scope.suggestionDet.suggestionActivityList.length)for(let t=0;t<$scope.activityList.length;t++)for(let e=0;e<$scope.suggestionDet.suggestionActivityList.length;e++)$scope.suggestionDet.suggestionActivityList[e].activity.id==$scope.activityList[t].id&&1!=$scope.activityList[t].isselect&&($scope.activityList[t].isselect=!0)},$scope.isdocumentBeforeCheck=function(){if(null!=$scope.suggestionDet.document&&0<$scope.suggestionDet.document.length)for(let t=0;t<$scope.documentLists.length;t++)for(let e=0;e<$scope.suggestionDet.document.length;e++)$scope.documentLists[t].id==$scope.suggestionDet.document[e].document.id&&1!=$scope.documentLists[t].isChecked&&($scope.documentLists[t].isChecked=!0)},$scope.flagCheckVerify=!1,$scope.flagCheckReassign=!1,$scope.flagVerifySpinner=!1,$scope.flagReassignSpinner=!1,$scope.checkImplVerify=function(e){1==e&&($scope.flagVerifySpinner=!0,$scope.flagReassignSpinner=!1,$scope.flagCheckVerify=!0,$scope.flagCheckReassign=!1,$scope.suggestionDet.implReassignCmd=""),2==e&&($scope.flagReassignSpinner=!0,$scope.flagVerifySpinner=!1,$scope.flagCheckReassign=!0,$scope.flagCheckVerify=!1,$scope.suggestionDet.flagCheckVerify=""),$scope.suggestionDet.isImplAction=e},$scope.verificationImplSubmission=function(e){if($scope.implVerifyMsg="",$scope.subSummary="",1==e)$scope.implVerifyMsg="Implementation Verification Successfully.",$scope.subSummary=$scope.suggestionDet.implVerifyCmd;else if(2==e){if(null==$scope.suggestionDet.implReassignCmd||""==$scope.suggestionDet.implReassignCmd)return void C.create($filter("translate")("Please_enter_comment"),5e3,"error");$scope.implVerifyMsg="gmr"==D?"Idea reassigned to implementer for modification.":"Suggestion reassigned to implementer for modification.",$scope.subSummary=$scope.suggestionDet.implReassignCmd}$scope.data={sugId:$scope.selectedSuggId,statusId:$scope.CONST.STATUS.AssignedForImplVerification.statusId,actionType:e,updatedBy:parseInt($scope.loggedInEmpId),createdBy:parseInt($scope.loggedInEmpId),comment:$scope.subSummary,branchId:$scope.suggestionDet.branch.branchId,implementedbyId:$scope.suggestionDet.sugesstionStatusAudit[$scope.suggestionDet.sugesstionStatusAudit.length-2].emp_details.empId},b.httpPost($scope.data,"verificationImplSubmission").then(function(e){$scope.flagVerifySpinner=!1,$scope.flagReassignSpinner=!1,1==e.result?(C.create($filter("translate")($scope.implVerifyMsg),4e3,"success"),$scope.getsuggestionList("onLoad"),$scope.getsuggestionList(""),$scope.getStatusWiseCount()):C.create($filter("translate")("Error_occured_Please_try_again"),5e3,"error")})},$scope.themeList=[],$scope.getSuggTheme=function(){var e={branchId:E.empDetails.branch.branchId,isActive:"Y"};b.httpPost(e,"getSuggTheme").then(function(e){e.result&&null!=e.data&&0<e.data.length?$scope.themeList=e.data:$scope.themeList=[]})},$scope.getSuggTheme(),$scope.isSuggestionHDEvaluatoer=!1,$scope.isSuggestionHDTopHdKaizen=!1,$scope.isSuggestionHDConcfigData=!1,$scope.getHDSuggestionConfigList=function(e){b.httpGet("getSuggestionConfigList/"+E.empDetails.organization.orgId+"/"+e).then(function(e){if(1==e.result){consoleLog(e.suggConfigList),$scope.suggestionConfig=e.suggConfigList;var e=$scope.getSuggestionConfigIds($scope.masterConfigObj.plantEvalType.id),t=$scope.getSuggestionConfigIds($scope.masterConfigObj.createHDSugg.id);$scope.hdConfigData.hdLevel=e.configValue,$scope.hdConfigData.hdOptions=t.configValue;for(let e=0;e<$scope.suggestionConfig.length;e++)"ByEvaluator/ImplementerKaizenHD"==$scope.suggestionConfig[e].configMaster.configCaption&&("Y"==$scope.suggestionConfig[e].configValue?$scope.isSuggestionHDEvaluatoer=!0:$scope.isSuggestionHDEvaluatoer=!1),"TopHdKaizen"==$scope.suggestionConfig[e].configMaster.configCaption&&("Y"==$scope.suggestionConfig[e].configValue?$scope.isSuggestionHDTopHdKaizen=!0:$scope.isSuggestionHDTopHdKaizen=!1),"OPT_FOR_OTH_PLANTS"==$scope.suggestionConfig[e].configValue&&($scope.isSuggestionHDConcfigData=!0);$scope.addUpdateConfigRequest=[]}else $scope.suggestionConfig=[],$scope.hdConfigData={}})},$scope.getSuggestionConfigIds=function(e){for(var t=-1,s=0;s<$scope.suggestionConfig.length;s++)if($scope.suggestionConfig[s].configMaster.id==e){t=$scope.suggestionConfig[s];break}return t},$scope.setSelectedCtaegory=function(e){$scope.suggestionDet.selectedCatName=e.categoryName,$scope.suggestionDet.selectedEvalCatId=e.catId},$scope.getDeptList=function(){b.httpGet("getdepartmentlistbybranchid/"+$scope.loggedInUserBranchId).then(function(e){if(e.result)if($scope.selectDeptIdsList=[],null!=e.deptList&&0<e.deptList.length){if($scope.deptList=e.deptList,null!=$scope.deptList&&0<$scope.deptList.length){for(let e=0;e<$scope.deptList.length;e++)$scope.deptList[e].isSelected=!1;$scope.selectAllDeptJurry=!1;for(var t=0;t<$scope.deptList.length;t++)$scope.deptList[t].isSelected&&$scope.selectDeptIdsList.push($scope.deptList[t].deptId)}$scope.setNomination()}else $scope.deptList=[],$scope.selectDeptIdsList=[];else $scope.deptList=[],$scope.selectDeptIdsList=[]})},$scope.selectDeptIdsList=[],$scope.setDeptJurrySelected=function(e){$scope.selectDeptIdsList=[],e.isSelected=!e.isSelected;for(var t=0;t<$scope.deptList.length;t++)$scope.deptList.isSelected||($scope.selectAllDeptJurry=!1);e=$filter("filter")($scope.deptList,{isSelected:!0},!0).length;$scope.selectAllDeptJurry=$scope.deptList.length==e;for(t=0;t<$scope.deptList.length;t++)$scope.deptList[t].isSelected&&$scope.selectDeptIdsList.push($scope.deptList[t].deptId);$scope.setNomination(),$scope.selectAllDeptJurry&&$scope.deptJurryToggle()},$scope.deptJurryToggle=function(){$(".deptJurryWrapper .deptList").slideToggle("fast")},$scope.selectFilterAllDeptJurry=function(){$scope.selectDeptIdsList=[],$scope.selectAllDeptJurry=!$scope.selectAllDeptJurry;for(var e=0;e<$scope.deptList.length;e++)$scope.deptList[e].isSelected=$scope.selectAllDeptJurry;for(e=0;e<$scope.deptList.length;e++)$scope.deptList[e].isSelected&&$scope.selectDeptIdsList.push($scope.deptList[e].deptId);$scope.setNomination(),$scope.selectAllDeptJurry&&$scope.deptJurryToggle()},$scope.toggleDeptJurryDiv=function(e){var t=$(".deptJurryWrapper");t===e.target||t.has(e.target).length||$(".deptList").slideUp("fast")},$scope.setDeptNomination=function(){if(null!=$scope.deptList&&0<$scope.deptList.length){for(let e=0;e<$scope.deptList.length;e++)$scope.deptList[e].isSelected=!1;$scope.selectAllDeptJurry=!1;for(var e=0;e<$scope.deptList.length;e++)$scope.deptList[e].isSelected&&$scope.selectDeptIdsList.push($scope.deptList[e].deptId)}$scope.setNomination()},$scope.performAction=function(e){$scope.showCommentButon=!0,"reject"==e?$scope.showComment=!0:"verify"==e&&($scope.showComment=!1)},$scope.rejectSectionImpl=function(e){null==$scope.suggestionInputDetails.fcvarifycomment||null==$scope.suggestionInputDetails.fcvarifycomment?C.create($filter("translate")("Please_Enter_Comment"),4e3,"error"):(e={sugId:$scope.suggestionDet.sugId,statusId:e.status_master.statusId,summary:$scope.suggestionInputDetails.fcvarifycomment},b.httpPost(e,"finVerificationImplReassign").then(function(e){e.result?($scope.getsuggestionList(""),$scope.getStatusWiseCount(),C.create($filter("translate")("Suggestion successfully reassign to implementer"),4e3,"success")):C.create($filter("translate")("Error_occured_Please_try_again"),5e3,"error")}))},$scope.updateCFM=function(e){$scope.cfmValue=e?"Y":"N"},$scope.approveCFM=function(e){$scope.cfmApprove=e?"Y":"N"},$scope.excludeCurrentEmployee=function(e){return e.empId!==$scope.empDetails.empId},$scope.checkMaxLengthForTextarea=function(e,t){1e3<e.length&&"Present_Problem_laterl"==t&&($scope.laterlEntery.problemAnalysis=$scope.laterlEntery.problemAnalysis.substring(0,1e3),$scope.currentlateralform.createInitiatorLateralEntryForm.sugession.$setValidity("maxlength",!0)),1e3<e.length&&"Suggestion_lateral"==t&&($scope.laterlEntery.sugession=$scope.laterlEntery.sugession.substring(0,1e3),$scope.currentlateralform.createInitiatorLateralEntryForm.sugession.$setValidity("maxlength",!0)),1e3<e.length&&"Present_Problem"==t?($scope.newSug.problemAnalysis=$scope.newSug.problemAnalysis.substring(0,1e3),$scope.form.createnewSuggForm.sugession.$setValidity("maxlength",!0)):1e3<e.length&&"Suggestion"==t&&($scope.newSug.sugession=$scope.newSug.sugession.substring(0,1e3),$scope.form.createnewSuggForm.sugession.$setValidity("maxlength",!0))},$scope.checkMaxLength=function(e){"suggestionTitleLaterl"==e&&(255<$scope.laterlEntery.suggestionTitle.length&&($scope.laterlEntery.suggestionTitle=$scope.laterlEntery.suggestionTitle.substring(0,255)),$scope.currentlateralform.createInitiatorLateralEntryForm.suggestionTitle.$setValidity("maxlength",!0)),"suggeston_title"==e&&(255<$scope.newSug.suggestionTitle.length&&($scope.newSug.suggestionTitle=$scope.newSug.suggestionTitle.substring(0,255)),$scope.form.createnewSuggForm.suggestionTitle.$setValidity("maxlength",!0))},$scope.spokenText="",$scope.interimText="",$scope.langInput={},$scope.isRecognizing={},$scope.langList=[{id:"en-IN",name:"English"},{id:"mr-IN",name:"Marathi"},{id:"hi-IN",name:"Hindi"},{id:"gu-IN",name:"Gujarati"},{id:"kn-IN",name:"Kannada"},{id:"ta-IN",name:"Tamil"},{id:"ja-JP",name:"Japanese"}],$scope.langInput.langId=$scope.langList[0].id,null);"webkitSpeechRecognition"in window?T=new webkitSpeechRecognition:"SpeechRecognition"in window&&(T=new SpeechRecognition),"webkitSpeechRecognition"in window?((T=new webkitSpeechRecognition).continuous=!0,T.interimResults=!0,T.onresult=function(e){console.log($scope.newSug[$scope.langInput.inputField]),$scope.newSug[$scope.langInput.inputField]&&0!=$scope.newSug[$scope.langInput.inputField].trim().length||($scope.newSug[$scope.langInput.inputField]="");for(var t="",s="",i=e.resultIndex;i<e.results.length;++i)if(e.results[i].isFinal){if(!($scope.newSug[$scope.langInput.inputField].length+e.results[i][0].transcript.length<=$scope.langInput.maxChars)){T.stop();break}s+=e.results[i][0].transcript+" "}else t+=e.results[i][0].transcript;$scope.interimText=t,$scope.newSug[$scope.langInput.inputField]+=s,$scope.$apply()},T.onerror=function(e){console.log("Speech recognition error: ",e.error)},T.onend=function(){console.log("Speech recognition ended.")}):alert("Sorry, your browser does not support speech recognition."),$scope.startRecognition=function(){T&&(T.lang=$scope.langInput.langId||"en-IN",$scope.isRecognizing=[],$scope.isRecognizing[$scope.langInput.inputField]=!0,T.start())},$scope.stopRecognition=function(){T&&($scope.isRecognizing=[],$scope.isRecognizing[$scope.langInput.inputField]=!1,T.stop())},$scope.startRecording=function(e,t){$scope.langInput.inputField=e||"",$scope.langInput.maxChars=t,localStorage.getItem("recognitionObj")?(e=JSON.parse(localStorage.getItem("recognitionObj")),$scope.isEmpty(e)||e.empId!==E.empDetails.empId||($scope.langInput.langId=e.langId,$scope.startRecognition())):$("#langRecognitionPopup").modal({backdrop:"static",keyboard:!1})},$scope.updateRecognitionLanguage=function(){var e={empId:E.empDetails.empId,langId:$scope.langInput.langId};localStorage.setItem("recognitionObj",JSON.stringify(e)),$("#langRecognitionPopup").modal("hide"),$scope.startRecognition()},$scope.isPillarConfigFlag=!1,$scope.checkForPillarSugg=function(){b.httpGet("checkForPillarSugg/"+E.empDetails.organization.orgId).then(function(e){e.result&&(e.pillarConfig?$scope.isPillarConfigFlag=!0:$scope.isPillarConfigFlag=!1)})}}]);app.constant("CONST_RESOURCES",(()=>{var e=new Date,t="",s=(t=(e.getDay(),e.getDate()+1),e.getMonth()+1),i=e.getFullYear()+"-"+(s=s<10?"0"+s:s)+"-"+(t=t<10?"0"+t:t),t="",s=(t=((e=new Date).getDay(),e.getDate()),e.getMonth());return{DEFAULT_DATE:{from:e.getFullYear()+"-"+(s=s<10?"0"+s:s)+"-"+(t=t<10?"0"+t:t),to:i},TEAM_TYPE:{HR:"HR",EVALUATION:1,IMPLEMENTATION:2,ANALYSIS:3,EVALFC:4,IMPLFC:5,APPROVEDBYFC:6},STATUS:{CREATED:{id:1,status:"Created",label:"New"},HR_REJECTS:{id:3,status:"HRRejects",label:"Suggestion Declined"},HR_ACCEPTS:{id:4,status:"HRAccepts",label:"Suggestion Accepted",labels:["Suggestion Accepted by Supervisor","Suggestion Accepted by Head of Department","Suggestion Accepted by Plant Head"],labelSuppText:"Suggestion Accepted By"},EVALUATION_ASSIGNED:{id:5,status:"EvaluationAssigned",label:"Suggestion Assigned For Evaluation"},EVALUATION_ACCEPTED:{id:7,status:"EvaluationRequestAccepted",label:"Suggestion Accepted By Evaluation Team"},EVALUATION_REJECTED:{id:8,status:"EvaluationRequestRejected",label:"Rejected by Evaluation Team"},EVALUATION_INPUT_SUBMITTED:{id:9,status:"EvaluationInputSubmitted",label:"Inputs Submitted"},IMPLEMENTATION_RECOMMENDED:{id:11,status:"ImplementationRecommended",label:"Recommended For Implementation"},IMPLEMENTATION_NOT_RECOMMENDED:{id:12,status:"ImplementationNotRecommended",label:"Rejected By Evaluation Team"},IMPLEMENTATION_ASSIGNED:{id:14,status:"ImplementationAssigned",label:"Assinged for Implementation"},IMPLEMENTATION_REQUEST_ACCEPTED:{id:15,status:"ImplementationRequestAccepted",label:"Implementation Request Accepted"},IMPLEMENTATION_REQUEST_REJECTED:{id:16,status:"ImplementationRequestRejected",label:"Implementation Request Rejected"},IMPLEMENTATION_INPUT_SUBMITTED:{id:17,status:"ImplementationInputSubmitted",label:"Implementation Input Submitted"},IMPLEMENTED:{id:19,status:"Implemented",label:"Suggestion Implemented"},CANCELLED:{id:20,status:"Cancelled",label:"Cancelled"},IMPLEMENTATION_ON_HOLD:{id:21,status:"ImplementationOnHold",label:"Implementation On Hold"},CLOSED:{id:22,status:"closed",label:"Suggestion closed"},EVALUATION_RECOMMENDED:{id:23,status:"EvaluationRecommended",label:"Implementation Recommended"},EVALUATION_NOT_RECOMMENDED:{id:24,status:"EvaluationNotRecommended",label:"Rejected By Evaluation Team"},EVALUATION_REQUEST_DECLINED:{id:25,status:"EvaluationRequestDecline",label:"Suggestion Declined By Evaluation Team"},IMPLEMENTATION_REQUEST_DECLINED:{id:26,status:"ImplementationRequestDeclined",label:"Suggestion Declined by Implementation Team"},SUGGESTION_ASSIGNED:{id:27,status:"SuggestionAssigned",labels:["Suggestion Assinged For Scrutinization","Suggestion Assinged For Scrutinization","Suggestion Assinged For Scrutinization"],labelSuppText:"Suggestion Assinged For",label:"Suggestion Assinged For Scrutinization"},SUGGESTION_DECLINED:{id:28,status:"SuggestionDeclined",label:"Suggestion Rejected By Scrutinizer",labels:["Suggestion Rejected by Supervisor","Suggestion Rejected by Head of Department","Suggestion Rejected by Plant Head"],labelSuppText:"Suggestion Rejected By"},SUGGESTION_DECLINED_BY_HEAD:{id:29,status:"SuggestionDeclinedByHead",label:"Suggestion is closed by top level management"},ASSIGNED_FOR_EDIT:{id:30,status:"AssignedForEdit",label:"Suggestion is assigned to originator"},EDITED_BY_CREATOR:{id:31,status:"EditedByCreator",label:"Edited By Creator"},ASSIGNED_TO_EXECUTIVE:{id:32,status:"AssignedToExecutive",label:"Assigned To Executive"},ACCEPTED_BY_EXECUTIVE:{id:33,status:"AcceptedByExecutive",label:"Accepted By Executive"},REJECTED_BY_EXECUTIVE:{id:34,status:"RejectedByExecutive",label:"Rejected By Executive"},SUGGESTION_ASSIGNED_BY_EXECUTIVE:{id:35,status:"SuggestionAssignedByExecutive",label:"Assigned By Executive"},ASSIGNED_CONCERN_TO_MGMT:{id:36,status:"Assigned Concern",label:"Assigned Concern To Management"},ASSIGNED_CONCERN_TO_CONTROLLER:{id:37,status:"AssignedConcernToController",label:"Assinged Suggestion/Concern For Further Action"},CLOSED_CONCERN:{id:38,status:"ConcernClosed",label:"Concern Closed"}},ROLES:{GREENTIN_SUPERADMIN:1,SUPERADMIN:2,ROLE_ADMIN:3,EMPLOYEE:4,EXECUTIVE:5,CONTROLLER:6,CONTROLLERLEVELUP:7,EVALUATOR:8,IMPLEMENTER:9,FINANCE_CONTROLLER:10,ORG_EXECUTIVE:11,CELL_LEADER:12,STAFF_PERSON:13,PLANT_PERSON:14,AUDITOR:15,FINANCE_APPROVAL:22,DOCUMENT_OWNER:23},COUNT_FILTERS:{PENDING:1,MY_SUGG:2,ALL_SUGG:4},CONCERN_COUNT_FILTERS:{PENDING:1,OPEN_CONCERN:4,CLOSED_CONCERN:5,MY_CONCERN:3,ALL_CONCERN:2},HELP_TEXT:{PENDING_ACTION:{TITLE:"My Pending Action",IS_SINGLE_TEXT:!0,TEXT:"List of all suggestions which user needs to act upon."},MY_SUGGESTION:{TITLE:"My Suggestions",IS_SINGLE_TEXT:!0,TEXT:"All suggestions which user have worked upon including his/her own posted suggestions."},ALL_SUGGESTION:{TITLE:"All Suggestions",IS_SINGLE_TEXT:!0,TEXT:"List of all suggestions for all departments within branch."},DASHBOARD:{TOTAL_USERS:{TITLE:"Total Users",IS_SINGLE_TEXT:!0,TEXT:"Number of employees/users added through myeNovation portal."},ACTIVE_USERS:{TITLE:"Active Users",IS_SINGLE_TEXT:!0,TEXT:"Users who have verified account and logged in at least once."},PARTICIPATION_INDEX:{TITLE:"Participation Index",IS_SINGLE_TEXT:!0,TEXT:"Number of unique users who have posted suggestions."},TOTAL_SUGG:{TITLE:"Total Suggestions",IS_SINGLE_TEXT:!0,TEXT:"Total number of suggestions submitted within branch."},IMPLTED_SUGG:{TITLE:"Implemented Suggestions",IS_SINGLE_TEXT:!0,TEXT:"Total number of suggestions implemented within branch."},TOTAL_CONCERNS:{TITLE:"Total Concerns",IS_SINGLE_TEXT:!0,TEXT:"Total number of concerns within selected period."},CLOSED_CONCERNS:{TITLE:"Closed Concerns",IS_SINGLE_TEXT:!0,TEXT:"All closed concerns within selected period."},OPEN_CONCERNS:{TITLE:"Closed Concerns",IS_SINGLE_TEXT:!0,TEXT:"All open concerns within selected period."},COST_SAVING:{TITLE:"Cost Saving",IS_SINGLE_TEXT:!0,TEXT:"Annual cost saving by implementing suggestions."},IMPL_COST:{TITLE:"Implementation Cost",IS_SINGLE_TEXT:!0,TEXT:"Amount spent for implementing suggestions."}},CONCERN:{PENDING_ACTION:{TITLE:"My Pending Actions",IS_SINGLE_TEXT:!0,TEXT:"Concern(s) which need to act upon"},OPEN_CONCERN:{TITLE:"Open Concerns",IS_SINGLE_TEXT:!0,TEXT:"All concerns which user has assigned for an action and are still open."},CLOSED_CONCERN:{TITLE:"Closed Concerns",IS_SINGLE_TEXT:!0,TEXT:"All concerns which user has assigned for an action and are closed."},MY_CONCERN:{TITLE:"My Concerns",IS_SINGLE_TEXT:!0,TEXT:"Concern(s) raised by user."},ALL_CONCERN:{TITLE:"All Concerns",IS_SINGLE_TEXT:!0,TEXT:"Total number of concerns raised so far."}},AUDITOR:{PENDING_ACTION:{TITLE:"My Pending Actions",IS_SINGLE_TEXT:!0,TEXT:"List of all template which user needs to act upon."},MY_AUDIT:{TITLE:"My Audits",IS_SINGLE_TEXT:!0,TEXT:"All in progress inspections/audits."},TEMPLATES:{TITLE:"My Templates",IS_SINGLE_TEXT:!0,TEXT:"Provision to create & publish templates."}}},CONST_HELP:{HOME_SCREEN:{Suggestion_Tab:"This tab includes sub tab like My Pending Actions,My Suggestion & All Suggestions",My_Pending_Action_Tab:"This tab displays all suggestions on which user need to take some action",My_Suggestions_Tab:"This tab helps user to track progress of all suggestions he created or worked upon.",All_Suggestions:"This tab displays all suggestion which was created or taken action",Dashboard_Tab:"\tThis tab displays all suggestion information in form of graphs",Reports:"This tab displays all suggestion information in form reports",Winners_Board:"This tab displays all Winners the winner may be Employee Of the Month,Department Of the Month etc.",HD_Monitoring:"This tab displays all HD Suggestion details ",Reddem_Points:"This tab will help user to use there point for purchasing something",Guest_Suggestion:"This tab will displays that suggestion which was created by Guest user who has not authority to give suggestion",Customer_Feedback:"This tab will displays the user who had visited the website who had given the valuable feedback on it",Knowledge_Bank:"This tab will displays that suggestion which we want to have same suggestion in another branch",Lateral_Suggestion:"This tab will displays that suggestion which we had create or implement in parralely or latterly",Create_Sugg_Button:"It will displays the create suggestion screen to create a suugestion to the users",Points:"This will display points when user create a suggestion or take actions on it",Export_Excel:"This will export suggestion on basis of which tab selected if user select My Pending Actions tab then all My Pending Actions Suggestion will display in that Excel same for My Suggestion Tab & All Suggestion Tab",Clear_Filter_Search_Button:"This button allows user to clear to clear or remove the Filter which we had selected Apply Filter Button This will help user to show the limited suggestion as per he need",Add_On_Search:"This will help user to search by parameters like Suggestion Id,My Created Suggestion,Employee Id & Employee Name",Search_Field:"This will help user to search the Selected Suggestion"},CREATE_SUGGESTION:{On_Behalf_Suggestion:"If user has not access then on clicking on it the another user will create a suggestion for that user",Self_Implement:"The user who had created the suggestion has provision to implement the suggestion by clicking on it"},CONTROLLER_SCREEN:{Accept_Assign:"This button will accept a suggestion from controller & assign it to the Evaluator",Reject_Button:"This button will help controller to reject a suggestion which was created",Reassign_to_Initiator:"This button will helps controller to reassign a suggestion to the user which has created a suggestion",Pass_to_Peer:"This button will give a controller provision to pass a suggestion to another controller",Check_Duplication:"This button will displays all suggestions which were same which was created by user or some fieldare same then it will display that suggestion"},EVALUATOR_SCREEN:{Change_Document:"This tab will help Evaluator if he want to add document to more clarify the Suggestion",Kaizen_Activity:"This tab will display all TPM's activity which are 8 type of it",Saving_Type:"This tab will describe that the suggestion which was provided from that what we are saving Cost or Time ",Particulars:"This tab will display all Particulars. ",Horizontal_Deployment:"This tab will give provision to  Evaluator to select that departments to which suggestion should implement",Analysis_Summary:"Evaluator should provide a detailed Summary of Suggestion",Override_Initiator_Category:"Evaluator should override the Category which was selected by the Iniator",Budgetary_Cost:"Should provide the Budgetary cost by the Evaluator",SAP_Code:"Evaluator should able to enter SAP code",Reject_Button:"Finance Controller has provision to Reject the cost which was entered by the Evaluator",Assign_For_Implementation_Button:"This button will assign a suggestion to Implementer to implement it",Eval_Reject_Button:"This button will help Evaluator to reject the suggestion"},IMPLEMENTER_SCREEN:{Implementation_Action:"Should provide the information about what implementer had taken action to solve the issue",Approximate_Implementation_Cost:"Enter the cost which was required to implement the suggestion",Annual_Savings:"Enter that cost which we had save while implementing a suggestion",Implemented_Tab:"This tab allows implementer to implement the suggestion",On_Hold_Tab:"This tab helps implementer to keep the suggestion On Hold",Reject_Tab:"This tab will allow implementer to reject the suggestion"}}}})()),app.filter("shortName",function(){return function(e){var t="";return(e=e.trim()).split(" ").forEach(function(e){t+=e[0]||""}),t}}),app.filter("replaceVal",function(){return function(e){return e=null!=e&&""!=e?e:e.replace("null","")}}),app.filter("filterUnderEval",function(){return function(e,t){var s=[];return angular.forEach(e,function(e){t.includes(e.status_master.statusId)&&s.push(e)}),s}}),app.directive("showtab",function(){return{link:function(e,t,s){t.click(function(e){e.preventDefault(),$(t).tab("show")})}}}),app.directive("repeatEnd",function(){return{restrict:"A",link:function(e,t,s){e.$last&&e.$eval(s.repeatEnd)}}}),app.directive("bsTooltip",function(){return{restrict:"A",link:function(e,t,s){$(t).hover(function(){$(t).tooltip("show")},function(){$(t).tooltip("hide")})}}}),app.filter("ifEmpty",function(){return function(e,t){return angular.isUndefined(e)||null===e||""===e||"null"===e?t:e}}),app.directive("dScrollHorizontally",function(){return{restrict:"A",link:function(e,t,s){e.scrollToRight=function(){t[0].scrollLeft+=Number(s.dScrollHorizontally)},e.scrollToLeft=function(){t[0].scrollLeft-=Number(s.dScrollHorizontally)}}}}),app.filter("startFrom",function(){return function(e,t){return e?e.slice(t=+t):[]}}),app.filter("propsFilter",function(){return function(e,n){var l,o=[];return angular.isArray(e)?(l=Object.keys(n),e.forEach(function(e){for(var t=!1,s=0;s<l.length;s++){var i=l[s],a=n[i].toLowerCase();if(-1!==e[i].toString().toLowerCase().indexOf(a)){t=!0;break}}t&&o.push(e)})):o=e,o}}),app.constant("FILTER_RESOURCES",{PENDING:1,UNDER_EVAL:2,FINAL:4}),app.factory("sharedService",function(e){var t={message:"",prepForBroadcast:function(e){this.message=e,this.broadcastItem()},broadcastItem:function(){e.$broadcast("handleBroadcast")}};return t}),app.factory("SuggMasterData",function(s,$http,e){return{setEmpBrowniePoints:function(){var e={mu_k:s.empDetails.uinUserId};$http({method:"POST",data:e,url:appDomain+"getEmployeeDetailsById",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:s.empDetails.authToken},timeout:18e4}).then(function(e){var t,e=e.data;e.result&&((t=JSON.parse(localStorage.getItem("userDet"))).points=e.empDetails.points,localStorage.setItem("userDet",JSON.stringify(t)),s.empDetails=JSON.parse(localStorage.getItem("userDet")))}).catch(function(e){e.data})},getMandetoryField:function(){$http({method:"GET",url:appDomain+"getProductOrgConfigData/"+s.empDetails.branch.branchId,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:s.empDetails.authToken},timeout:18e4}).then(function(e){var t,e=e.data;e.result&&(e=e.productorglist[0],(t=JSON.parse(localStorage.getItem("userDet"))).productOrgConfigDet=e,t=JSON.stringify(t),localStorage.setItem("userDet",t),s.empDetails=JSON.parse(localStorage.getItem("userDet")))}).catch(function(e){e.data})}}}),app.constant("CONST_HELP",{HOME_SCREEN:{Suggestion_Tab:"This tab includes sub tab like My Pending Actions,My Suggestion & All Suggestions",My_Pending_Action_Tab:"This tab displays all suggestions on which user need to take some action",My_Suggestions_Tab:"This tab helps user to track progress of all suggestions he created or worked upon.",All_Suggestions:"This tab displays all suggestion which was created or taken action",Dashboard_Tab:"\tThis tab displays all suggestion information in form of graphs",Reports:"This tab displays all suggestion information in form reports",Winners_Board:"This tab displays all Winners the winner may be Employee Of the Month,Department Of the Month etc.",HD_Monitoring:"This tab displays all HD Suggestion details ",Reddem_Points:"This tab will help user to use there point for purchasing something",Guest_Suggestion:"This tab will displays that suggestion which was created by Guest user who has not authority to give suggestion",Customer_Feedback:"This tab will displays the user who had visited the website who had given the valuable feedback on it",Knowledge_Bank:"This tab will displays that suggestion which we want to have same suggestion in another branch",Lateral_Suggestion:"This tab will displays that suggestion which we had create or implement in parralely or latterly",Create_Sugg_Button:"It will displays the create suggestion screen to create a suugestion to the users",Points:"This will display points when user create a suggestion or take actions on it",Export_Excel:"This will export suggestion on basis of which tab selected if user select My Pending Actions tab then all My Pending Actions Suggestion will display in that Excel same for My Suggestion Tab & All Suggestion Tab",Clear_Filter_Search_Button:"This button allows user to clear to clear or remove the Filter which we had selected Apply Filter Button This will help user to show the limited suggestion as per he need",Add_On_Search:"This will help user to search by parameters like Suggestion Id,My Created Suggestion,Employee Id & Employee Name",Search_Field:"This will help user to search the Selected Suggestion"},CREATE_SUGGESTION:{On_Behalf_Suggestion:"If user has not access then on clicking on it the another user will create a suggestion for that user",Self_Implement:"The user who had created the suggestion has provision to implement the suggestion by clicking on it"},CONTROLLER_SCREEN:{Accept_Assign:"This button will accept a suggestion from controller & assign it to the Evaluator",Reject_Button:"This button will help controller to reject a suggestion which was created",Reassign_to_Initiator:"This button will helps controller to reassign a suggestion to the user which has created a suggestion",Pass_to_Peer:"This button will give a controller provision to pass a suggestion to another controller",Check_Duplication:"This button will displays all suggestions which were same which was created by user or some fieldare same then it will display that suggestion"},EVALUATOR_SCREEN:{Change_Document:"This tab will help Evaluator if he want to add document to more clarify the Suggestion",Kaizen_Activity:"This tab will display all TPM's activity which are 8 type of it",Saving_Type:"This tab will describe that the suggestion which was provided from that what we are saving Cost or Time ",Particulars:"This tab will display all Particulars. ",Horizontal_Deployment:"This tab will give provision to  Evaluator to select that departments to which suggestion should implement",Analysis_Summary:"Evaluator should provide a detailed Summary of Suggestion",Override_Initiator_Category:"Evaluator should override the Category which was selected by the Iniator",Budgetary_Cost:"Should provide the Budgetary cost by the Evaluator",SAP_Code:"Evaluator should able to enter SAP code",Reject_Button:"Finance Controller has provision to Reject the cost which was entered by the Evaluator",Assign_For_Implementation_Button:"This button will assign a suggestion to Implementer to implement it",Eval_Reject_Button:"This button will help Evaluator to reject the suggestion"},IMPLEMENTER_SCREEN:{Implementation_Action:"Should provide the information about what implementer had taken action to solve the issue",Approximate_Implementation_Cost:"Enter the cost which was required to implement the suggestion",Annual_Savings:"Enter that cost which we had save while implementing a suggestion",Implemented_Tab:"This tab allows implementer to implement the suggestion",On_Hold_Tab:"This tab helps implementer to keep the suggestion On Hold",Reject_Tab:"This tab will allow implementer to reject the suggestion"}});